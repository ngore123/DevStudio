<process draft="false" dev-studio-version="24.3.00">
  <process-def name=":AutoPilot-AD-Utilities:Terminal:Windows Command">
    <parameters>
      <input global="false" required="false">
        <description>The name of the Adapter to use for this Process.</description>
        <from>adapter name</from>
        <to>adapter name</to>
      </input>
      <input global="false" required="true">
        <description>The command to execute, including arguments. This expects only String input.  Such as ls, dir and mkdir etc.</description>
        <from>command</from>
        <to>command</to>
      </input>
      <input global="false" required="false">
        <description>Time, in whole seconds, allotted
to complete the execution of the
command.</description>
        <from>command timeout</from>
        <to>command timeout</to>
      </input>
      <input global="false" required="false">
        <description>The host name or IP address where the command will be executed.</description>
        <from>host name</from>
        <to>host name</to>
      </input>
      <input global="false" required="false">
        <description>The user name/account name that will be used to execute the command on the remote host.</description>
        <from>user name</from>
        <to>user name</to>
      </input>
      <input global="false" required="false">
        <description>The password for the user name/account that will be used to execute the command on the remote host.</description>
        <from>password</from>
        <to>password</to>
      </input>
      <input global="false" required="false">
        <description>Specify Character set name to encode or decode the characters.
E.g.
Character set     Supporting Language
Shift_JIS          : Japanese character set.
Big5	              : Traditional Chinese character set.
ISO-8859-2	   :  ISO character set for Central European languages.</description>
        <from>character set</from>
        <to>character set</to>
      </input>
      <input global="false" required="false">
        <description>If input value specified is “64bit”, xCommand (xCommand utility is used in Windows command adapter to connect to remote system) service is launched in *64 Bit image mode* on remote system to execute the commands, otherwise service is launched in 32 bit mode.

Specify the value “64bit” if and only if commands need to be run on 64 bit image mode; otherwise do not specify any value.

It is recommended to select the “64bit” bit mode on 64-bit remote system types if and only if the command requires accessing the 64 bit resources. If “64bit” is specified The Windows command request takes more time if service is launched in 64 bit as compared to 32 bit image mode.
</description>
        <from>service launch mode</from>
        <to>service launch mode</to>
      </input>
      <input global="false" required="false">
        <description>If set to true, the Service Control Manager of remote/target system is opened with the user specified in adapter request. 

Valid values: true, false

Default value: false (by default, Service Control Manager of remote/target system is opened with the same user under which BAO service is running [as logon user]) 
</description>
        <from>impersonate user</from>
        <to>impersonate user</to>
      </input>
      <output global="false" required="false">
        <description>An adapter response contains the result returned from an adapter request. The contents of the response will vary by adapter.</description>
        <to>adapter response</to>
        <from>adapter response</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <switch>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint></checkpoint>
        </meta>
        <execute-all-applicable-cases>false</execute-all-applicable-cases>
        <default>
          <sequence />
        </default>
        <case>
          <condition>
            <document>
              <input>
                <from>adapter name</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[string-length()=0]]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <assign>
              <assignment>
                <output>
                  <to>adapter name</to>
                  <value>WindowsCommandAdapter</value>
                </output>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:assign[1]</location>
            </assign>
          </sequence>
        </case>
        <location>:switch[1]</location>
      </switch>
      <assign>
        <assignment>
          <document>
            <input>
              <from>command timeout</from>
            </input>
          </document>
          <result>
            <output>
              <to>command timeout</to>
            </output>
          </result>
          <xslt-stylesheet>
            <stylesheet-replacement-tokens />
            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="yes" />
  <xsl:template match="/">
    <value>
      <xsl:choose>
        <xsl:when test="number(.)">
          <xsl:value-of select="." disable-output-escaping="no" />
        </xsl:when>
        <xsl:otherwise>
          <xsl:text disable-output-escaping="no">60</xsl:text>
        </xsl:otherwise>
      </xsl:choose>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
          </xslt-stylesheet>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <location>:assign[1]</location>
      </assign>
      <assign>
        <assignment>
          <document>
            <input>
              <from>password</from>
            </input>
          </document>
          <result>
            <output>
              <to>output</to>
            </output>
          </result>
          <xslt-stylesheet>
            <stylesheet-replacement-tokens>
              <replacement-token name="password">
                <input global="false">
                  <from>password</from>
                </input>
              </replacement-token>
            </stylesheet-replacement-tokens>
            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <password-holder>
      <xsl:text disable-output-escaping="no">&lt;![CDATA[$[password]]]&gt;</xsl:text>
    </password-holder>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
          </xslt-stylesheet>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <location>:assign[2]</location>
      </assign>
      <switch>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <execute-all-applicable-cases>false</execute-all-applicable-cases>
        <default>
          <sequence>
            <switch>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>true</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <execute-all-applicable-cases>false</execute-all-applicable-cases>
              <default>
                <sequence>
                  <assign>
                    <assignment>
                      <document>
                        <input>
                          <from>command</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>adapter request</to>
                        </output>
                      </result>
                      <xslt-stylesheet>
                        <stylesheet-replacement-tokens>
                          <replacement-token name="command timeout">
                            <input global="false">
                              <from>command timeout</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="command">
                            <input global="false">
                              <from>command</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="host name">
                            <input global="false">
                              <from>host name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="user name">
                            <input global="false">
                              <from>user name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="character-set">
                            <input global="false">
                              <from>character set</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="service launch mode">
                            <input global="false">
                              <from>service launch mode</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="impersonate user">
                            <input global="false">
                              <from>impersonate user</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="password">
                            <input global="false">
                              <from>password</from>
                            </input>
                          </replacement-token>
                        </stylesheet-replacement-tokens>
                        <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <request-data>
      <command-request>
        <xsl:if test="'${host name}' != ''  or '${user name}' != '' ">
          <targets>
            <target>
              <host>
                <xsl:text disable-output-escaping="no">$[host name]</xsl:text>
              </host>
              <userName>${user name}</userName>
              <character-set>${character-set}</character-set>
              <password>${password}</password>
              <service-launch-mode>
                <xsl:text disable-output-escaping="no">${service launch mode}</xsl:text>
              </service-launch-mode>
              <impersonate-user>
                <xsl:text disable-output-escaping="no">${impersonate user}</xsl:text>
              </impersonate-user>
            </target>
          </targets>
        </xsl:if>
        <commands>
          <command>
            <xsl:if test="string-length('${command timeout}') != 0">
              <xsl:attribute name="timeout-secs">${command timeout}</xsl:attribute>
            </xsl:if>
            <xsl:text disable-output-escaping="no">$[command]</xsl:text>
          </command>
        </commands>
      </command-request>
    </request-data>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                      </xslt-stylesheet>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <location>:switch[2]:sequence[1]:switch[1]:sequence[1]:assign[1]</location>
                  </assign>
                </sequence>
              </default>
              <case>
                <condition>
                  <document>
                    <input>
                      <from>output</from>
                    </input>
                  </document>
                  <xpath-expression>
                    <xpath-replacement-tokens />
                    <xpath><![CDATA[not(contains(., 'EncryptedData')) ]]></xpath>
                  </xpath-expression>
                </condition>
                <sequence>
                  <assign>
                    <assignment>
                      <document>
                        <input>
                          <from>command</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>adapter request</to>
                        </output>
                      </result>
                      <xslt-stylesheet>
                        <stylesheet-replacement-tokens>
                          <replacement-token name="command timeout">
                            <input global="false">
                              <from>command timeout</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="command">
                            <input global="false">
                              <from>command</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="host name">
                            <input global="false">
                              <from>host name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="user name">
                            <input global="false">
                              <from>user name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="character-set">
                            <input global="false">
                              <from>character set</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="service launch mode">
                            <input global="false">
                              <from>service launch mode</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="impersonate user">
                            <input global="false">
                              <from>impersonate user</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="password">
                            <input global="false">
                              <from>password</from>
                            </input>
                          </replacement-token>
                        </stylesheet-replacement-tokens>
                        <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <request-data>
      <command-request>
        <xsl:if test="'${host name}' != ''  or '${user name}' != '' or '$[password]' != ''">
          <targets>
            <target>
              <host>
                <xsl:text disable-output-escaping="no">$[host name]</xsl:text>
              </host>
              <userName>${user name}</userName>
              <password>$[password]</password>
              <service-launch-mode>
                <xsl:text disable-output-escaping="no">${service launch mode}</xsl:text>
              </service-launch-mode>
              <impersonate-user>
                <xsl:text disable-output-escaping="no">${impersonate user}</xsl:text>
              </impersonate-user>
              <character-set>${character-set}</character-set>
            </target>
          </targets>
        </xsl:if>
        <commands>
          <command>
            <xsl:if test="string-length('${command timeout}') != 0">
              <xsl:attribute name="timeout-secs">${command timeout}</xsl:attribute>
            </xsl:if>
            <xsl:text disable-output-escaping="no">$[command]</xsl:text>
          </command>
        </commands>
      </command-request>
    </request-data>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                      </xslt-stylesheet>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <location>:switch[2]:sequence[1]:switch[1]:sequence[2]:assign[1]</location>
                  </assign>
                </sequence>
              </case>
              <location>:switch[2]:sequence[1]:switch[1]</location>
            </switch>
          </sequence>
        </default>
        <case>
          <condition>
            <document>
              <input>
                <from>command</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[name(.)='fat-command']]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <switch>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>true</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <execute-all-applicable-cases>false</execute-all-applicable-cases>
              <default>
                <sequence>
                  <assign>
                    <assignment>
                      <document>
                        <input>
                          <from>command</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>adapter request</to>
                        </output>
                      </result>
                      <xslt-stylesheet>
                        <stylesheet-replacement-tokens>
                          <replacement-token name="host name">
                            <input global="false">
                              <from>host name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="command timeout">
                            <input global="false">
                              <from>command timeout</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="user name">
                            <input global="false">
                              <from>user name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="character-set">
                            <input global="false">
                              <from>character set</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="service launch mode">
                            <input global="false">
                              <from>service launch mode</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="impersonate user">
                            <input global="false">
                              <from>impersonate user</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="password">
                            <input global="false">
                              <from>password</from>
                            </input>
                          </replacement-token>
                        </stylesheet-replacement-tokens>
                        <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="yes" />
  <xsl:template match="/">
    <request-data>
      <command-request>
        <xsl:if test="'${host name}' != '' or '${user name}' != ''">
          <targets>
            <target>
              <host>
                <xsl:text disable-output-escaping="no">$[host name]</xsl:text>
              </host>
              <userName>${user name}</userName>
              <password>$[password]</password>
              <character-set>${character-set}</character-set>
              <impersonate-user>
                <xsl:text disable-output-escaping="no">${impersonate user}</xsl:text>
              </impersonate-user>
              <service-launch-mode>
                <xsl:text disable-output-escaping="no">${service launch mode}</xsl:text>
              </service-launch-mode>
            </target>
          </targets>
        </xsl:if>
        <commands>
          <fat-command>
            <xsl:for-each select="fat-command/command | fat-command/commands">
              <xsl:copy>
                <xsl:copy-of select="attribute::*" />
                <xsl:if test="string-length('${command timeout}') != 0">
                  <xsl:attribute name="timeout-secs">${command timeout}</xsl:attribute>
                </xsl:if>
                <xsl:copy-of select="node()" />
              </xsl:copy>
            </xsl:for-each>
          </fat-command>
        </commands>
      </command-request>
    </request-data>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                      </xslt-stylesheet>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <location>:switch[2]:sequence[2]:switch[1]:sequence[1]:assign[1]</location>
                  </assign>
                </sequence>
              </default>
              <case>
                <condition>
                  <document>
                    <input>
                      <from>output</from>
                    </input>
                  </document>
                  <xpath-expression>
                    <xpath-replacement-tokens />
                    <xpath><![CDATA[not(contains(.,'EncryptedData') )]]></xpath>
                  </xpath-expression>
                </condition>
                <sequence>
                  <assign>
                    <assignment>
                      <document>
                        <input>
                          <from>command</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>adapter request</to>
                        </output>
                      </result>
                      <xslt-stylesheet>
                        <stylesheet-replacement-tokens>
                          <replacement-token name="host name">
                            <input global="false">
                              <from>host name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="command timeout">
                            <input global="false">
                              <from>command timeout</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="user name">
                            <input global="false">
                              <from>user name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="character-set">
                            <input global="false">
                              <from>character set</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="service launch mode">
                            <input global="false">
                              <from>service launch mode</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="impersonate user">
                            <input global="false">
                              <from>impersonate user</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="password">
                            <input global="false">
                              <from>password</from>
                            </input>
                          </replacement-token>
                        </stylesheet-replacement-tokens>
                        <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="yes" />
  <xsl:template match="/">
    <request-data>
      <command-request>
        <xsl:if test="'${host name}' != '' or '${user name}' != '' or '$[password]' != ''">
          <targets>
            <target>
              <host>
                <xsl:text disable-output-escaping="no">$[host name]</xsl:text>
              </host>
              <userName>${user name}</userName>
              <password>$[password]</password>
              <character-set>${character-set}</character-set>
              <impersonate-user>
                <xsl:text disable-output-escaping="no">${impersonate user}</xsl:text>
              </impersonate-user>
              <service-launch-mode>
                <xsl:text disable-output-escaping="no">${service launch mode}</xsl:text>
              </service-launch-mode>
            </target>
          </targets>
        </xsl:if>
        <commands>
          <fat-command>
            <xsl:for-each select="fat-command/command | fat-command/commands">
              <xsl:copy>
                <xsl:copy-of select="attribute::*" />
                <xsl:if test="string-length('${command timeout}') != 0">
                  <xsl:attribute name="timeout-secs">${command timeout}</xsl:attribute>
                </xsl:if>
                <xsl:copy-of select="node()" />
              </xsl:copy>
            </xsl:for-each>
          </fat-command>
        </commands>
      </command-request>
    </request-data>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                      </xslt-stylesheet>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <location>:switch[2]:sequence[2]:switch[1]:sequence[2]:assign[1]</location>
                  </assign>
                </sequence>
              </case>
              <location>:switch[2]:sequence[2]:switch[1]</location>
            </switch>
          </sequence>
        </case>
        <location>:switch[2]</location>
      </switch>
      <call-adapter>
        <use-system-adapter>false</use-system-adapter>
        <parameters>
          <input global="false">
            <from>adapter name</from>
          </input>
          <input>
            <value>
              <adapter-request>
                <peer-location>
                  <location>any</location>
                </peer-location>
              </adapter-request>
            </value>
          </input>
          <input global="false">
            <from>adapter request</from>
          </input>
          <input global="false">
            <from>adapter request</from>
          </input>
          <output global="false">
            <to>adapter response</to>
          </output>
        </parameters>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <before-execution>
          <log>
            <level>debug</level>
            <parameters>
              <input>
                <value>adapter request</value>
              </input>
              <input>
                <from>adapter request</from>
              </input>
            </parameters>
          </log>
        </before-execution>
        <after-execution>
          <log>
            <level>debug</level>
            <parameters>
              <input>
                <value>adapter response</value>
              </input>
              <input>
                <from>adapter response</from>
              </input>
            </parameters>
          </log>
        </after-execution>
        <location>:call-adapter[1]</location>
      </call-adapter>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>RCE (Remote Command Execution)
       Invokes Remote Command Execution on an MS Windows Peer.  </description>
        <version>1.0</version>
      </documentation>
      <logging-options>
        <is-enabled>false</is-enabled>
        <log-file-name></log-file-name>
      </logging-options>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>3a4d5851-b251-4fab-8d05-36dabf31e138</process-id>
      <author>admin</author>
      <category></category>
      <status></status>
      <keywords></keywords>
      <systems></systems>
      <last-modified-by>aoadmin</last-modified-by>
      <last-modified>1761713319443</last-modified>
    </meta>
  </process-def>
</process>