<process draft="false" dev-studio-version="7.9.01">
  <process-def name=":AutoPilot-AD-Utilities:Terminal:PowerShell">
    <parameters>
      <input global="false" required="false">
        <description>The name of the Adapter to use for this process.
Default name would be MicrosoftPowerShell.
</description>
        <from>adapter name</from>
        <to>adapter name</to>
      </input>
      <input global="false" required="false">
        <description>The command to execute, including arguments.  This expects only String input.  Such as ls, dir and mkdir etc.</description>
        <from>command</from>
        <to>command</to>
      </input>
      <input global="false" required="false">
        <description> An XML document containing the commands to be executed on the device, commands specified in XML document is only applicable for PS Remoting session mode i.e. enable-psremoting (enable psremoting) and enable-psremoting-session (enable psremoting session) is set to true.
	  
	  Please note: The 'command' input parameter should be empty in this case. 

	Sample Commands XML document.

      &lt;commands&gt;
	  &lt;command&gt;&lt;![CDATA[(Get-WmiObject -class Win32_OperatingSystem).Caption]]&gt;&lt;/command&gt;
        &lt;command&gt;&lt;![CDATA[hostname]]&gt;&lt;/command&gt;

        &lt;command continue-on-failure="false"&gt;&lt;![CDATA[whoami]]&gt;&lt;/command&gt;

        &lt;command continue-on-failure="true" ignore-exit-code="true"&gt;&lt;![CDATA[$mytable = 'This is my test for variable in session' ]]&gt;&lt;/command&gt;

       &lt;command ignore-exit-code="false"&gt;write-output $mytable&lt;/command&gt;

     &lt;/commands&gt;</description>
        <from>commands</from>
        <to>commands</to>
      </input>
      <input global="false" required="false">
        <description>The method of encryption used
for the command value provided.
Valid values: Base64, Plain</description>
        <from>command encryption type</from>
        <to>command encryption type</to>
      </input>
      <input global="false" required="false">
        <description>Time, in whole seconds, allotted
to complete the execution of the
command.</description>
        <from>command timeout</from>
        <to>command timeout</to>
      </input>
      <input global="false" required="false">
        <description>Identifies the target defined in the Powershell Actor Adapter configuration (in Grid Manager).</description>
        <from>target</from>
        <to>target</to>
      </input>
      <input global="false" required="false">
        <description>The host name or IP address where the command will be executed.</description>
        <from>host name</from>
        <to>host name</to>
      </input>
      <input global="false" required="false">
        <description>The user name/account name that will be used to execute the command on the remote host.</description>
        <from>user name</from>
        <to>user name</to>
      </input>
      <input global="false" required="false">
        <description>The password for the user name/account that will be used to execute the command on the remote host.</description>
        <from>password</from>
        <to>password</to>
      </input>
      <input global="false" required="false">
        <description>If set to true, the Service Control Manager of remote/target system is opened with the user specified in adapter request. 

Valid values: true, false

Default value: false (by default, Service Control Manager of remote/target system is opened with the same user under which BAO service is running [as logon user]) </description>
        <from>impersonate user</from>
        <to>impersonate user</to>
      </input>
      <input global="false" required="false">
        <description>The method of encryption used
for the password value provided.
Valid values: Base64, Plain</description>
        <from>password encryption type</from>
        <to>password encryption type</to>
      </input>
      <input global="false" required="false">
        <description>If input value specified is “64bit”, xCommand (xCommand utility is used in Windows command adapter to connect to remote system) service is launched in *64 Bit image mode* on remote system to execute the commands, otherwise service is launched in 32 bit mode.

Specify the value “64bit” if and only if commands need to be run on 64 bit image mode; otherwise do not specify any value.

It is recommended to select the “64bit” bit mode on 64-bit remote system types if and only if the command requires accessing the 64 bit resources. If “64bit” is specified The Windows command request takes more time if service is launched in 64 bit as compared to 32 bit image mode.</description>
        <from>service launch mode</from>
        <to>service launch mode</to>
      </input>
      <input global="false" required="false">
        <description>If the value is true, the remote service is started using the credentials specified in the adapter configuration; else, the remote service is started using system credentials.

Valid values:

true, false</description>
        <from>logon with user credentials</from>
        <to>logon with user credentials</to>
      </input>
      <input global="false" required="false">
        <description>Deprecated. Commands will be executed using Powershell on the system path (both local and remote target).</description>
        <from>version</from>
        <to>version</to>
      </input>
      <input global="false" required="false">
        <description>Whether to use the user profile or not?. Valid values are "true" or "false".</description>
        <from>use user profile</from>
        <to>use user profile</to>
      </input>
      <input global="false" required="false">
        <description>Windows PowerShell console file. valid file extension is '.psc1'</description>
        <from>console file</from>
        <to>console file</to>
      </input>
      <input global="false" required="false">
        <from>character set</from>
        <to>character set</to>
      </input>
      <input global="false" required="false">
        <description>Determines whether to enable remoting feature of powershell 2.0.
valid values: true,false</description>
        <from>enable psremoting</from>
        <to>enable psremoting</to>
      </input>
      <input global="false" required="false">
        <description>Determines whether to execute the commands in single session (i.e. interactive session) in PS remoting Mode.

Valid values: True, False (case insensitive)
Default Value: False

Please Note: "enable psremoting" input must be set to 'True' if this input parameter is enabled (i.e. set to True), otherwise this parameter won't be considered. </description>
        <from>enable psremoting session</from>
        <to>enable psremoting session</to>
      </input>
      <input global="false" required="false">
        <description>Reference name of connection to be persisted.

This functionality is only applicable for PS remoting session based approach i.e.enable psremoting (enable-psremoting) and enable psremoting session (enable-psremoting-session) must be set to true. </description>
        <from>connection name</from>
        <to>connection name</to>
      </input>
      <input global="false" required="false">
        <description>Indicates whether the PS Remoting connection should be terminated, this parameter will only be considered when connection name is provided and default value is false when connection name is provided.</description>
        <from>terminate connection</from>
        <to>terminate connection</to>
      </input>
      <input global="false" required="false">
        <description>Specifies the duration (in seconds) for which a named connection should persist and invalidated or expires when connection is idle for given TTL (time to live) duration. default value 60 seconds.</description>
        <from>connection TTL</from>
        <to>connection TTL</to>
      </input>
      <input global="false" required="false">
        <description>Flag is to enable/ disable the New-PSSession command.

if true : New-PSSession will be used for authentication
if false : Enter-PSSession cmdlet is used for authetication.</description>
        <from>new ps session</from>
        <to>new ps session</to>
      </input>
      <input global="false" required="false">
        <description>New-PSSession cmdlet provide various options, so this input XML parameter can be used to specify the options which will be added while creatting new PS session. This parameter will only be considered for New-PSSession i.e. when "new ps session" parameter is set to true.


Sample XML

Element Name would be the option name 
e.g. if option is -Authentication and value to be specified is credssp, then XML element would be

&lt;Authentication&gt;credssp&lt;/Authentication&gt;
 

&lt;ps-session-options&gt;
&lt;Authentication&gt;credssp&lt;Authentication&gt;
&lt;usessl&gt;usessl&lt;/usessl&gt;
&lt;SessionOption&gt;(new-pssessionoption -SkipCACheck -SkipRevocationCheck -SkipCNCheck)&lt;/SessionOption&gt;
&lt;/ps-session-options&gt;

PLEASE NOTE: DO NOT SPECIFY BELOW ARGUMENTS AS ADAPTER BY DEFAULT ADD THESE BELOW OPTIONS WHICH IS NECESSARY FOR AUTHETICATION AND CREATE SESSION NAME

-Name
-ComputerName
-Credential

Below option from https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/new-pssession?view=powershell-6

New-PSSession
   [[-ComputerName] &lt;String[]&gt;]
   [-Credential &lt;PSCredential&gt;]
   [-Name &lt;String[]&gt;]
   [-EnableNetworkAccess]
   [-ConfigurationName &lt;String&gt;]
   [-Port &lt;Int32&gt;]
   [-UseSSL]
   [-ApplicationName &lt;String&gt;]
   [-ThrottleLimit &lt;Int32&gt;]
   [-SessionOption &lt;PSSessionOption&gt;]
   [-Authentication &lt;AuthenticationMechanism&gt;]
   [-CertificateThumbprint &lt;String&gt;]
   [&lt;CommonParameters&gt;]</description>
        <from>new ps session options</from>
        <to>new ps session options</to>
      </input>
      <output global="false" required="false">
        <description>An adapter response contains the result returned from an adapter request. The contents of the response will vary by adapter.</description>
        <to>adapter response</to>
        <from>adapter response</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <spawn>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <sequence>
          <switch>
            <meta>
              <documentation />
              <run-mode-handling>
                <run-mode>OCP</run-mode>
                <allow-step-into>true</allow-step-into>
              </run-mode-handling>
              <checkpoint>false</checkpoint>
            </meta>
            <execute-all-applicable-cases>false</execute-all-applicable-cases>
            <default>
              <sequence />
            </default>
            <case>
              <condition>
                <document>
                  <input>
                    <from>adapter name</from>
                  </input>
                </document>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[string-length()=0]]></xpath>
                </xpath-expression>
              </condition>
              <sequence>
                <assign>
                  <assignment>
                    <output>
                      <to>adapter name</to>
                      <value>MicrosoftPowerShell</value>
                    </output>
                  </assignment>
                  <meta>
                    <documentation />
                    <checkpoint>false</checkpoint>
                  </meta>
                  <location>:spawn[1]:sequence[1]:switch[1]:sequence[2]:assign[1]</location>
                </assign>
              </sequence>
            </case>
            <location>:spawn[1]:sequence[1]:switch[1]</location>
          </switch>
        </sequence>
        <sequence>
          <switch>
            <meta>
              <documentation />
              <run-mode-handling>
                <run-mode>OCP</run-mode>
                <allow-step-into>true</allow-step-into>
              </run-mode-handling>
              <checkpoint>false</checkpoint>
            </meta>
            <execute-all-applicable-cases>false</execute-all-applicable-cases>
            <default>
              <sequence>
                <assign>
                  <assignment>
                    <output>
                      <to>commands</to>
                      <value>
                        <commands>
                          <command>dir</command>
                        </commands>
                      </value>
                    </output>
                  </assignment>
                  <meta>
                    <documentation />
                    <checkpoint>false</checkpoint>
                  </meta>
                  <location>:spawn[1]:sequence[2]:switch[1]:sequence[1]:assign[1]</location>
                </assign>
              </sequence>
            </default>
            <case applies-if-any-condition-true="false">
              <condition>
                <document>
                  <input>
                    <from>command</from>
                  </input>
                </document>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[string-length(.) >0]]></xpath>
                </xpath-expression>
              </condition>
              <condition>
                <document>
                  <input>
                    <from>command</from>
                  </input>
                </document>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[name(.) !='fat-command']]></xpath>
                </xpath-expression>
              </condition>
              <condition>
                <document>
                  <input>
                    <from>commands</from>
                  </input>
                </document>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[string-length(.) = 0]]></xpath>
                </xpath-expression>
              </condition>
              <sequence>
                <assign>
                  <assignment>
                    <document>
                      <input>
                        <from>command</from>
                      </input>
                    </document>
                    <result>
                      <output>
                        <to>commands</to>
                      </output>
                    </result>
                    <xslt-stylesheet>
                      <stylesheet-replacement-tokens>
                        <replacement-token name="command timeout">
                          <input global="false">
                            <from>command timeout</from>
                          </input>
                        </replacement-token>
                        <replacement-token name="command encryption type">
                          <input global="false">
                            <from>command encryption type</from>
                          </input>
                        </replacement-token>
                        <replacement-token name="command">
                          <input global="false">
                            <from>command</from>
                          </input>
                        </replacement-token>
                      </stylesheet-replacement-tokens>
                      <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <commands>
      <command>
        <xsl:attribute name="timeout-secs">
          <xsl:if test="string-length('${command timeout}') != 0">
            <xsl:text disable-output-escaping="no">${command timeout}</xsl:text>
          </xsl:if>
        </xsl:attribute>
        <xsl:attribute name="encryption-type">
          <xsl:if test="string-length('${command encryption type}') != 0">
            <xsl:text disable-output-escaping="no">${command encryption type}</xsl:text>
          </xsl:if>
        </xsl:attribute>
        <xsl:text disable-output-escaping="no">$[command]</xsl:text>
      </command>
    </commands>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                    </xslt-stylesheet>
                  </assignment>
                  <meta>
                    <documentation />
                    <checkpoint>false</checkpoint>
                  </meta>
                  <after-execution>
                    <log>
                      <level>debug</level>
                      <parameters>
                        <input>
                          <value>#### Command converted to commands</value>
                        </input>
                        <input>
                          <from>commands</from>
                        </input>
                      </parameters>
                    </log>
                  </after-execution>
                  <location>:spawn[1]:sequence[2]:switch[1]:sequence[2]:assign[1]</location>
                </assign>
              </sequence>
            </case>
            <case applies-if-any-condition-true="false">
              <condition>
                <document>
                  <input>
                    <from>commands</from>
                  </input>
                </document>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[string-length(.) > 0]]></xpath>
                </xpath-expression>
              </condition>
              <condition>
                <document>
                  <input>
                    <from>commands</from>
                  </input>
                </document>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[name(.)!='fat-command']]></xpath>
                </xpath-expression>
              </condition>
              <condition>
                <document>
                  <input>
                    <from>command</from>
                  </input>
                </document>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[string-length(.) =0]]></xpath>
                </xpath-expression>
              </condition>
              <sequence>
                <assign>
                  <assignment>
                    <input>
                      <from>commands</from>
                    </input>
                    <output>
                      <to>commands</to>
                    </output>
                  </assignment>
                  <meta>
                    <documentation />
                    <checkpoint>false</checkpoint>
                  </meta>
                  <location>:spawn[1]:sequence[2]:switch[1]:sequence[3]:assign[1]</location>
                </assign>
              </sequence>
            </case>
            <location>:spawn[1]:sequence[2]:switch[1]</location>
          </switch>
        </sequence>
        <location>:spawn[1]</location>
      </spawn>
      <assign>
        <assignment>
          <document>
            <input>
              <from>password</from>
            </input>
          </document>
          <result>
            <output>
              <to>password-output</to>
            </output>
          </result>
          <xslt-stylesheet>
            <stylesheet-replacement-tokens>
              <replacement-token name="password">
                <input global="false">
                  <from>password</from>
                </input>
              </replacement-token>
            </stylesheet-replacement-tokens>
            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <password-holder>
      <xsl:text disable-output-escaping="no">&lt;![CDATA[$[password]]]&gt;</xsl:text>
    </password-holder>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
          </xslt-stylesheet>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <location>:assign[1]</location>
      </assign>
      <switch>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <execute-all-applicable-cases>false</execute-all-applicable-cases>
        <default>
          <sequence>
            <switch>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>true</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <execute-all-applicable-cases>false</execute-all-applicable-cases>
              <default>
                <sequence>
                  <assign>
                    <assignment>
                      <document>
                        <input>
                          <from>commands</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>adapter request</to>
                        </output>
                      </result>
                      <xslt-stylesheet>
                        <stylesheet-replacement-tokens>
                          <replacement-token name="command timeout">
                            <input global="false">
                              <from>command timeout</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="command">
                            <input global="false">
                              <from>command</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="host name">
                            <input global="false">
                              <from>host name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="user name">
                            <input global="false">
                              <from>user name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="password">
                            <input global="false">
                              <from>password</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="version">
                            <input global="false">
                              <from>version</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="console file">
                            <input global="false">
                              <from>console file</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="use user profile">
                            <input global="false">
                              <from>use user profile</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="command encryption type">
                            <input global="false">
                              <from>command encryption type</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="password encryption type">
                            <input global="false">
                              <from>password encryption type</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="target">
                            <input global="false">
                              <from>target</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="character-set">
                            <input global="false">
                              <from>character set</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="enable-psremoting">
                            <input global="false">
                              <from>enable psremoting</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="service launch mode">
                            <input global="false">
                              <from>service launch mode</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="impersonate user">
                            <input global="false">
                              <from>impersonate user</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="logon with user credentials">
                            <input global="false">
                              <from>logon with user credentials</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="enable psremoting session">
                            <input global="false">
                              <from>enable psremoting session</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="connection name">
                            <input global="false">
                              <from>connection name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="connection ttl">
                            <input global="false">
                              <from>connection TTL</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="terminate connection">
                            <input global="false">
                              <from>terminate connection</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="new ps session">
                            <input global="false">
                              <from>new ps session</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="new ps session option">
                            <input global="false">
                              <from>new ps session options</from>
                            </input>
                          </replacement-token>
                        </stylesheet-replacement-tokens>
                        <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <request-data>
      <powershell-request>
        <targets>
          <xsl:if test="string-length('${target}') != 0">
            <target name="${target}" />
          </xsl:if>
          <xsl:if test="string-length('${host name}') != 0">
            <target>
              <host>
                <xsl:text disable-output-escaping="no">$[host name]</xsl:text>
              </host>
              <userName>${user name}</userName>
              <password>
                <xsl:attribute name="encryption-type">
                  <xsl:if test="string-length('${password encryption type}') != 0">
                    <xsl:if test="'${password encryption type}'='Base64'">
                      <xsl:text disable-output-escaping="no">${password encryption type}</xsl:text>
                    </xsl:if>
                    <xsl:if test="'${password encryption type}'='Plain'">
                      <xsl:text disable-output-escaping="no">${password encryption type}</xsl:text>
                    </xsl:if>
                    <xsl:if test="'${password encryption type}'!='Base64' and '${password encryption type}'!='Plain'">
                      <xsl:text disable-output-escaping="no">Plain</xsl:text>
                    </xsl:if>
                  </xsl:if>
                  <xsl:if test="string-length('${password encryption type}') = 0">
                    <xsl:text disable-output-escaping="no">Plain</xsl:text>
                  </xsl:if>
                </xsl:attribute>
                ${password}
              </password>
              <impersonate-user>
                <xsl:text disable-output-escaping="no">${impersonate user}</xsl:text>
              </impersonate-user>
              <logon-with-user-credentials>
                <xsl:text disable-output-escaping="no">${logon with user credentials}</xsl:text>
              </logon-with-user-credentials>
              <service-launch-mode>
                <xsl:text disable-output-escaping="no">${service launch mode}</xsl:text>
              </service-launch-mode>
              <character-set>${character-set}</character-set>
              <xsl:if test="string-length('${version}') != 0">
                <xsl:choose>
                  <xsl:when test="'${version}'='1.0'">
                    <powershell-version>
                      <xsl:text disable-output-escaping="no">${version}</xsl:text>
                    </powershell-version>
                  </xsl:when>
                  <xsl:when test="'${version}'='2.0'">
                    <powershell-version>
                      <xsl:text disable-output-escaping="no">${version}</xsl:text>
                    </powershell-version>
                  </xsl:when>
                  <xsl:otherwise>
                    <powershell-version>
                      <xsl:text disable-output-escaping="no">${version}</xsl:text>
                    </powershell-version>
                  </xsl:otherwise>
                </xsl:choose>
              </xsl:if>
              <xsl:if test="string-length('${console file}') != 0">
                <powershell-consolefile>
                  <xsl:text disable-output-escaping="no">${console file}</xsl:text>
                </powershell-consolefile>
              </xsl:if>
              <xsl:if test="string-length('${use user profile}') != 0">
                <xsl:choose>
                  <xsl:when test="'${use user profile}'='true'">
                    <use-userprofile>
                      <xsl:text disable-output-escaping="no">${use user profile}</xsl:text>
                    </use-userprofile>
                  </xsl:when>
                  <xsl:when test="'${use user profile}'='false'">
                    <use-userprofile>
                      <xsl:text disable-output-escaping="no">${use user profile}</xsl:text>
                    </use-userprofile>
                  </xsl:when>
                  <xsl:otherwise>
                    <use-userprofile>
                      <xsl:text disable-output-escaping="no">${use user profile}</xsl:text>
                    </use-userprofile>
                  </xsl:otherwise>
                </xsl:choose>
              </xsl:if>
              <xsl:if test="string-length('${enable-psremoting}') != 0">
                <xsl:choose>
                  <xsl:when test="'${enable-psremoting}'='true'">
                    <enable-psremoting>
                      <xsl:text disable-output-escaping="no">${enable-psremoting}</xsl:text>
                    </enable-psremoting>
                  </xsl:when>
                  <xsl:when test="'${enable-psremoting}'='false'">
                    <enable-psremoting>
                      <xsl:text disable-output-escaping="no">${enable-psremoting}</xsl:text>
                    </enable-psremoting>
                  </xsl:when>
                  <xsl:otherwise>
                    <enable-psremoting>
                      <xsl:text disable-output-escaping="no">${enable-psremoting}</xsl:text>
                    </enable-psremoting>
                  </xsl:otherwise>
                </xsl:choose>
              </xsl:if>
              <enable-psremoting-session>${enable psremoting session}</enable-psremoting-session>
              <connection-name>$[connection name]</connection-name>
              <terminate-on-exit>${terminate connection}</terminate-on-exit>
              <connection-ttl>${connection ttl}</connection-ttl>
              <new-ps-session>${new ps session}</new-ps-session>
              ${new ps session option}
            </target>
          </xsl:if>
        </targets>
        <xsl:copy-of select="." />
      </powershell-request>
    </request-data>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                      </xslt-stylesheet>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <location>:switch[1]:sequence[1]:switch[1]:sequence[1]:assign[1]</location>
                  </assign>
                </sequence>
              </default>
              <case>
                <condition>
                  <document>
                    <input>
                      <from>password-output</from>
                    </input>
                  </document>
                  <xpath-expression>
                    <xpath-replacement-tokens />
                    <xpath><![CDATA[not(contains(., 'EncryptedData'))  and  not(contains(., 'CipherData')) ]]></xpath>
                  </xpath-expression>
                </condition>
                <sequence>
                  <assign>
                    <assignment>
                      <document>
                        <input>
                          <from>commands</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>adapter request</to>
                        </output>
                      </result>
                      <xslt-stylesheet>
                        <stylesheet-replacement-tokens>
                          <replacement-token name="command timeout">
                            <input global="false">
                              <from>command timeout</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="command">
                            <input global="false">
                              <from>command</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="host name">
                            <input global="false">
                              <from>host name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="user name">
                            <input global="false">
                              <from>user name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="password">
                            <input global="false">
                              <from>password</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="version">
                            <input global="false">
                              <from>version</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="console file">
                            <input global="false">
                              <from>console file</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="use user profile">
                            <input global="false">
                              <from>use user profile</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="command encryption type">
                            <input global="false">
                              <from>command encryption type</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="password encryption type">
                            <input global="false">
                              <from>password encryption type</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="target">
                            <input global="false">
                              <from>target</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="character-set">
                            <input global="false">
                              <from>character set</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="enable-psremoting">
                            <input global="false">
                              <from>enable psremoting</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="service launch mode">
                            <input global="false">
                              <from>service launch mode</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="impersonate user">
                            <input global="false">
                              <from>impersonate user</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="logon with user credentials">
                            <input global="false">
                              <from>logon with user credentials</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="enable psremoting session">
                            <input global="false">
                              <from>enable psremoting session</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="connection name">
                            <input global="false">
                              <from>connection name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="terminate connection">
                            <input global="false">
                              <from>terminate connection</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="connection ttl">
                            <input global="false">
                              <from>connection TTL</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="new ps session">
                            <input global="false">
                              <from>new ps session</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="new ps session options">
                            <input global="false">
                              <from>new ps session options</from>
                            </input>
                          </replacement-token>
                        </stylesheet-replacement-tokens>
                        <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <request-data>
      <powershell-request>
        <targets>
          <xsl:if test="string-length('${target}') != 0">
            <target name="${target}" />
          </xsl:if>
          <xsl:if test="string-length('${host name}') != 0">
            <target>
              <host>
                <xsl:text disable-output-escaping="no">$[host name]</xsl:text>
              </host>
              <userName>${user name}</userName>
              <password>
                <xsl:attribute name="encryption-type">
                  <xsl:if test="string-length('${password encryption type}') != 0">
                    <xsl:if test="'${password encryption type}'='Base64'">
                      <xsl:text disable-output-escaping="no">${password encryption type}</xsl:text>
                    </xsl:if>
                    <xsl:if test="'${password encryption type}'='Plain'">
                      <xsl:text disable-output-escaping="no">${password encryption type}</xsl:text>
                    </xsl:if>
                    <xsl:if test="'${password encryption type}'!='Base64' and '${password encryption type}'!='Plain'">
                      <xsl:text disable-output-escaping="no">Plain</xsl:text>
                    </xsl:if>
                  </xsl:if>
                  <xsl:if test="string-length('${password encryption type}') = 0">
                    <xsl:text disable-output-escaping="no">Plain</xsl:text>
                  </xsl:if>
                </xsl:attribute>
                <xsl:text disable-output-escaping="no">$[password]</xsl:text>
              </password>
              <impersonate-user>
                <xsl:text disable-output-escaping="no">${impersonate user}</xsl:text>
              </impersonate-user>
              <logon-with-user-credentials>
                <xsl:text disable-output-escaping="no">${logon with user credentials}</xsl:text>
              </logon-with-user-credentials>
              <service-launch-mode>
                <xsl:text disable-output-escaping="no">${service launch mode}</xsl:text>
              </service-launch-mode>
              <character-set>${character-set}</character-set>
              <xsl:if test="string-length('${version}') != 0">
                <xsl:choose>
                  <xsl:when test="'${version}'='1.0'">
                    <powershell-version>
                      <xsl:text disable-output-escaping="no">${version}</xsl:text>
                    </powershell-version>
                  </xsl:when>
                  <xsl:when test="'${version}'='2.0'">
                    <powershell-version>
                      <xsl:text disable-output-escaping="no">${version}</xsl:text>
                    </powershell-version>
                  </xsl:when>
                  <xsl:otherwise>
                    <powershell-version>
                      <xsl:text disable-output-escaping="no">${version}</xsl:text>
                    </powershell-version>
                  </xsl:otherwise>
                </xsl:choose>
              </xsl:if>
              <xsl:if test="string-length('${console file}') != 0">
                <powershell-consolefile>
                  <xsl:text disable-output-escaping="no">${console file}</xsl:text>
                </powershell-consolefile>
              </xsl:if>
              <xsl:if test="string-length('${use user profile}') != 0">
                <xsl:choose>
                  <xsl:when test="'${use user profile}'='true'">
                    <use-userprofile>
                      <xsl:text disable-output-escaping="no">${use user profile}</xsl:text>
                    </use-userprofile>
                  </xsl:when>
                  <xsl:when test="'${use user profile}'='false'">
                    <use-userprofile>
                      <xsl:text disable-output-escaping="no">${use user profile}</xsl:text>
                    </use-userprofile>
                  </xsl:when>
                  <xsl:otherwise>
                    <use-userprofile>
                      <xsl:text disable-output-escaping="no">${use user profile}</xsl:text>
                    </use-userprofile>
                  </xsl:otherwise>
                </xsl:choose>
              </xsl:if>
              <xsl:if test="string-length('${enable-psremoting}') != 0">
                <xsl:choose>
                  <xsl:when test="'${enable-psremoting}'='true'">
                    <enable-psremoting>
                      <xsl:text disable-output-escaping="no">${enable-psremoting}</xsl:text>
                    </enable-psremoting>
                  </xsl:when>
                  <xsl:when test="'${enable-psremoting}'='false'">
                    <enable-psremoting>
                      <xsl:text disable-output-escaping="no">${enable-psremoting}</xsl:text>
                    </enable-psremoting>
                  </xsl:when>
                  <xsl:otherwise>
                    <enable-psremoting>
                      <xsl:text disable-output-escaping="no">${enable-psremoting}</xsl:text>
                    </enable-psremoting>
                  </xsl:otherwise>
                </xsl:choose>
              </xsl:if>
              <enable-psremoting-session>${enable psremoting session}</enable-psremoting-session>
              <connection-name>$[connection name]</connection-name>
              <terminate-on-exit>${terminate connection}</terminate-on-exit>
              <connection-ttl>${connection ttl}</connection-ttl>
              <new-ps-session>${new ps session}</new-ps-session>
              ${new ps session options}
            </target>
          </xsl:if>
        </targets>
        <xsl:copy-of select="." />
      </powershell-request>
    </request-data>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                      </xslt-stylesheet>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <before-execution>
                      <log>
                        <level>debug</level>
                        <parameters>
                          <input>
                            <value>Adapter request without secure password</value>
                          </input>
                          <input>
                            <value></value>
                          </input>
                        </parameters>
                      </log>
                    </before-execution>
                    <location>:switch[1]:sequence[1]:switch[1]:sequence[2]:assign[1]</location>
                  </assign>
                </sequence>
              </case>
              <location>:switch[1]:sequence[1]:switch[1]</location>
            </switch>
          </sequence>
        </default>
        <case>
          <condition>
            <document>
              <input>
                <from>command</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[name(.)='fat-command']]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <switch>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>true</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <execute-all-applicable-cases>false</execute-all-applicable-cases>
              <default>
                <sequence>
                  <assign>
                    <assignment>
                      <document>
                        <input>
                          <from>command</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>adapter request</to>
                        </output>
                      </result>
                      <xslt-stylesheet>
                        <stylesheet-replacement-tokens>
                          <replacement-token name="host name">
                            <input global="false">
                              <from>host name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="command timeout">
                            <input global="false">
                              <from>command timeout</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="user name">
                            <input global="false">
                              <from>user name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="password">
                            <input global="false">
                              <from>password</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="version">
                            <input global="false">
                              <from>version</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="console file">
                            <input global="false">
                              <from>console file</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="use user profile">
                            <input global="false">
                              <from>use user profile</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="password encryption type">
                            <input global="false">
                              <from>password encryption type</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="command encryption type">
                            <input global="false">
                              <from>command encryption type</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="character-set">
                            <input global="false">
                              <from>character set</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="enable-psremoting">
                            <input global="false">
                              <from>enable psremoting</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="service launch mode">
                            <input global="false">
                              <from>service launch mode</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="impersonate user">
                            <input global="false">
                              <from>impersonate user</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="logon with user credentials">
                            <input global="false">
                              <from>logon with user credentials</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="enable psremoting session">
                            <input global="false">
                              <from>enable psremoting session</from>
                            </input>
                          </replacement-token>
                        </stylesheet-replacement-tokens>
                        <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <request-data>
      <powershell-request>
        <xsl:if test="string-length('${host name}') != 0">
          <targets>
            <target>
              <host>
                <xsl:text disable-output-escaping="no">$[host name]</xsl:text>
              </host>
              <userName>${user name}</userName>
              <password>
                <xsl:attribute name="encryption-type">
                  <xsl:if test="string-length('${password encryption type}') != 0">
                    <xsl:if test="'${password encryption type}'='Base64'">
                      <xsl:text disable-output-escaping="no">Base64</xsl:text>
                    </xsl:if>
                    <xsl:if test="'${password encryption type}'='Plain'">
                      <xsl:text disable-output-escaping="no">Plain</xsl:text>
                    </xsl:if>
                    <xsl:if test="'${password encryption type}'!='Plain' and '${password encryption type}'!='Base64'">
                      <xsl:text disable-output-escaping="no">Plain</xsl:text>
                    </xsl:if>
                  </xsl:if>
                  <xsl:if test="string-length('${password encryption type}') = 0">
                    <xsl:text disable-output-escaping="no">Plain</xsl:text>
                  </xsl:if>
                </xsl:attribute>
                ${password}
              </password>
              <impersonate-user>
                <xsl:text disable-output-escaping="no">${impersonate user}</xsl:text>
              </impersonate-user>
              <logon-with-user-credentials>
                <xsl:text disable-output-escaping="no">${logon with user credentials}</xsl:text>
              </logon-with-user-credentials>
              <service-launch-mode>
                <xsl:text disable-output-escaping="no">${service launch mode}</xsl:text>
              </service-launch-mode>
              <character-set>${character-set}</character-set>
              <xsl:if test="string-length('${version}') != 0">
                <xsl:choose>
                  <xsl:when test="'${version}'='1.0'">
                    <powershell-version>
                      <xsl:text disable-output-escaping="no">${version}</xsl:text>
                    </powershell-version>
                  </xsl:when>
                  <xsl:when test="'${version}'='2.0'">
                    <powershell-version>
                      <xsl:text disable-output-escaping="no">${version}</xsl:text>
                    </powershell-version>
                  </xsl:when>
                  <xsl:otherwise>
                    <powershell-version>
                      <xsl:text disable-output-escaping="no">${version}</xsl:text>
                    </powershell-version>
                  </xsl:otherwise>
                </xsl:choose>
              </xsl:if>
              <xsl:if test="string-length('${console file}') != 0">
                <powershell-consolefile>
                  <xsl:text disable-output-escaping="no">${console file}</xsl:text>
                </powershell-consolefile>
              </xsl:if>
              <xsl:if test="string-length('${use user profile}') != 0">
                <xsl:choose>
                  <xsl:when test="'${use user profile}'='true'">
                    <use-userprofile>
                      <xsl:text disable-output-escaping="no">${use user profile}</xsl:text>
                    </use-userprofile>
                  </xsl:when>
                  <xsl:when test="'${use user profile}'='false'">
                    <use-userprofile>
                      <xsl:text disable-output-escaping="no">${use user profile}</xsl:text>
                    </use-userprofile>
                  </xsl:when>
                  <xsl:otherwise>
                    <use-userprofile>
                      <xsl:text disable-output-escaping="no">${use user profile}</xsl:text>
                    </use-userprofile>
                  </xsl:otherwise>
                </xsl:choose>
              </xsl:if>
              <xsl:if test="string-length('${enable-psremoting}') != 0">
                <xsl:choose>
                  <xsl:when test="'${enable psremoting}'='true'">
                    <enable-psremoting>
                      <xsl:text disable-output-escaping="no">${enable-psremoting}</xsl:text>
                    </enable-psremoting>
                  </xsl:when>
                  <xsl:when test="'${enable-psremoting}'='false'">
                    <enable-psremoting>
                      <xsl:text disable-output-escaping="no">${enable-psremoting}</xsl:text>
                    </enable-psremoting>
                  </xsl:when>
                  <xsl:otherwise>
                    <enable-psremoting>
                      <xsl:text disable-output-escaping="no">${enable-psremoting}</xsl:text>
                    </enable-psremoting>
                  </xsl:otherwise>
                </xsl:choose>
              </xsl:if>
              <enable-psremoting-session>${enable psremoting session}</enable-psremoting-session>
            </target>
          </targets>
        </xsl:if>
        <commands>
          <fat-command>
            <xsl:for-each select="fat-command/command | fat-command/commands">
              <xsl:copy>
                <xsl:copy-of select="attribute::*" />
                <xsl:if test="string-length('${command timeout}') != 0">
                  <xsl:attribute name="timeout-secs">${command timeout}</xsl:attribute>
                </xsl:if>
                <xsl:if test="string-length('${command encryption type}') != 0">
                  <xsl:attribute name="encryption-type">${command encryption type}</xsl:attribute>
                </xsl:if>
                <xsl:copy-of select="node()" />
              </xsl:copy>
            </xsl:for-each>
          </fat-command>
        </commands>
      </powershell-request>
    </request-data>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                      </xslt-stylesheet>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[1]:assign[1]</location>
                  </assign>
                </sequence>
              </default>
              <case>
                <condition>
                  <document>
                    <input>
                      <from>password-output</from>
                    </input>
                  </document>
                  <xpath-expression>
                    <xpath-replacement-tokens />
                    <xpath><![CDATA[not(contains(., 'EncryptedData'))]]></xpath>
                  </xpath-expression>
                </condition>
                <sequence>
                  <assign>
                    <assignment>
                      <document>
                        <input>
                          <from>command</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>adapter request</to>
                        </output>
                      </result>
                      <xslt-stylesheet>
                        <stylesheet-replacement-tokens>
                          <replacement-token name="host name">
                            <input global="false">
                              <from>host name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="command timeout">
                            <input global="false">
                              <from>command timeout</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="user name">
                            <input global="false">
                              <from>user name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="password">
                            <input global="false">
                              <from>password</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="version">
                            <input global="false">
                              <from>version</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="console file">
                            <input global="false">
                              <from>console file</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="use user profile">
                            <input global="false">
                              <from>use user profile</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="password encryption type">
                            <input global="false">
                              <from>password encryption type</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="command encryption type">
                            <input global="false">
                              <from>command encryption type</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="character-set">
                            <input global="false">
                              <from>character set</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="enable-psremoting">
                            <input global="false">
                              <from>enable psremoting</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="service launch mode">
                            <input global="false">
                              <from>service launch mode</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="impersonate user">
                            <input global="false">
                              <from>impersonate user</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="logon with user credentials">
                            <input global="false">
                              <from>logon with user credentials</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="enable psremoting session">
                            <input global="false">
                              <from>enable psremoting session</from>
                            </input>
                          </replacement-token>
                        </stylesheet-replacement-tokens>
                        <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <request-data>
      <powershell-request>
        <xsl:if test="string-length('${host name}') != 0">
          <targets>
            <target>
              <host>
                <xsl:text disable-output-escaping="no">$[host name]</xsl:text>
              </host>
              <userName>${user name}</userName>
              <password>
                <xsl:attribute name="encryption-type">
                  <xsl:if test="string-length('${password encryption type}') != 0">
                    <xsl:if test="'${password encryption type}'='Base64'">
                      <xsl:text disable-output-escaping="no">Base64</xsl:text>
                    </xsl:if>
                    <xsl:if test="'${password encryption type}'='Plain'">
                      <xsl:text disable-output-escaping="no">Plain</xsl:text>
                    </xsl:if>
                    <xsl:if test="'${password encryption type}'!='Plain' and '${password encryption type}'!='Base64'">
                      <xsl:text disable-output-escaping="no">Plain</xsl:text>
                    </xsl:if>
                  </xsl:if>
                  <xsl:if test="string-length('${password encryption type}') = 0">
                    <xsl:text disable-output-escaping="no">Plain</xsl:text>
                  </xsl:if>
                </xsl:attribute>
                <xsl:text disable-output-escaping="no">$[password]</xsl:text>
              </password>
              <impersonate-user>
                <xsl:text disable-output-escaping="no">${impersonate user}</xsl:text>
              </impersonate-user>
              <logon-with-user-credentials>
                <xsl:text disable-output-escaping="no">${logon with user credentials}</xsl:text>
              </logon-with-user-credentials>
              <service-launch-mode>
                <xsl:text disable-output-escaping="no">${service launch mode}</xsl:text>
              </service-launch-mode>
              <character-set>${character-set}</character-set>
              <xsl:if test="string-length('${version}') != 0">
                <xsl:choose>
                  <xsl:when test="'${version}'='1.0'">
                    <powershell-version>
                      <xsl:text disable-output-escaping="no">${version}</xsl:text>
                    </powershell-version>
                  </xsl:when>
                  <xsl:when test="'${version}'='2.0'">
                    <powershell-version>
                      <xsl:text disable-output-escaping="no">${version}</xsl:text>
                    </powershell-version>
                  </xsl:when>
                  <xsl:otherwise>
                    <powershell-version>
                      <xsl:text disable-output-escaping="no">${version}</xsl:text>
                    </powershell-version>
                  </xsl:otherwise>
                </xsl:choose>
              </xsl:if>
              <xsl:if test="string-length('${console file}') != 0">
                <powershell-consolefile>
                  <xsl:text disable-output-escaping="no">${console file}</xsl:text>
                </powershell-consolefile>
              </xsl:if>
              <xsl:if test="string-length('${use user profile}') != 0">
                <xsl:choose>
                  <xsl:when test="'${use user profile}'='true'">
                    <use-userprofile>
                      <xsl:text disable-output-escaping="no">${use user profile}</xsl:text>
                    </use-userprofile>
                  </xsl:when>
                  <xsl:when test="'${use user profile}'='false'">
                    <use-userprofile>
                      <xsl:text disable-output-escaping="no">${use user profile}</xsl:text>
                    </use-userprofile>
                  </xsl:when>
                  <xsl:otherwise>
                    <use-userprofile>
                      <xsl:text disable-output-escaping="no">${use user profile}</xsl:text>
                    </use-userprofile>
                  </xsl:otherwise>
                </xsl:choose>
              </xsl:if>
              <xsl:if test="string-length('${enable-psremoting}') != 0">
                <xsl:choose>
                  <xsl:when test="'${enable psremoting}'='true'">
                    <enable-psremoting>
                      <xsl:text disable-output-escaping="no">${enable-psremoting}</xsl:text>
                    </enable-psremoting>
                  </xsl:when>
                  <xsl:when test="'${enable-psremoting}'='false'">
                    <enable-psremoting>
                      <xsl:text disable-output-escaping="no">${enable-psremoting}</xsl:text>
                    </enable-psremoting>
                  </xsl:when>
                  <xsl:otherwise>
                    <enable-psremoting>
                      <xsl:text disable-output-escaping="no">${enable-psremoting}</xsl:text>
                    </enable-psremoting>
                  </xsl:otherwise>
                </xsl:choose>
              </xsl:if>
              <enable-psremoting-session>${enable psremoting session}</enable-psremoting-session>
            </target>
          </targets>
        </xsl:if>
        <commands>
          <fat-command>
            <xsl:for-each select="fat-command/command | fat-command/commands">
              <xsl:copy>
                <xsl:copy-of select="attribute::*" />
                <xsl:if test="string-length('${command timeout}') != 0">
                  <xsl:attribute name="timeout-secs">${command timeout}</xsl:attribute>
                </xsl:if>
                <xsl:if test="string-length('${command encryption type}') != 0">
                  <xsl:attribute name="encryption-type">${command encryption type}</xsl:attribute>
                </xsl:if>
                <xsl:copy-of select="node()" />
              </xsl:copy>
            </xsl:for-each>
          </fat-command>
        </commands>
      </powershell-request>
    </request-data>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                      </xslt-stylesheet>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <before-execution>
                      <log>
                        <level>debug</level>
                        <parameters>
                          <input>
                            <value>Fat Command adapter request without secure password</value>
                          </input>
                          <input>
                            <value></value>
                          </input>
                        </parameters>
                      </log>
                    </before-execution>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:assign[1]</location>
                  </assign>
                </sequence>
              </case>
              <location>:switch[1]:sequence[2]:switch[1]</location>
            </switch>
          </sequence>
        </case>
        <location>:switch[1]</location>
      </switch>
      <call-adapter>
        <parameters>
          <input global="false">
            <from>adapter name</from>
          </input>
          <input>
            <value>
              <adapter-request>
                <peer-location>
                  <location>any</location>
                </peer-location>
              </adapter-request>
            </value>
          </input>
          <input global="false">
            <from>adapter request</from>
          </input>
          <input global="false">
            <from>adapter request</from>
          </input>
          <output global="false">
            <to>adapter response</to>
          </output>
        </parameters>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <before-execution>
          <log>
            <level>debug</level>
            <parameters>
              <input>
                <from>adapter request</from>
              </input>
            </parameters>
          </log>
        </before-execution>
        <after-execution>
          <log>
            <level>debug</level>
            <parameters>
              <input>
                <from>adapter response</from>
              </input>
            </parameters>
          </log>
        </after-execution>
        <location>:call-adapter[1]</location>
      </call-adapter>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>RemotePowerShell Command Execution:
       Invokes Remote PowerShell Command Execution on an MS Windows Peer.  </description>
        <version>1.0</version>
      </documentation>
      <logging-options>
        <is-enabled>false</is-enabled>
        <log-file-name></log-file-name>
      </logging-options>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>6dd02eb0-5c0d-3904-83c1-5072d6c563ba</process-id>
      <author>admin</author>
      <category></category>
      <status></status>
      <keywords></keywords>
      <systems></systems>
      <last-modified-by>aoadmin</last-modified-by>
      <last-modified>1535299818122</last-modified>
    </meta>
  </process-def>
</process>