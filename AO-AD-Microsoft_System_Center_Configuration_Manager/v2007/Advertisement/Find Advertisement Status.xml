<process draft="false" dev-studio-version="7.6.02.00">
  <process-def name=":AO-AD-Microsoft_System_Center_Configuration_Manager:v2007:Advertisement:Find Advertisement Status">
    <parameters>
      <input global="false" required="false">
        <description>The name of the adapter to use to handle the request. 
Default adapter name: MSSCCMActor.</description>
        <from>adapter name</from>
        <to>adapter name</to>
      </input>
      <input global="false" required="true">
        <description>Sample items Xml:
		
&lt;items&gt;
	&lt;item&gt;
		&lt;target&gt;config2&lt;/target&gt;
		&lt;advertisement-id&gt;12320121&lt;/advertisement-id&gt;
		&lt;advertisement-name&gt;adv002&lt;/advertisement-name&gt;
		&lt;advertisements-failed&gt;0&lt;/advertisements-failed&gt;
		&lt;advertisements-received&gt;0&lt;/advertisements-received&gt;
		&lt;collection-id&gt;SMS00002&lt;/collection-id&gt;
		&lt;collection-name&gt;All Users&lt;/collection-name&gt;
		&lt;display-schedule&gt;0241128000100008&lt;/display-schedule&gt;
		&lt;expiration-time&gt;20120201000000.000000+***&lt;/expiration-time&gt;
		&lt;package-id&gt;12300001&lt;/package-id&gt;
		&lt;package-language&gt;Hindi&lt;/package-language&gt;
		&lt;package-manufacturer&gt;admin&lt;/package-manufacturer&gt;
		&lt;package-name&gt;pkgName&lt;/package-name&gt;
		&lt;package-version&gt;1.0&lt;/package-version&gt;
		&lt;available-after&gt;20110201000000.000000+***&lt;/available-after&gt;
		&lt;program-name&gt;p2&lt;/program-name&gt;
		&lt;programs-failed&gt;0&lt;/programs-failed&gt;
		&lt;programs-failed-mif&gt;0&lt;/programs-failed-mif&gt;
		&lt;programs-started&gt;0&lt;/programs-started&gt;
		&lt;programs-succeeded&gt;0&lt;/programs-succeeded&gt;
		&lt;programs-succeeded-mif&gt;0&lt;/programs-succeeded-mif&gt;
		&lt;site-code&gt;123&lt;/site-code&gt;
		&lt;time-enable-flag&gt;13075&lt;/time-enable-flag&gt;
	&lt;/item&gt;
&lt;/items&gt;


Elements' Description: 

item [Required]
	This is a child tag of &lt;items&gt; tag. The &lt;item&gt; tag can be specified multiple times to support "multiple items support" feature. 

target [Optional]: 
	This element to specify the connection information for the Microsoft System Center Configuration Manager application.

	Valid values: The value specified for &lt;target&gt; XML element must be same as the value that has been specified for the name attribute of &lt;config&gt; element in Grid Manager adapter configuration.
	
	Default value: 
		If this element is not provided or left empty, the request will be executed on the first defined Grid Manager adapter configuration.

	Note: The value of this tag is case sensitive.

advertisement-id [Optional]
	ID of the advertisement.
	
advertisement-name [Optional]
	Name of the advertisement.
	
advertisements-failed [Optional]
	Total number of users, user groups, or client computers that experienced an error in processing the advertisement or its associated program, or that attempted to run the advertised program but failed before the program could be started.
	
	Valid values: any number.
	
advertisements-received [Optional]
	Total number of users, user groups, or client computers that are reporting the successful receipt of the advertisement.
	
	Valid values: any number.
	
collection-id [Optional]
	ID of the collection to which the advertisement is targeted.
	
collection-name [Optional]
	Name of the collection to which the advertisement is targeted.
	
display-schedule [Optional]
	Interval string that specifies the schedule for which the statistics apply.

	Valid Values:	0181128000100008,00C1128000100008,0181128000100008,0241128000100008,0001128000192000,00011280001A2000,00011280001B2000,00011280001C2000,00011280001D2000,00011280001E2000,00011280001F2000,000A470000284400,000A4700002BC400,0001128000080008

The above values represent a particular schedule after which the statistics are reset to zero. The meaning of each of these values is described below:

0181128000100008 - Since 12:00:00 AM
00C1128000100008 - Since 6:00:00 AM
0181128000100008 - Since 12:00:00 PM
0241128000100008 - Since 6:00:00 PM
0001128000192000 - Since Sunday
00011280001A2000 - Since Monday
00011280001B2000 - Since Tuesday
00011280001C2000 - Since Wednesday
00011280001D2000 - Since Thursday
00011280001E2000 - Since Friday
00011280001F2000 - Since Saturday
000A470000284400 - Since 1st of the month
000A4700002BC400 - Since 15th of the month
0001128000080008 - Since Advertised

expiration-time [Optional]
	Date and time when the advertisement expires and is no longer available to clients.
	Valid values: any input in date time format- 
		YYYYmmDDhhMMssuuuuuu+***
		YYYY-&gt; year, mm -&gt; month, DD -&gt; date, hh-&gt;hour, MM-&gt;minute, ss-&gt;second, uuuuuu-&gt;microsecond, +*** -&gt; Offset from local time

package-id [Optional]
	ID of the package with which the advertised program is associated.
	
package-language [Optional]
	Language of the package, such as Hindi, English or German.

package-manufacturer
	Manufacturer of the package.

package-name [Optional]
	Name of the package.

package-version [Optional]
	Version of the package.

available-after [Optional]
	Date and time when the advertisement is presented to the clients.

program-name [Optional]
	Name of the program (related to PackageID) that the advertisement advertises.
	
programs-failed [Optional]
	Total number of users, user groups, or client computers that reported errors while running the advertised program.
	
	Valid values: any number.

programs-failed-mif [Optional]
	Total number of programs that have failed relative to the install status Management Information Format file.
	
	Valid values: any number.
	
programs-started [Optional]
	Total number of users, user groups, or client computers in the site that were able to successfully start running the advertised program.
	
	Valid values: any number.
	
programs-succeeded [Optional]
	Total number of users, user groups, or client computers, or both, that are reporting that the program ran successfully.
	
	Valid values: any number.
	
programs-succeeded-mif [Optional]
	Total number of programs that have succeeded relative to the install status Management Information Format file.
	
	Valid values: any number.

site-code [Optional]
	Site code of the site where the advertisement originates.
	
time-enable-flag [Optional]
	It's reserved for future use.

	Valid value: any number.</description>
        <from>items</from>
        <to>items</to>
      </input>
      <output global="false" required="false">
        <description>Returned adapter response is captured in this context parameter.</description>
        <to>adapter response</to>
        <from>adapter response</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <assign>
        <assignment>
          <document>
            <input>
              <from>items</from>
            </input>
          </document>
          <result>
            <output>
              <to>items</to>
            </output>
          </result>
          <xslt-stylesheet>
            <stylesheet-replacement-tokens />
            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <items>
      <operation-name>
        <xsl:text disable-output-escaping="no">find-advertisement-status</xsl:text>
      </operation-name>
      <xsl:copy-of select="./items/*" />
    </items>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
          </xslt-stylesheet>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <location>:assign[1]</location>
      </assign>
      <call-process>
        <process-name>:AO-AD-Microsoft_System_Center_Configuration_Manager:Utilities:Execute Request</process-name>
        <parameters>
          <input>
            <from>adapter name</from>
            <to>adapter name</to>
          </input>
          <input>
            <from>items</from>
            <to>items</to>
          </input>
          <input>
            <value>find-advertisement-status</value>
            <to>valid operation name</to>
          </input>
          <output>
            <from>adapter response</from>
            <to>adapter response</to>
          </output>
        </parameters>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>false</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <location>:call-process[1]</location>
      </call-process>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>Find Advertisement Status

This wrapper finds the status of an advertisement.</description>
        <version></version>
      </documentation>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>9dbdfab3-2408-4cc3-88d3-c738ee8998b3</process-id>
      <author>admin</author>
      <category></category>
      <status></status>
      <keywords></keywords>
      <systems></systems>
      <last-modified-by>admin</last-modified-by>
      <last-modified>1298012820880</last-modified>
    </meta>
  </process-def>
</process>