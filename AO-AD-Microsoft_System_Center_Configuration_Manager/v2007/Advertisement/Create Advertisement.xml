<process draft="false" dev-studio-version="7.6.02.00">
  <process-def name=":AO-AD-Microsoft_System_Center_Configuration_Manager:v2007:Advertisement:Create Advertisement">
    <parameters>
      <input global="false" required="false">
        <description>The name of the adapter to use to handle the request. 
Default adapter name: MSSCCMActor.</description>
        <from>adapter name</from>
        <to>adapter name</to>
      </input>
      <input global="false" required="true">
        <description>Sample Items Xml:

&lt;items&gt;
	&lt;item&gt;
		&lt;target&gt;config2&lt;/target&gt;
		&lt;advertisement-name&gt;adv002&lt;/advertisement-name&gt;
		&lt;collection-id&gt;SMS00002&lt;/collection-id&gt;
		&lt;package-id&gt;12300001&lt;/package-id&gt;
		&lt;program-name&gt;p2&lt;/program-name&gt;
		&lt;advertisement-flag&gt;ENABLE_TS_FROM_CD_AND_PXE&lt;/advertisement-flag&gt;
		&lt;schedules&gt;
			&lt;schedule&gt;
				&lt;type&gt;non-recurring&lt;/type&gt;
				&lt;day-duration&gt;2&lt;/day-duration&gt;
				&lt;hour-duration&gt;1&lt;/hour-duration&gt;
				&lt;minute-duration&gt;1&lt;/minute-duration&gt;
				&lt;start-time&gt;20110201000000.000000+***&lt;/start-time&gt;
				&lt;is-gmt&gt;true&lt;/is-gmt&gt;
			&lt;/schedule&gt;
			&lt;schedule&gt;
				&lt;type&gt;custom&lt;/type&gt;
				&lt;day-duration&gt;2&lt;/day-duration&gt;
				&lt;hour-duration&gt;1&lt;/hour-duration&gt;
				&lt;minute-duration&gt;1&lt;/minute-duration&gt;
				&lt;start-time&gt;20110201000000.000000+***&lt;/start-time&gt;
				&lt;is-gmt&gt;true&lt;/is-gmt&gt;
				&lt;day-span&gt;1&lt;/day-span&gt;
				&lt;hour-span&gt;1&lt;/hour-span&gt;
				&lt;minute-span&gt;1&lt;/minute-span&gt;
			&lt;/schedule&gt;
			&lt;schedule&gt;
				&lt;type&gt;weekly&lt;/type&gt;
				&lt;day-duration&gt;2&lt;/day-duration&gt;
				&lt;hour-duration&gt;1&lt;/hour-duration&gt;
				&lt;minute-duration&gt;1&lt;/minute-duration&gt;
				&lt;start-time&gt;20110201000000.000000+***&lt;/start-time&gt;
				&lt;is-gmt&gt;true&lt;/is-gmt&gt;
				&lt;day&gt;SUNDAY&lt;/day&gt;
				&lt;for-number-of-weeks&gt;1&lt;/for-number-of-weeks&gt;
			&lt;/schedule&gt;
			&lt;schedule&gt;
				&lt;type&gt;monthly-by-date&lt;/type&gt;
				&lt;day-duration&gt;2&lt;/day-duration&gt;
				&lt;hour-duration&gt;1&lt;/hour-duration&gt;
				&lt;minute-duration&gt;1&lt;/minute-duration&gt;
				&lt;start-time&gt;20110201000000.000000+***&lt;/start-time&gt;
				&lt;is-gmt&gt;true&lt;/is-gmt&gt;
				&lt;month-day&gt;1&lt;/month-day&gt;
				&lt;for-number-of-months&gt;1&lt;/for-number-of-months&gt;
			&lt;/schedule&gt;
			&lt;schedule&gt;
				&lt;type&gt;monthly-by-week-day&lt;/type&gt;
				&lt;day-duration&gt;2&lt;/day-duration&gt;
				&lt;hour-duration&gt;1&lt;/hour-duration&gt;
				&lt;minute-duration&gt;1&lt;/minute-duration&gt;
				&lt;start-time&gt;20110201000000.000000+***&lt;/start-time&gt;
				&lt;is-gmt&gt;true&lt;/is-gmt&gt;
				&lt;day&gt;MONDAY&lt;/day&gt;
				&lt;for-number-of-months&gt;1&lt;/for-number-of-months&gt;
				&lt;week-order&gt;LAST&lt;/week-order&gt;
			&lt;/schedule&gt;
		&lt;/schedules&gt;
		&lt;schedule-enabled&gt;true&lt;/schedule-enabled&gt;
		&lt;schedule-is-gmt&gt;true&lt;/schedule-is-gmt&gt;
		&lt;comment&gt;adv comment&lt;/comment&gt;
		&lt;device-flags&gt;24&lt;/device-flags&gt;
		&lt;expiration-time&gt;20120201000000.000000+***&lt;/expiration-time&gt;
		&lt;expiration-time-enabled&gt;true&lt;/expiration-time-enabled&gt;
		&lt;expiration-time-is-gmt&gt;true&lt;/expiration-time-is-gmt&gt;
		&lt;hierarchy-path&gt;any path&lt;/hierarchy-path&gt;
		&lt;include-sub-collection&gt;true&lt;/include-sub-collection&gt;
		&lt;mandatory-count-down&gt;10&lt;/mandatory-count-down&gt;
		&lt;present-time&gt;20110201000000.000000+***&lt;/present-time&gt;
		&lt;present-time-enabled&gt;true&lt;/present-time-enabled&gt;
		&lt;present-time-is-gmt&gt;true&lt;/present-time-is-gmt&gt;
		&lt;priority&gt;HIGH&lt;/priority&gt;
		&lt;remote-client-flags&gt;DONT_RUN_NO_LOCAL_DISPPOINT&lt;/remote-client-flags&gt;
	&lt;/item&gt;		
&lt;/items&gt;


Elements' Description: 

item [Required]
	This is a child tag of &lt;items&gt; tag. The &lt;item&gt; tag can be specified multiple times to support "multiple items support". 

target [Optional]: 
	This element to specify the connection information for the Microsoft System Center Configuration Manager application.

	Valid values: The value specified for &lt;target&gt; XML element must be same as the value that has been specified for the name attribute of &lt;config&gt; element in Grid Manager adapter configuration.
	
	Default value: 
		If this element is not provided or left empty, the request will be executed on the first defined Grid Manager adapter configuration.

	Note: The value of this tag is case sensitive.

advertisement-name [Required]
	Name of the advertisement.

collection-id[Required]
	Id of the collection where the advertisement is announced.

package-id [Required]
	Id of the package which is being advertised.

program-name [Required]
	Name of the program being advertised.

advertisement-flag [Optional] 
	Flags indicating how the advertisement should be announced to the user. 

	Valid values: IMMEDIATE, ONSYSTEMSTARTUP, ONUSERLOGON, ONUSERLOGOFF, WINDOWS_CE, DONOT_FALLBACK, ENABLE_TS_FROM_CD_AND_PXE, OVERRIDE_SERVICE_WINDOWS, REBOOT_OUTSIDE_OF_SERVICE_WINDOWS, WAKE_ON_LAN_ENABLED, SHOW_PROGRESS, NO_DISPLAY, ONSLOWNET
	
	These valid values are mapped to following numerical values:
	
	IMMEDIATE : 5 
	ONSYSTEMSTARTUP : 8 
	ONUSERLOGON : 9 
	ONUSERLOGOFF : 10 
	WINDOWS_CE : 15 
	DONOT_FALLBACK : 17 
	ENABLE_TS_FROM_CD_AND_PXE : 18 
	OVERRIDE_SERVICE_WINDOWS : 20 
	REBOOT_OUTSIDE_OF_SERVICE_WINDOWS : 21 
	WAKE_ON_LAN_ENABLED : 22 
	SHOW_PROGRESS : 23 
	NO_DISPLAY : 25 
	ONSLOWNET : 26 

	Default value: 0 

schedules [Optional]
	Parent tag of 'schedule' tag. 
	
schedule[Optional]
	Specify schedule information under this tag. This tag can be specified multiple times if there are multiple schedules.
	
type [Conditional]
	The type of schedule.
	Valid values: non-recurring, custom, weekly, monthly-by-date, monthly-by-week-day
	
	Note: this tag is required if schedule tag is present.

day-duration [Optional]
	Number of days during which the scheduled action occurs.
	Valid values: any number between 0 to 31. The value 0 indicates that the scheduled action continues indefinitely. 
	Default value: 0
	
hour-duration [Optional]
	Number of hours during which the scheduled action occurs.
	Valid values: any number between 0 to 23. The value 0 indicates that there is no hour duration.
	Default value: 0

minute-duration [Optional]
	Number of minutes during which the scheduled action occurs. 
	Valid vlaues: any number between 0 to 59. The value 0  indicates that there is no minute duration.
		
start-time [Optional]
	Date and time when the scheduled action takes place.
	Valid values: the date and time input in following format
	YYYYmmDDhhMMss.MMMMMM+***
	YYYY - year; mm - month; DD - date; hh - hour; MM - minute; ss - second; MMMMMM - mili second; *** - Offset from local time
	Default value: 19700201000000.000000+***

is-gmt [Optional]
	Valid values: true, false
	true - time specified in "start-time" tag is in Coordinated Universal Time (UTC)
	false - time specified in "start-time" tag is not in Coordinated Universal Time (UTC)

day-span [Optional]
	Number of days spanning schedule intervals.
	Valid values: any number between 0 to 31.
	Default value: 0
	
	Note: this tag is valid only when value within "type" tag is "custom"
	
hour-span [Optional]
	Number of hours spanning schedule intervals.
	Valid values: any number between 0 to 23
	Default value: 0
	
	Note: this tag is valid only when value within "type" tag is "custom"
	
minute-span [Optional]
	Number of minutes spanning schedule intervals.
	Valid value: any number between 0 to 59
	Default value: 0
	
	Note: this tag is valid only when value within "type" tag is "custom"
	
day [Optional]
	Day of the week when the event is scheduled to occur. 
	Valid values: SUNDAY, MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY
	Default value: SUNDAY

	Note: this tag is valid only when value within "type" tag is either "weekly" or "monthly-by-week-day"
	
for-number-of-weeks [Optional]
	Number of weeks for recurrence.
	Valid values: any number between 1 to 4
	Default value: 1
	
	Note: this tag is valid only when value within "type" tag is "weekly"

month-day [Optional]
	Day of the month on which the action occurs.
	Valid values: any number between 0 to 31. The value 0 indicates the last day of the month.
	Default value: 0

	Note: this tag is valid only when value within "type" tag is "monthly-by-date"

for-number-of-months [Optional]
	Number of months for the recurrence.
	Valid values: any number between 1 to 12
	Default value: 1
	
	Note: this tag is valid only when value within "type" tag is either "monthly-by-date" or "monthly-by-week-day"

week-order [Optional]
	Week of the month when the event is scheduled to occur. 
	Valid values: LAST, FIRST, SECOND, THIRD, FOURTH
	Default value: LAST
	
	Note: this tag is valid only when value within "type" tag is "monthly-by-week-day"
	
schedule-enabled [Optional]
	Specify whether the schedules specified by "schedule" tags are active or not.
	Valid values: true, false
	true - active
	false - not active
	
	Default value: false
	
schedule-is-gmt [Optional]
	Valid values: true, false
	true - the time of schedules are in Universal Metric Time (UMT)
	false - the time of schedules are not in Universal Metric Time (UMT)
	
	Default value: false
	
comment [Optional]
	Comment for the advertisement.
	Valid values: any string.
	Default value: None

device-flags [Optional]
	Specify the flags describing the device.
	Valid values: 24, 25, 26
	
	Description of these values:
	24 : Always assign program to the client.
	25 : Assign only if the device is currently connected to a high-bandwidth connection (default above 60 KBps).
	26 : Assign only if the device is docked, that is, it is attached to a desktop that is using ActiveSync.
 
	Default value: 0
	
expiration-time [Optional]
	Date and time when the advertisement is no longer available to clients.
	Valid values: the date and time input in following format
	YYYYmmDDhhMMss.MMMMMM+***
	YYYY - year; mm - month; DD - date; hh - hour; MM - minute; ss - second; MMMMMM - mili second; *** - Offset from local time
	
	Default value: 19900101000000.000000+****
	
expiration-time-enabled [Optional]
	Valid value: true, false
	true - advertisement expires at the time specified in "expiration-time" tag
	false - advertisement doesn't expire at the time specified in "expiration-time" tag
	
	Default value: false
	
expiration-time-is-gmt [Optional]
	Valid value: true, false
	true - the time specified in "expiration-time" tag is in Universal Metric Time (UMT)
	false - the time specified in "expiration-time" tag is not in Universal Metric Time (UMT)
	
	Default value: false
	
hierarchy-path [Optional]: 
	Valid values: any string
	Default value: None
	
include-sub-collection [Optional]
	Valid values: true, false
	true - the advertisement is advertised to the subcollections of the specified collection
	false - the advertisement is not advertised to the subcollections of the specified collection
	
	Default value: true
	
mandatory-count-down [Optional]
	Duration, in minutes, to show operating system deployment user notification mandatory schedule countdown.
	Valid values: any number between 0 and 90 both inclusive
	Default value: 0
	
present-time [Optional]
	Date and time when the advertisement is made available to clients. 
	Valid values: the date and time input in following format
	YYYYmmDDhhMMss.MMMMMM+***
	YYYY - year; mm - month; DD - date; hh - hour; MM - minute; ss - second; MMMMMM - mili second; *** - Offset from local time
	
	Default value: 19900101000000.000000+****
	
present-time-enabled [Optional]
	Valid values: true, false 
	true - the present time specified in "present-time" tag is enforced by Configuration Manager
	false - the present time specified in "present-time" tag is not enforced by Configuration Manager
	
	Default value: true 
	
present-time-is-gmt [Optional]
	Valid values: true, false
	true - if the time specified in "present-time" tag is in Universal Metric Time (UMT)
	false - if the time specified in "present-time" tag is not in Universal Metric Time (UMT)
	
	Default value: false
	
priority [Optional] 
	The priority of the advertisement. 
	Valid values: HIGH, NORMAL, LOW
	
	These valid values are mapped to following numerical values:
	
	HIGH : 1 
	NORMAL : 2 
	LOW : 3 

	Default value: NORMAL

remote-client-flags [Optional] 
	The flags specifying how the program should run when the client is connected either locally or remotely to a distribution point. 

	Valid values: BATTERY_POWER, RUN_FROM_CD, DOWNLOAD_FROM_CD, RUN_FROM_LOCAL_DISPPOINT, DOWNLOAD_FROM_LOCAL_DISPPOINT, DONT_RUN_NO_LOCAL_DISPPOINT, DOWNLOAD_FROM_REMOTE_DISPPOINT, RUN_FROM_REMOTE_DISPPOINT, DOWNLOAD_ON_DEMAND_FROM_LOCAL_DP, DOWNLOAD_ON_DEMAND_FROM_REMOTE_DP, BALLOON_REMINDERS_REQUIRED, RERUN_ALWAYS, RERUN_NEVER, RERUN_IF_FAILED, RERUN_IF_SUCCEEDED
	
	
	These valid values are mapped to following numerical values
	
	BATTERY_POWER : 0 
	RUN_FROM_CD : 1 
	DOWNLOAD_FROM_CD : 2 
	RUN_FROM_LOCAL_DISPPOINT : 3 
	DOWNLOAD_FROM_LOCAL_DISPPOINT : 4 
	DONT_RUN_NO_LOCAL_DISPPOINT : 5 
	DOWNLOAD_FROM_REMOTE_DISPPOINT : 6 
	RUN_FROM_REMOTE_DISPPOINT : 7 
	DOWNLOAD_ON_DEMAND_FROM_LOCAL_DP : 8 
	DOWNLOAD_ON_DEMAND_FROM_REMOTE_DP : 9 
	BALLOON_REMINDERS_REQUIRED : 10 
	RERUN_ALWAYS : 11 
	RERUN_NEVER : 12 
	RERUN_IF_FAILED : 13 
	RERUN_IF_SUCCEEDED : 14 

	Default value: 48 </description>
        <from>items</from>
        <to>items</to>
      </input>
      <output global="false" required="false">
        <description>Returned adapter response is captured in this context parameter.</description>
        <to>adapter response</to>
        <from>adapter response</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <assign>
        <assignment>
          <output>
            <to>valid operation name</to>
            <value>create-advertisement</value>
          </output>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <location>:assign[1]</location>
      </assign>
      <assign>
        <assignment>
          <document>
            <input>
              <from>items</from>
            </input>
          </document>
          <result>
            <output>
              <to>items</to>
            </output>
          </result>
          <xslt-stylesheet>
            <stylesheet-replacement-tokens />
            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <items>
      <operation-name>
        <xsl:text disable-output-escaping="no">create-advertisement</xsl:text>
      </operation-name>
      <xsl:copy-of select="./items/*" />
    </items>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
          </xslt-stylesheet>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <location>:assign[2]</location>
      </assign>
      <call-process>
        <process-name>:AO-AD-Microsoft_System_Center_Configuration_Manager:Utilities:Execute Request</process-name>
        <parameters>
          <input>
            <from>adapter name</from>
            <to>adapter name</to>
          </input>
          <input>
            <from>items</from>
            <to>items</to>
          </input>
          <input>
            <from>valid operation name</from>
            <to>valid operation name</to>
          </input>
          <output>
            <from>adapter response</from>
            <to>adapter response</to>
          </output>
        </parameters>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>false</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <location>:call-process[1]</location>
      </call-process>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>Create Advertisement


This wrapper creates an Advertisement.</description>
        <version></version>
      </documentation>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>928b13c9-e3ca-4920-b959-69a7c8b47533</process-id>
      <author>admin</author>
      <category></category>
      <status></status>
      <keywords></keywords>
      <systems></systems>
      <last-modified-by>admin</last-modified-by>
      <last-modified>1298280284967</last-modified>
    </meta>
  </process-def>
</process>