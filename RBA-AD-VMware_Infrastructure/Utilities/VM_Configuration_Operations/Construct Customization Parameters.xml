<process draft="false" dev-studio-version="7.6.02.04">
  <process-def name=":RBA-AD-VMware_Infrastructure:Utilities:VM_Configuration_Operations:Construct Customization Parameters">
    <parameters>
      <input global="false" required="false">
        <description>Network identity and settings, similar to Microsoft's Sysprep tool. This is a Sysprep, LinuxPrep, or SysprepText object.

Valid Values:    
CustomizationLinuxPrep, CustomizationSysprep.
</description>
        <from>identity type</from>
        <to>identity type</to>
      </input>
      <input global="false" required="false">
        <description>The XML input is as follows

&lt;password&gt;
	&lt;value&gt;aaa&lt;/value&gt;
	&lt;plain-text&gt;true&lt;/plain-text&gt;
&lt;/password&gt;

The new administrator password for the machine.

password: The new administrator password for the machine
value: The password string. It is encrypted if the associated plainText flag is false.
plain-text: Flag to specify whether or not the password is in plain text, rather than encrypted. (valid values true and false)

</description>
        <from>gui unattended password</from>
        <to>gui unattended password</to>
      </input>
      <input global="false" required="false">
        <description>The time zone for the new virtual machine. Numbers correspond to time zones listed in sysprep documentation in Microsoft Technet.

Valid value: int
</description>
        <from>gui unattended time zone</from>
        <to>gui unattended time zone</to>
      </input>
      <input global="false" required="false">
        <description>Flag to determine whether or not the machine automatically logs on as Administrator. See also the password property.

Valid Value: Boolean
</description>
        <from>gui unattended auto logon</from>
        <to>gui unattended auto logon</to>
      </input>
      <input global="false" required="false">
        <description>If the AutoLogon flag is set, then the AutoLogonCount property specifies the number of times the machine should automatically log on as Administrator. Generally it should be 1, but if your setup requires a number of reboots, you may want to increase it. This number may be determined by the list of commands executed by the GuiRunOnce command.

Valid value: int
</description>
        <from>gui unattended auto logon count</from>
        <to>gui unattended auto logon count</to>
      </input>
      <input global="false" required="false">
        <description>User's full name.

Valid value: String

Mandatory when identity type is "CustomizationSysprep"</description>
        <from>user data full name</from>
        <to>user data full name</to>
      </input>
      <input global="false" required="false">
        <description>User's organization.

Valid value: String

Mandatory when identity type is "CustomizationSysprep"</description>
        <from>user data org name</from>
        <to>user data org name</to>
      </input>
      <input global="false" required="false">
        <description>The computer name of the (Windows) virtual machine. 

Valid value: 
&lt;computer-name&gt;
       &lt;name&gt;&lt;/name&gt;
&lt;/computer-name&gt;

Mandatory when identity type is "CustomizationSysprep"</description>
        <from>user data computer name</from>
        <to>user data computer name</to>
      </input>
      <input global="false" required="false">
        <description>Microsoft Sysprep requires that a valid serial number be included in the answer file when mini-setup runs. This serial number is ignored if the original guest operating system was installed using a volume-licensed CD. 

Valid value:  String

Mandatory when identity type is "CustomizationSysprep"</description>
        <from>user data product id</from>
        <to>user data product id</to>
      </input>
      <input global="false" required="false">
        <description>A list of commands to run at first user logon, after guest customization.

XML Format:

&lt;gui-run-once&gt;
	&lt;!-- one or more--&gt;
	&lt;command&gt;&lt;/command&gt;
	&lt;command&gt;&lt;/command&gt;
&lt;/gui-run-once&gt;</description>
        <from>gui run once command list</from>
        <to>gui run once command list</to>
      </input>
      <input global="false" required="false">
        <description>The workgroup that the virtual machine should join. If this value is supplied, then the domain name and authentication fields must be empty.

Valid value:  String
</description>
        <from>identification join workgroup</from>
        <to>identification join workgroup</to>
      </input>
      <input global="false" required="false">
        <description>Server licensing mode.

Valid value: perSeat, perServer
</description>
        <from>license file print data auto mode</from>
        <to>license file print data auto mode</to>
      </input>
      <input global="false" required="false">
        <description>This key is valid only if AutoMode = PerServer. The integer value indicates the number of client licenses purchased for the VirtualCenter server being installed.

Valid value: int
</description>
        <from>license file print data auto user</from>
        <to>license file print data auto user</to>
      </input>
      <input global="false" required="false">
        <description>The computer name of the (Non-Windows) virtual machine. 

Valid value: 
&lt;host-name&gt;
	&lt;name&gt;&lt;/name&gt;
&lt;/host-name&gt;

Mandatory when identity type is "CustomizationLinuxPrep"</description>
        <from>host name</from>
        <to>host name</to>
      </input>
      <input global="false" required="false">
        <description>The fully qualified domain name.

Valid value: String

Mandatory when identity type is "CustomizationLinuxPrep"</description>
        <from>domain</from>
        <to>domain</to>
      </input>
      <input global="false" required="false">
        <description>List of DNS servers, for a virtual network adapter with a static IP address. If this list is empty, then the guest operating system is expected to use a DHCP server to get its DNS server settings. These settings configure the virtual machine to use the specified DNS servers. These DNS server settings are listed in order of preference. If you supply this list, be sure to specify that dnsFromDhcp is false.

Valid value:
&lt;dns-suffix-list&gt;
	&lt;dns-suffix-list&gt;&lt;/dns-suffix-list&gt;
	&lt;dns-suffix-list&gt;&lt;/dns-suffix-list&gt;
&lt;/dns-suffix-list&gt;
</description>
        <from>globalIPSettings dns server list</from>
        <to>globalIPSettings dns server list</to>
      </input>
      <input global="false" required="false">
        <description>List of name resolution suffixes for the virtual network adapter. This list applies to both Windows and Linux guest customization. For Linux, this setting is global, whereas in Windows, this setting is listed on a per-adapter basis, even though the setting is global in Windows.

Valid value: 
&lt;dns-suffix-list&gt;
	&lt;dns-suffix-list&gt;&lt;/dns-suffix-list&gt;
	&lt;dns-suffix-list&gt;&lt;/dns-suffix-list&gt;
&lt;/dns-suffix-list&gt;
</description>
        <from>globalIPSettings dns suffix list</from>
        <to>globalIPSettings dns suffix list</to>
      </input>
      <input global="false" required="false">
        <description>Specification to obtain a unique IP address for this virtual network adapter.

ip type:      CustomizationDhcpIpGenerator, CustomizationFixedIp

Valid value:
&lt;ip type=""&gt;
		&lt;ipAddress&gt;&lt;/ipAddress&gt;
&lt;/ip&gt;
</description>
        <from>ip</from>
        <to>ip</to>
      </input>
      <input global="false" required="false">
        <description>Subnet mask for this virtual network adapter.

Valid value: String
</description>
        <from>subnet mask</from>
        <to>subnet mask</to>
      </input>
      <input global="false" required="false">
        <description>For a virtual network adapter with a static IP address, this data object type contains a list of gateways, in order of preference.

Valid value: String</description>
        <from>gateway</from>
        <to>gateway</to>
      </input>
      <input global="false" required="false">
        <description>A DNS domain suffix such as vmware.com.

Valid value: String</description>
        <from>dns domain</from>
        <to>dns domain</to>
      </input>
      <input global="false" required="false">
        <description>NIC Setting map list [optional]
		Set of Network Adapters to be added in the cloned virtual machine

Value takes the form:

&lt;nic-setting-map-list&gt;	
&lt;!--Zero or more repetitions:--&gt;		               
	&lt;nic-setting-map&gt;
   		&lt;adapter&gt;
  			&lt;ip type="?"&gt;
   				&lt;ipAddress&gt;?&lt;/ipAddress&gt;
   			&lt;/ip&gt;
   			&lt;subnet-mask&gt;?&lt;/subnet-mask&gt;
   			&lt;gateway&gt;?&lt;/gateway&gt;
   			&lt;dns-domain&gt;?&lt;/dns-domain&gt;
   		&lt;/adapter&gt;				        		
	&lt;/nic-setting-map&gt;
&lt;/nic-setting-map-list&gt;

Valid values for IP type attribute:

CustomizationFixedIp
CustomizationDhcpIpGenerator

Note:
&lt;ipAddress&gt; is valid only when the value for &lt;ip type&gt; is CustomizationFixedIp.


Note:

The &lt;ip&gt;, &lt;subnet-mask&gt;, &lt;gateway&gt; and &lt;dns-domain&gt; elements are children of the &lt;nic-setting-map&gt; element. To add a single network adapter element (&lt;nic-setting-map&gt;), fill in the values in the above four elements. To add multiple netwrok adapters (multiple &lt;nic-setting-map&gt;), use the &lt;nic-setting-map-list&gt; element.

If &lt;nic-setting-map-list&gt; is provided, the same is added to the customization XML, if &lt;nic-setting-map-list&gt;
is not provided and any of the &lt;ip&gt;, &lt;subnet-mask&gt;, &lt;gateway&gt; and &lt;dns-domain&gt; elements is not null, then a single &lt;nic-setting-map&gt; is added to the customization XML. 

If both are provided then only the &lt;nic-setting-map-list&gt; element is added.

Further note that the &lt;nic-setting-map-list&gt; element can be used to define a single netwrok adapter also.</description>
        <from>nic setting map list</from>
        <to>nic setting map list</to>
      </input>
      <output global="false" required="false">
        <to>customization</to>
        <from>customization</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <assign>
        <assignment>
          <document>
            <input>
              <from>nic setting map list</from>
            </input>
          </document>
          <result>
            <output>
              <to>multiple nic exist</to>
            </output>
          </result>
          <xpath-expression>
            <xpath-replacement-tokens />
            <xpath><![CDATA[string-length(//nic-setting-map-list) > 0]]></xpath>
          </xpath-expression>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <location>:assign[1]</location>
      </assign>
      <assign>
        <assignment>
          <output>
            <to>customization</to>
            <value>
              <empty />
            </value>
          </output>
          <xslt-stylesheet>
            <stylesheet-replacement-tokens>
              <replacement-token name="identity type">
                <input global="false">
                  <from>identity type</from>
                </input>
              </replacement-token>
              <replacement-token name="time zone">
                <input global="false">
                  <from>gui unattended time zone</from>
                </input>
              </replacement-token>
              <replacement-token name="auto logon">
                <input global="false">
                  <from>gui unattended auto logon</from>
                </input>
              </replacement-token>
              <replacement-token name="auto logon count">
                <input global="false">
                  <from>gui unattended auto logon count</from>
                </input>
              </replacement-token>
              <replacement-token name="full name">
                <input global="false">
                  <from>user data full name</from>
                </input>
              </replacement-token>
              <replacement-token name="org name">
                <input global="false">
                  <from>user data org name</from>
                </input>
              </replacement-token>
              <replacement-token name="computer name">
                <input global="false">
                  <from>user data computer name</from>
                </input>
              </replacement-token>
              <replacement-token name="product id">
                <input global="false">
                  <from>user data product id</from>
                </input>
              </replacement-token>
              <replacement-token name="join workgroup">
                <input global="false">
                  <from>identification join workgroup</from>
                </input>
              </replacement-token>
              <replacement-token name="auto mode">
                <input global="false">
                  <from>license file print data auto mode</from>
                </input>
              </replacement-token>
              <replacement-token name="auto user">
                <input global="false">
                  <from>license file print data auto user</from>
                </input>
              </replacement-token>
              <replacement-token name="host name">
                <input global="false">
                  <from>host name</from>
                </input>
              </replacement-token>
              <replacement-token name="domain">
                <input global="false">
                  <from>domain</from>
                </input>
              </replacement-token>
              <replacement-token name="dns server list">
                <input global="false">
                  <from>globalIPSettings dns server list</from>
                </input>
              </replacement-token>
              <replacement-token name="dns suffix list">
                <input global="false">
                  <from>globalIPSettings dns suffix list</from>
                </input>
              </replacement-token>
              <replacement-token name="ip">
                <input global="false">
                  <from>ip</from>
                </input>
              </replacement-token>
              <replacement-token name="subnet mask">
                <input global="false">
                  <from>subnet mask</from>
                </input>
              </replacement-token>
              <replacement-token name="gateway">
                <input global="false">
                  <from>gateway</from>
                </input>
              </replacement-token>
              <replacement-token name="dns domain">
                <input global="false">
                  <from>dns domain</from>
                </input>
              </replacement-token>
              <replacement-token name="gui unattended password">
                <input global="false">
                  <from>gui unattended password</from>
                </input>
              </replacement-token>
              <replacement-token name="gui run once">
                <input global="false">
                  <from>gui run once command list</from>
                </input>
              </replacement-token>
              <replacement-token name="nic setting map list">
                <input global="false">
                  <from>nic setting map list</from>
                </input>
              </replacement-token>
              <replacement-token name="multiple nic exist">
                <input global="false">
                  <from>multiple nic exist</from>
                </input>
              </replacement-token>
            </stylesheet-replacement-tokens>
            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <customization>
      <identity type="${identity type}">
        <xsl:if test="string-length('${auto logon}') &gt;0  or  string-length('${time zone}') &gt;0   or  string-length('${auto logon count}') &gt;0">
          <gui-unattended>
            ${gui unattended password}
            <xsl:if test="string-length('${time zone}') &gt;0">
              <time-zone>${time zone}</time-zone>
            </xsl:if>
            <xsl:if test="string-length('${auto logon}') &gt;0">
              <auto-logon>${auto logon}</auto-logon>
            </xsl:if>
            <xsl:if test="string-length('${auto logon count}') &gt;0">
              <auto-logon-count>${auto logon count}</auto-logon-count>
            </xsl:if>
          </gui-unattended>
        </xsl:if>
        <xsl:if test="string-length('${full name}') &gt;0   or  string-length('${org name}') &gt;0  or string-length('${product id}') &gt;0">
          <user-data>
            <xsl:if test="string-length('${full name}') &gt;0">
              <full-name>${full name}</full-name>
            </xsl:if>
            <xsl:if test="string-length('${org name}') &gt;0">
              <org-name>${org name}</org-name>
            </xsl:if>
            ${computer name}
            <xsl:if test="string-length('${product id}') &gt;0">
              <product-id>${product id}</product-id>
            </xsl:if>
          </user-data>
        </xsl:if>
        ${gui run once}
        <xsl:if test="string-length('${join workgroup}') &gt;0">
          <identification>
            <join-workgroup>${join workgroup}</join-workgroup>
          </identification>
        </xsl:if>
        <xsl:if test="string-length('${auto mode}') &gt;0  or string-length('${auto user}') &gt;0">
          <license-file-print-data>
            <xsl:if test="string-length('${auto mode}') &gt;0">
              <auto-mode>${auto mode}</auto-mode>
            </xsl:if>
            <xsl:if test="string-length('${auto user}') &gt;0">
              <auto-users>${auto user}</auto-users>
            </xsl:if>
          </license-file-print-data>
        </xsl:if>
        ${host name}
        <xsl:if test="string-length('${domain}') &gt;0">
          <domain>${domain}</domain>
        </xsl:if>
      </identity>
      <globalIPSettings>${dns server list}${dns suffix list}</globalIPSettings>
      <xsl:choose>
        <xsl:when test="'${multiple nic exist}' = 'true'">${nic setting map list}</xsl:when>
        <xsl:otherwise>
          <nic-setting-map>
            <adapter>
              ${ip}
              <subnet-mask>${subnet mask}</subnet-mask>
              <gateway>${gateway}</gateway>
              <dns-domain>${dns domain}</dns-domain>
            </adapter>
          </nic-setting-map>
        </xsl:otherwise>
      </xsl:choose>
    </customization>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
          </xslt-stylesheet>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <before-execution>
          <log>
            <level>debug</level>
            <parameters>
              <input>
                <value>out</value>
              </input>
              <input>
                <from>host name</from>
              </input>
              <input>
                <from>gui unattended password</from>
              </input>
            </parameters>
          </log>
        </before-execution>
        <location>:assign[2]</location>
      </assign>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description></description>
        <version></version>
      </documentation>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>e6f40510-d7dd-3212-82bb-8c2c2cfc17f3</process-id>
      <author>admin</author>
      <category></category>
      <status></status>
      <keywords></keywords>
      <systems></systems>
      <last-modified-by>admin</last-modified-by>
      <last-modified>1337331938479</last-modified>
    </meta>
  </process-def>
</process>