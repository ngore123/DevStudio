<process draft="false" dev-studio-version="7.6.01.02">
  <process-def name=":AO-AD-HP_ServiceCenter:Utilities:Change_Management:Update Change">
    <parameters>
      <input global="false" required="false">
        <description>            The name of the adapter to use to handle the request. 
</description>
        <from>adapter name</from>
        <to>adapter name</to>
      </input>
      <input global="false" required="true">
        <description>The items for the adapter request. This should be an XML document with a root element named "items" having a children "item" (to support multiple item support, we give "item" multiple times), which should contain the data necessary to execute the specific request. 


&lt;items&gt;
	&lt;item&gt;
		&lt;entity-type&gt;change&lt;/entity-type&gt;
		&lt;operation-name&gt;approve-change&lt;/operation-name&gt;
		&lt;model&gt;
            &lt;keys&gt;
              &lt;change-number&gt;
                &lt;value&gt;C33&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/change-number&gt;
            &lt;/keys&gt;
            &lt;instance&gt;
              &lt;header&gt;
                &lt;type&gt;Structure&lt;/type&gt;
                &lt;change-number&gt;
                  &lt;value&gt;C33&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/change-number&gt;
                &lt;category&gt;
                  &lt;value&gt;Application&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/category&gt;
                &lt;status&gt;
                  &lt;value&gt;initial&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/status&gt;
                &lt;approval-status&gt;
                  &lt;value&gt;pending&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/approval-status&gt;
                &lt;requested-by&gt;
                  &lt;value&gt;BROWN, NICHOLAS&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/requested-by&gt;
                &lt;assigned-to&gt;
                  &lt;value&gt;CA 2&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/assigned-to&gt;
                &lt;coordinator&gt;
                  &lt;value&gt;BOB.HELPDESK&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/coordinator&gt;
                &lt;coordinator-phone&gt;
                  &lt;value&gt;123456789&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/coordinator-phone&gt;
                &lt;!-- 
				&lt;planned-start-date&gt;
				  &lt;value&gt;1223276400000&lt;/value&gt;
				  &lt;type&gt;DateTime&lt;/type&gt;
				&lt;/planned-start-date&gt;
				&lt;planned-end-date&gt; 
				  &lt;value&gt;1223449200000&lt;/value&gt;
				  &lt;type&gt;DateTime&lt;/type&gt;
				&lt;/planned-end-date&gt; --&gt;
                &lt;current-phase&gt;
                  &lt;value&gt;Design&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/current-phase&gt;
                &lt;risk-assessment&gt;
                  &lt;value&gt;0&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/risk-assessment&gt;
                &lt;priority&gt;
                  &lt;value&gt;1&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/priority&gt;
                &lt;!-- 
				&lt;date-entered&gt;
				  &lt;value&gt;1223347397000&lt;/value&gt;
				  &lt;type&gt;DateTime&lt;/type&gt;
				&lt;/date-entered&gt;   --&gt;
                &lt;open&gt;
                  &lt;value&gt;true&lt;/value&gt;
                  &lt;type&gt;Boolean&lt;/type&gt;
                &lt;/open&gt;
                &lt;backout-duration&gt;
                  &lt;value&gt;PT0S&lt;/value&gt;
                  &lt;type&gt;Duration&lt;/type&gt;
                &lt;/backout-duration&gt;
                &lt;company&gt;
                  &lt;value&gt;ACME&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/company&gt;
                &lt;brief-description&gt;
                  &lt;value&gt;first line of Description&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/brief-description&gt;
              &lt;/header&gt;
              &lt;description-structure&gt;
                &lt;type&gt;Structure&lt;/type&gt;
                &lt;description&gt;
                  &lt;type&gt;Array&lt;/type&gt;
                  &lt;description&gt;
                    &lt;element&gt;
                      &lt;value&gt;first line of Description&lt;/value&gt;
                      &lt;type&gt;String&lt;/type&gt;
                    &lt;/element&gt;
                    &lt;element&gt;
                      &lt;value&gt;second line of description&lt;/value&gt;
                      &lt;type&gt;String&lt;/type&gt;
                    &lt;/element&gt;
                  &lt;/description&gt;
                &lt;/description&gt;
                &lt;justification&gt;
                  &lt;type&gt;Array&lt;/type&gt;
                  &lt;justification&gt;
                    &lt;element&gt;
                      &lt;value&gt;first line of resolution&lt;/value&gt;
                      &lt;type&gt;String&lt;/type&gt;
                    &lt;/element&gt;
                    &lt;element&gt;
                      &lt;value&gt;second line of resolution&lt;/value&gt;
                      &lt;type&gt;String&lt;/type&gt;
                    &lt;/element&gt;
                  &lt;/justification&gt;
                &lt;/justification&gt;
                &lt;backout-method&gt;
                  &lt;type&gt;Array&lt;/type&gt;
                  &lt;backout-method&gt;
                    &lt;element&gt;
                      &lt;value&gt;first line of work arround&lt;/value&gt;
                      &lt;type&gt;String&lt;/type&gt;
                    &lt;/element&gt;
                    &lt;element&gt;
                      &lt;value&gt;second line of work around&lt;/value&gt;
                      &lt;type&gt;String&lt;/type&gt;
                    &lt;/element&gt;
                  &lt;/backout-method&gt;
                &lt;/backout-method&gt;
              &lt;/description-structure&gt;
              &lt;middle&gt;
                &lt;type&gt;Structure&lt;/type&gt;
                &lt;configuration-item&gt;
                  &lt;value&gt;Exchange C&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/configuration-item&gt;
                &lt;location&gt;
                  &lt;value&gt;ACME HQ&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/location&gt;
                &lt;!-- 
				&lt;outage-start&gt;
				  &lt;value&gt;1223276400000&lt;/value&gt;
				  &lt;type&gt;DateTime&lt;/type&gt;
				&lt;/outage-start&gt;
				&lt;outage-end&gt;
				  &lt;value&gt;1223449200000&lt;/value&gt;
				  &lt;type&gt;DateTime&lt;/type&gt;
				&lt;/outage-end&gt;  --&gt;
              &lt;/middle&gt;
              &lt;close&gt;
                &lt;type&gt;Structure&lt;/type&gt;
                &lt;completion-code&gt;
                  &lt;value&gt;1&lt;/value&gt;
                  &lt;type&gt;Decimal&lt;/type&gt;
                &lt;/completion-code&gt;
              &lt;/close&gt;
              &lt;urgency&gt;
                &lt;value&gt;1&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/urgency&gt;
              &lt;initial-assessment&gt;
                &lt;value&gt;1&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/initial-assessment&gt;
              &lt;uniquequery&gt;header,number="C33"&lt;/uniquequery&gt;
              &lt;recordid&gt;C33&lt;/recordid&gt;
            &lt;/instance&gt;
        &lt;/model&gt;
	&lt;/item&gt;
&lt;/items&gt;




NOTE: Content inside any element expected to be valid and existing. In case you leave the content of any element to be blank, then that element is simply be ignored by the application. So, if you’re providing the information of record (in form of xml elements) then give it correct otherwise leave it blank, i.e., don’t provide invalid or non-existing information. 


item [Required]
	This is a child of &lt;items&gt;. This &lt;item&gt; tag can be multiple times to support "multiple items support". 

entity-type [Required]
	This is the type of entity that are supported in configuration management.
 	
	Valid Values- 
		change
		task 




operation-name [required] : 
	This shows, what operation you want to perform.

	Valid values: 
	If entity-type is “change” then- 
	  
&lt;operation-name&gt;approve-change&lt;/operation-name&gt; is valid operation name element.
		
If entity-type is “task” then-
		
&lt;operation-name&gt;approve-change-task&lt;/operation-name&gt; is valid operation name element.

key [Required] 
Any record is identified by some key. In other sense, it recognizes a record uniquely. This may be collection of elements, but for current case, the key is only &lt;change-number&gt;.
	
	Valid Value: 
Content inside &lt;key&gt; element (all child/children element(s)) refer to a record. If one leave the content inside &lt;key&gt; element then application wouldn’t find any record. The request would be executed leaving message that “no record found with specified “key.” 

Default Value: As this key is required, you need to keep this key even if field inside it is blank. 


change-number [Required]
When we create any change, then that record get an unique id. This element shows that id. For example 'C26' is id of a change created. 

Valid Values: Any string you can put inside it. If this string would refer to existing record then approving activity would take place otherwise the request would be executed leaving message that “no record found with specified key.”

instance [Required]
It can have many children. The children of this element describe fields of 	a record. It’s in fact necessary to search the record for approval.

	
Valid Values: this element “instance” must at least contain following elements (children)

&lt;header&gt;&lt;/header&gt;
&lt;description-structure&gt;&lt;/description-structure&gt;
&lt;middle&gt;&lt;/middle&gt;
&lt;close&gt;&lt;/close&gt;

Beyond these four children, you can put extra children too that describe the record but they are not Required.

Default Value: If you don’t at least above 4 children, the request wouldn’t be executed.

header [required]
	Keeps some header information of a record.

change-number [Optional]
see the description of change number above. If you don’t provide change number in the &lt;key&gt; element you need to provide it here. If you don’t provide change-number in &lt;key&gt; and &lt;header&gt; both, then application would be unable to find any record. The request would be executed successfully leaving no record found.
	
	

category [Optional]
	It shows category of a record. 
		
	Valid Values-
		Application,
		CI Group
		HW server
		MAC
		RFC, 
      	 	RFC – Advanced
       		Release Management
      		Security.
       
	Default Value: 
		Ignored.

status [Optional]
       It shows status of a record. 

Valid Values-
       initial
	waiting
	reopened
	closed
	
approval-status [Optional]
This shows approval-status of the record.

Valid Values
       Approved
       Pending
       Denied
	Default Values
		Ignored
       
coordinator-phone [Optional]
       This element contains phone-number of coordinator.
       
       Valid Value: Any String.
       
       Default Values: Ignored.
       
current-phase [Optional]
       
       It shows the current phase of a record. 
       Valid Values-
assess
plan
build
implement
accept
analysis
App approval
Approval
Assess
Assessment
Back Out
Build and Test
Building
CIGroupAccept
CIGroupDesign
CIGroupImplement
COMPANY MASTER
Design
Distributino and Rollout
HW Spec
HW server
Implementation
KM 1 Triag
KM 2 Revise
KM 3 Review Read-only
KM 4 Conclude
Plan and DEsign
Production
QA
RFC Testing
SecApproval
SecImplement
Testing
Train
Verification

	Default Value:
		Ignored.

priority [Optional]
Priority of a record can have 4 possible integer values.

	Valid Values
		1, 2, 3 and 4

	Meaning of these integers are-
       1 -&gt; critical
       2 -&gt; high
       3 -&gt; average
       4 -&gt; low

	Default Value
		Ignored.



date-entered [Optional]
	This simply show the date of entering the change record. The format of this element is "DateTime" 

	Valid Values: Any valid input in DateTime format.
	Default Value: Ignored.

open [Optional]
	This element shows, whether the record is still opened or not. Giving a value "true" means the record is opened. And giving a value "false" means record is not opened. 
	
	Valid Values: 
		true
		false
	Default Value: 
		Ignored.

backout-duration [Optional]
	It show the backout-duration of the record.
	
       Valid Values:
		Any DateTime format input.
	Default Value:
		Ignored.

description-structure [Required]
	This is array of all descriptions (like brief-description, description, justification, backout-method etc) in a record. Each child of description structure show some particular field for description.

	Valid Value: 
		Any String.
	Default Value:
		Ignored.

description [Optional]
	A descriptive field in the record. Multiple lines are represented by &lt;element&gt; elements.

	Valid Value:
		Any String.
	Default Value:
		Ignored.
 
justification [Optional]
	A descriptive field in the record. Multiple lines are represented by &lt;element&gt; elements.

	Valid Value: 
		Any String.
	Default Value: 
		Ignored.




backout-method [Optional]
	A descriptive field in the record. Multiple lines are represented by &lt;element&gt; elements.
	
	Valid Values:
		Any String.
	Default Value:
		Ignored.

middle [Required]
       This describes product specification (configuration item.)
       
       Valid Value: 
       	The elements inside it, should describes a valid product.
       Default Value: 
       	Ignored.
 
       
configuration-item [Optional]
       A field that shows some configuration item.
       
       Valid Value:
       	Any String that shows some product.
       
       Default Value: 
       	Ignored.

location [Optional]
       A field that show the location info for configuration-item.
       
       Valid Value:
       	Any String.
       Default Value: 
       	Ignored.
       
outage-start [Optional]
	A field that show the outage-start of the configuration item. The value inside it is, DateTime format.

	Valid Values:
		Any input in valid DateTime format.
	Default Value:
		Ignored.

outage-end [Optional]
	A filed that show the outage-end of the configuration item. The value inside it is, DateTime format.

	Valid Value:
		Any input in valid DateTime format.
	Default Value:
		Ignored.





close [Required] 
       This is 'close' information of the record.
       
       
       Valid Value:
       	Any Valid close information.
       Default value.
       	Ignored. 
       
completion-code [Optional]
       A field that is associated with 'close' information of the record.


urgency [Optional]
	This shows the level of urgency of the record. 

	Valid Values:
		1, 2,3 and 4.

	Meaning of these integers-

	1 -&gt; critical
	2 -&gt; high
	3 -&gt; average
	4 -&gt; low
	
       Default Value:
		Ignored.	

initial-assessment: 
	The initial assessment of the record. 
	Valid Values: 1, 2, 3, 4.
	Meaning of these integers-
		1 -&gt; Enterprise
2 -&gt; Site/Dept
3 -&gt; Multiple Users	
4 -&gt; User
	Default Value: Ignored.

uniquequery [Optional]
	This element contains the information by which we can make query of a record.
	
	Valid Value: 
		Any String which describes the record.
	Default value:
		Ignored.

recordid [Optional]
       ID provided to the record.

 	Valid Value:
		Any String that describes the record.
	Default Value:
		Ignored.
 
</description>
        <from>items</from>
        <to>items</to>
      </input>
      <input global="false" required="false">
        <from>connection parameters</from>
        <to>connection parameters</to>
      </input>
      <output global="false" required="false">
        <description> The adapter response containing the results. </description>
        <to>adapter response</to>
        <from>adapter response</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <call-process>
        <process-name>:AO-AD-HP_ServiceCenter:Utilities:Set Default Adapter Name</process-name>
        <parameters>
          <input>
            <from>adapter name</from>
            <to>adapter name</to>
          </input>
          <output>
            <from>adapter name</from>
            <to>adapter name</to>
          </output>
        </parameters>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>false</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <location>:call-process[1]</location>
      </call-process>
      <assign>
        <assignment>
          <document>
            <input>
              <from>items</from>
            </input>
          </document>
          <result>
            <output>
              <to>request element</to>
            </output>
          </result>
          <xpath-expression>
            <xpath-replacement-tokens />
            <xpath><![CDATA[concat((//operation-name)[1], "-request")]]></xpath>
          </xpath-expression>
        </assignment>
        <assignment>
          <document>
            <input>
              <from>connection parameters</from>
            </input>
          </document>
          <result>
            <output>
              <to>username</to>
            </output>
          </result>
          <xpath-expression>
            <xpath-replacement-tokens />
            <xpath><![CDATA[(//alternate-username)[1]/text()]]></xpath>
          </xpath-expression>
        </assignment>
        <assignment>
          <document>
            <input>
              <from>connection parameters</from>
            </input>
          </document>
          <result>
            <output>
              <to>password</to>
            </output>
          </result>
          <xpath-expression>
            <xpath-replacement-tokens />
            <xpath><![CDATA[(//alternate-password)[1]/text()]]></xpath>
          </xpath-expression>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <location>:assign[1]</location>
      </assign>
      <assign>
        <assignment>
          <document>
            <input>
              <from>items</from>
            </input>
          </document>
          <result>
            <output>
              <to>adapter request</to>
            </output>
          </result>
          <xslt-stylesheet>
            <stylesheet-replacement-tokens>
              <replacement-token name="items">
                <input global="false">
                  <from>items</from>
                </input>
              </replacement-token>
              <replacement-token name="request element">
                <input global="false">
                  <from>request element</from>
                </input>
              </replacement-token>
              <replacement-token name="username">
                <input global="false">
                  <from>username</from>
                </input>
              </replacement-token>
              <replacement-token name="password">
                <input global="false">
                  <from>password</from>
                </input>
              </replacement-token>
            </stylesheet-replacement-tokens>
            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <request-data>
      <hp-service-center-request>
        <xsl:if test="string('${username}') != ''">
          <username>
            <xsl:value-of select="'${username}'" disable-output-escaping="no" />
          </username>
        </xsl:if>
        <xsl:if test="string('${password}') != ''">
          <password>
            <xsl:value-of select="'${password}'" disable-output-escaping="no" />
          </password>
        </xsl:if>
        <entity>
          <xsl:text disable-output-escaping="no">change</xsl:text>
        </entity>
        <entity-type>
          <xsl:copy-of select="(//entity-type)[1]/text()" />
        </entity-type>
        <request>
          <operation-name>
            <xsl:copy-of select="(//operation-name)[1]/text()" />
          </operation-name>
          <xsl:for-each select="/items/item">
            <parameters>
              <xsl:element name="${request element}">
                <xsl:copy-of select="./model" />
              </xsl:element>
            </parameters>
          </xsl:for-each>
        </request>
      </hp-service-center-request>
    </request-data>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
          </xslt-stylesheet>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <location>:assign[2]</location>
      </assign>
      <call-adapter>
        <parameters>
          <input global="false">
            <from>adapter name</from>
          </input>
          <input>
            <value>
              <adapter-request>
                <peer-location>
                  <location>any</location>
                </peer-location>
                <request-action>invoke</request-action>
              </adapter-request>
            </value>
          </input>
          <input global="false">
            <from>adapter request</from>
          </input>
          <input global="false">
            <from>adapter request</from>
          </input>
          <output global="false">
            <to>adapter response</to>
          </output>
        </parameters>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <before-execution>
          <log>
            <level>debug</level>
            <parameters>
              <input>
                <value>Adapter Request:</value>
              </input>
              <input>
                <from>adapter request</from>
              </input>
              <input>
                <from>adapter name</from>
              </input>
            </parameters>
          </log>
        </before-execution>
        <after-execution>
          <log>
            <level>debug</level>
            <parameters>
              <input>
                <value>Adapter Response:</value>
              </input>
              <input>
                <from>adapter response</from>
              </input>
            </parameters>
          </log>
        </after-execution>
        <location>:call-adapter[1]</location>
      </call-adapter>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>Update Change
    Utility wrapper for updating a change

    Inputs
       adapter name    [Optional]
            The name of the adapter to use to handle the request. 
       version
             Identifies the version of HP Service Center system. Currently "v6.2" is supported.
        items
            The items for the adapter request. This should be an XML document with a root element named "items" having a child "item", which should contain the data necessary to execute the specific request. 
	operation name 
		The value of the operation-name as per the request data provided in the "items"
	alternate username [Optional] 
		Provide username if the corresponding value in the adapter config needs to be overridden
	alternate password [Optional] 
		Provide password if the corresponding value in the adapter config needs to be overridden
   Outputs
        adapter response
            The adapter response containing the results. </description>
        <version>1.0</version>
      </documentation>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>d339e46e-282a-3a7a-92ce-ed74467f2f13</process-id>
      <author />
      <category />
      <status />
      <keywords />
      <systems />
      <last-modified-by />
      <last-modified>1290593524430</last-modified>
    </meta>
  </process-def>
</process>