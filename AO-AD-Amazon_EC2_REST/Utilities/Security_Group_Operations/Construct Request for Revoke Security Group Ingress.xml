<process draft="false" dev-studio-version="20.02.00">
  <process-def name=":AO-AD-Amazon_EC2_REST:Utilities:Security_Group_Operations:Construct Request for Revoke Security Group Ingress">
    <parameters>
      <input global="false" required="false">
        <description>access key    [Optional]
            The AWS access key.</description>
        <from>access key</from>
        <to>access key</to>
      </input>
      <input global="false" required="false">
        <description>secret key    [Optional]
		 The AWS secret access key.</description>
        <from>secret key</from>
        <to>secret key</to>
      </input>
      <input global="false" required="false">
        <description>session token [Optional] : The AWS session token which is generally created for temporary access to users for role based authorization.

Please Note: The temporary access key , secret key and session token to be generated by the user to provide in adapter request.

Please refer below AWS docs for more details

https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp_request.html  

https://docs.aws.amazon.com/cli/latest/reference/sts/assume-role.html
</description>
        <from>session token</from>
        <to>session token</to>
      </input>
      <input global="false" required="false">
        <description>region    [Optional]
		 The region to communicate with.</description>
        <from>region</from>
        <to>region</to>
      </input>
      <input global="false" required="true">
        <description>group name [Mandatory]

Name of the group to modify. The name must be valid and belong to the account

</description>
        <from>group name</from>
        <to>group name</to>
      </input>
      <input global="false" required="false">
        <description>ip permissions[Optional]

Set of permissions for the security group.

Description of different parameters in this is as below:

ip-protocol - Valid Values: tcp,udp,icmp
from-port - Start of port range for the TCP and UDP protocols, or an ICMP type number. 
to-port - End of port range for the TCP and UDP protocols, or an ICMP code.
groups - List of security group and user ID pairs.
ip-ranges - Contains list of CIDR IP ranges

Sample ip permissions structure:

&lt;ip-permissions&gt;
    &lt;!--Zero or more repetition--&gt;
    &lt;item&gt;
        &lt;ip-protocol&gt;&lt;/ip-protocol&gt;
        &lt;from-port&gt;&lt;/from-port&gt;
        &lt;to-port&gt;&lt;/to-port&gt;
        &lt;groups&gt;
            &lt;!--Zero or more repetition--&gt;
            &lt;item&gt;
                &lt;user-id&gt;&lt;/user-id&gt;
                &lt;group-name&gt;&lt;/group-name&gt;
            &lt;/item&gt;
        &lt;/groups&gt;
        &lt;ip-ranges&gt;
            &lt;!--Zero or more repetition--&gt;
            &lt;item&gt;
                &lt;cidr-ip&gt;&lt;/cidr-ip&gt;
            &lt;/item&gt;
        &lt;/ip-ranges&gt;
    &lt;/item&gt;
&lt;/ip-permissions&gt;
</description>
        <from>ip permissions</from>
        <to>ip permissions</to>
      </input>
      <output global="false" required="false">
        <to>adapter request</to>
        <from>adapter request</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <assign>
        <assignment>
          <output>
            <to>adapter request</to>
            <value>
              <empty />
            </value>
          </output>
          <xslt-stylesheet>
            <stylesheet-replacement-tokens>
              <replacement-token name="group name">
                <input global="false">
                  <from>group name</from>
                </input>
              </replacement-token>
              <replacement-token name="ip permissions">
                <input global="false">
                  <from>ip permissions</from>
                </input>
              </replacement-token>
              <replacement-token name="access key">
                <input global="false">
                  <from>access key</from>
                </input>
              </replacement-token>
              <replacement-token name="secret key">
                <input global="false">
                  <from>secret key</from>
                </input>
              </replacement-token>
              <replacement-token name="region">
                <input global="false">
                  <from>region</from>
                </input>
              </replacement-token>
              <replacement-token name="session token">
                <input global="false">
                  <from>session token</from>
                </input>
              </replacement-token>
            </stylesheet-replacement-tokens>
            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="yes" />
  <xsl:template match="/">
    <request-data>
      <amazon-ec2-rest-request>
        <xsl:if test="string-length('${access key}')&gt;0">
          <access-key>${access key}</access-key>
        </xsl:if>
        <xsl:if test="string-length('${secret key}')&gt;0">
          <secret-key>${secret key}</secret-key>
        </xsl:if>
        <xsl:if test="string-length('${session token}')&gt;0  and string-length('${secret key}')&gt;0 and string-length('${access key}')&gt;0">
          <session-token>${session token}</session-token>
        </xsl:if>
        <xsl:if test="string-length('${region}')&gt;0">
          <region>${region}</region>
        </xsl:if>
        <operation-name>
          <xsl:text disable-output-escaping="no">revoke-security-group-ingress</xsl:text>
        </operation-name>
        <parameters>
          <group-name>${group name}</group-name>
          ${ip permissions}
        </parameters>
      </amazon-ec2-rest-request>
    </request-data>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
          </xslt-stylesheet>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <location>:assign[1]</location>
      </assign>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>Revokes permissions from a security group. The permissions used to revoke must be specified using
the same values used to grant the permissions.

Permissions are specified by IP protocol (TCP, UDP, or ICMP), the source of the request (by IP range
or an Amazon EC2 user-group pair), the source and destination port ranges (for TCP and UDP), and
the ICMP codes and types (for ICMP).</description>
        <version>1.0</version>
      </documentation>
      <logging-options>
        <is-enabled>false</is-enabled>
        <log-file-name></log-file-name>
      </logging-options>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>9916947d-762b-3352-a7fe-ac7e0ebc3907</process-id>
      <author>admin</author>
      <category></category>
      <status></status>
      <keywords></keywords>
      <systems></systems>
      <last-modified-by>aoadmin</last-modified-by>
      <last-modified>1609918576586</last-modified>
    </meta>
  </process-def>
</process>