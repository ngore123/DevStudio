<process draft="false" dev-studio-version="7.6.01.04">
  <process-def name=":AutoPilot-OA-Virtual_Server_Management:Utilities:VMware:Get VM Configuration">
    <parameters>
      <input global="false" required="true">
        <description>Virtual machine whose power status is to be queried</description>
        <from>vm name</from>
        <to>vm name</to>
      </input>
      <input global="false" required="false">
        <description>[optional] Name of the Virtual center which is hosting the given virtual machine</description>
        <from>virtual center</from>
        <to>virtual center</to>
      </input>
      <input global="false" required="false">
        <description>[optional] 

Specifies the url for the remote soap service running on the vmware virtual center.</description>
        <from>soap url</from>
        <to>soap url</to>
      </input>
      <input global="false" required="false">
        <description>[optional] 

Specifies the user name that will be used for http basic authentication on the vmware virtual center.</description>
        <from>username</from>
        <to>username</to>
      </input>
      <input global="false" required="false">
        <description>[optional] 

Specifies the password corresponding to the specified user name.</description>
        <from>password</from>
        <to>password</to>
      </input>
      <input global="false" required="false">
        <description>[optional] 

Specifies the transport protocol for the message.</description>
        <from>transport</from>
        <to>transport</to>
      </input>
      <output global="false" required="false">
        <description>String Value - Indicates whether or not the process completed successfully. 

Valid values: success, failure </description>
        <to>success status</to>
        <from>success status</from>
      </output>
      <output global="false" required="false">
        <description>String Value - A process specific explanation for the value of success status.</description>
        <to>status message</to>
        <from>status message</from>
      </output>
      <output global="false" required="false">
        <to>adapter response</to>
        <from>adapter response</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <switch>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <execute-all-applicable-cases>false</execute-all-applicable-cases>
        <default>
          <sequence>
            <call-process>
              <process-name>:AutoPilot-OA-Virtual_Server_Management:Utilities:Extract Configuration Data</process-name>
              <parameters>
                <input>
                  <value>VMware</value>
                  <to>configuration name</to>
                </input>
                <input>
                  <from>virtual center</from>
                  <to>virtual center</to>
                </input>
                <output>
                  <from>adapter</from>
                  <to>adapter</to>
                </output>
                <output>
                  <from>version</from>
                  <to>version</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[1]:call-process[1]</location>
            </call-process>
            <call-process>
              <process-name>:RBA-AD-VMware_Infrastructure:Utilities:Construct Connection Parameters</process-name>
              <parameters>
                <input>
                  <from>username</from>
                  <to>alternate username</to>
                </input>
                <input>
                  <from>password</from>
                  <to>alternate password</to>
                </input>
                <input>
                  <from>soap url</from>
                  <to>alternate soap URL</to>
                </input>
                <input>
                  <from>transport</from>
                  <to>alternate transport</to>
                </input>
                <output>
                  <from>connection parameters</from>
                  <to>connection parameters</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <after-execution>
                <console-output>
                  <type>INFO</type>
                  <summary>
                    <concat>
                      <input>
                        <value></value>
                      </input>
                    </concat>
                  </summary>
                  <detail>
                    <concat>
                      <input>
                        <value></value>
                      </input>
                    </concat>
                  </detail>
                </console-output>
              </after-execution>
              <location>:switch[1]:sequence[1]:call-process[2]</location>
            </call-process>
          </sequence>
        </default>
        <case>
          <condition>
            <document>
              <input>
                <from>soap url</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens>
                <replacement-token name="username">
                  <input global="false">
                    <from>username</from>
                  </input>
                </replacement-token>
                <replacement-token name="password">
                  <input global="false">
                    <from>password</from>
                  </input>
                </replacement-token>
              </xpath-replacement-tokens>
              <xpath><![CDATA[(string-length(.) = 0) or (string-length('${username}') = 0) or (string-length('${password}') = 0)]]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <call-process>
              <process-name>:AutoPilot-OA-Virtual_Server_Management:Utilities:Extract Configuration Data</process-name>
              <parameters>
                <input>
                  <value>VMware</value>
                  <to>configuration name</to>
                </input>
                <input>
                  <from>virtual center</from>
                  <to>virtual center</to>
                </input>
                <output>
                  <from>adapter</from>
                  <to>adapter</to>
                </output>
                <output>
                  <from>version</from>
                  <to>version</to>
                </output>
                <output>
                  <from>soap url</from>
                  <to>soap url</to>
                </output>
                <output>
                  <from>username</from>
                  <to>username</to>
                </output>
                <output>
                  <from>transport</from>
                  <to>transport</to>
                </output>
                <output>
                  <from>password</from>
                  <to>password</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <after-execution>
                <console-output>
                  <type>INFO</type>
                  <summary>
                    <concat>
                      <input>
                        <value></value>
                      </input>
                    </concat>
                  </summary>
                  <detail>
                    <concat>
                      <input>
                        <value></value>
                      </input>
                    </concat>
                  </detail>
                </console-output>
              </after-execution>
              <location>:switch[1]:sequence[2]:call-process[1]</location>
            </call-process>
            <call-process>
              <process-name>:RBA-AD-VMware_Infrastructure:Utilities:Construct Connection Parameters</process-name>
              <parameters>
                <input>
                  <from>username</from>
                  <to>alternate username</to>
                </input>
                <input>
                  <from>password</from>
                  <to>alternate password</to>
                </input>
                <input>
                  <from>soap url</from>
                  <to>alternate soap URL</to>
                </input>
                <input>
                  <from>transport</from>
                  <to>alternate transport</to>
                </input>
                <output>
                  <from>connection parameters</from>
                  <to>connection parameters</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <after-execution>
                <console-output>
                  <type>INFO</type>
                  <summary>
                    <concat>
                      <input>
                        <value></value>
                      </input>
                    </concat>
                  </summary>
                  <detail>
                    <concat>
                      <input>
                        <value></value>
                      </input>
                    </concat>
                  </detail>
                </console-output>
              </after-execution>
              <location>:switch[1]:sequence[2]:call-process[2]</location>
            </call-process>
          </sequence>
        </case>
        <location>:switch[1]</location>
      </switch>
      <call-process>
        <process-name>:RBA-AD-VMware_Infrastructure:Utilities:VM_Configuration_Operations:Construct Item for Retrieve VM Configuration</process-name>
        <parameters>
          <input>
            <from>vm name</from>
            <to>virtual machine</to>
          </input>
          <output>
            <from>items</from>
            <to>items</to>
          </output>
        </parameters>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>false</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <after-execution>
          <console-output>
            <type>INFO</type>
            <summary>
              <concat>
                <input>
                  <value></value>
                </input>
              </concat>
            </summary>
            <detail>
              <concat>
                <input>
                  <value></value>
                </input>
              </concat>
            </detail>
          </console-output>
        </after-execution>
        <location>:call-process[1]</location>
      </call-process>
      <call-process>
        <process-name>:RBA-AD-VMware_Infrastructure:Find Items</process-name>
        <parameters>
          <input>
            <from>adapter</from>
            <to>adapter name</to>
          </input>
          <input>
            <from>items</from>
            <to>items</to>
          </input>
          <input>
            <value>Retrieve_VM_Configuration</value>
            <to>item type</to>
          </input>
          <input>
            <from>version</from>
            <to>version</to>
          </input>
          <input>
            <from>connection parameters</from>
            <to>connection parameters</to>
          </input>
          <output>
            <from>adapter response</from>
            <to>adapter response</to>
          </output>
        </parameters>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>false</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <after-execution>
          <console-output>
            <type>INFO</type>
            <summary>
              <concat>
                <input>
                  <value></value>
                </input>
              </concat>
            </summary>
            <detail>
              <concat>
                <input>
                  <value></value>
                </input>
              </concat>
            </detail>
          </console-output>
        </after-execution>
        <location>:call-process[2]</location>
      </call-process>
      <assign>
        <assignment>
          <document>
            <input>
              <from>adapter response</from>
            </input>
          </document>
          <result>
            <output>
              <to>success status</to>
            </output>
          </result>
          <xslt-stylesheet>
            <stylesheet-replacement-tokens />
            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <element>
      <xsl:choose>
        <xsl:when test="string(//status/text()) = 'success' and string-length(//faultstring/text()) = 0">
          <xsl:text disable-output-escaping="no">success</xsl:text>
        </xsl:when>
        <xsl:otherwise>
          <xsl:text disable-output-escaping="no">failure</xsl:text>
        </xsl:otherwise>
      </xsl:choose>
    </element>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
          </xslt-stylesheet>
        </assignment>
        <assignment>
          <document>
            <input>
              <from>adapter response</from>
            </input>
          </document>
          <result>
            <output>
              <to>status message</to>
            </output>
          </result>
          <xpath-expression>
            <xpath-replacement-tokens />
            <xpath><![CDATA[//faultstring/text()]]></xpath>
          </xpath-expression>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <location>:assign[1]</location>
      </assign>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>This action extracts configuration details for the given vm.

This action supports dynamic targeting for multiple virtual centers. For using dynamic targeting, one has to pass in the input the connection details for the target virtual center comprising of:

- soap url
- username
- password
- transport

The above parameters are optional. If one does not pass the above parameters, then the "virtual center" input parameter has to be passed.  In this case, the connection details for the given virtual center will be extracted from the module configuration.  The pre-requisite for the latter case is that the connection details for the given virtual center have to be present in module configuration of the AO Virtual Server Management module.
</description>
        <version></version>
      </documentation>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <author>admin</author>
      <category></category>
      <status></status>
      <keywords></keywords>
      <systems></systems>
      <last-modified-by>admin</last-modified-by>
      <last-modified>1296323721427</last-modified>
    </meta>
  </process-def>
</process>