<process draft="false" dev-studio-version="7.6.01.00">
  <process-def name=":AutoPilot-OA-Operating_System_Utilities:Logging:Update Event Log Create Counter">
    <parameters>
      <input global="false" required="true">
        <description>XML document conforming to the Connection Details Concept that contains the information required to execute a command via command line.</description>
        <from>connection details</from>
        <to>connection details</to>
      </input>
      <input global="false" required="true">
        <description>Specifies the name of the collection object.</description>
        <from>collection name</from>
        <to>collection name</to>
      </input>
      <input global="false" required="true">
        <description>-c{Path[Path ...] or cfFileName}
Specifies the performance counter path to log, or specifies the pathname of the log file that lists these counters. To list multiple counter paths, separate the command line by a space, or use the -cf option to list counter paths in an input file, one per line.The general format for counter paths is as follows: [\\Computer]\Object[Parent/Instance#Index]\Counter] where the parent, instance, index, and counter components of the format can contain either a valid name or a wildcard character. The computer, parent, instance, and index components are not necessary for all counters.You determine the counter paths to use based on the counter itself. For example, the LogicalDisk object has an instance Index, so you must provide the #Index or a wildcard. Therefore, you could use the following format:\LogicalDisk(*/*#*)\*In comparison, the process object does not require an instance Index. Therefore, you could use the following format:\process(*)\ID processThe following is a list of the possible formats:\\computer\object(parent/instance#index)\counter\\computer\object(parent/instance)\counter\\computer\object(instance#index)\counter\\computer\object(instance)\counter\\computer\object\counter\object(parent/instance#index)\counter\object(parent/instance)\counter \object(instance#index)\counter\object(instance)\counter\object\counterIf a wildcard character is specified in the parent name, all instances of the specified object that match the specified instance and counter fields will be returned.If a wildcard character is specified in the instance name, all instances of the specified object and parent object will be returned if all instance names corresponding to the specified index match the wildcard character.If a wildcard character is specified in the counter name, all counters of the specified object are returned.Partial counter path string matches (for example, pro*) are not supported.
</description>
        <from>performance counter path</from>
        <to>counter path</to>
      </input>
      <input global="false" required="true">
        <description>-b M/D/YYYYH:MM:SS[{ AM or PM}]
Specifies begin-time for collections in a 24-hour format. You can also specify begin-time for collections in a 12-hour format by adding AM or PM in the command line. By default, the current day and time is used unless otherwise specified. Use the manual start option to start the collection immediately.</description>
        <from>begin</from>
        <to>begin</to>
      </input>
      <input global="false" required="true">
        <description>-e M/D/YYYYH:MM:SS[{ AM or PM}]
Specifies end-time for collections in a 24-hour format. You can also specify end-time for collections in a 12-hour format by adding AM or PM in the command line. By default, the current day and time is used unless otherwise specified. Use the manual stop and then the repeat option to specify a stop time before the actual current time, or you will receive an error message.
</description>
        <from>end</from>
        <to>end</to>
      </input>
      <input global="false" required="true">
        <description>-o {Path or DSN!CounterLog}
Specifies the pathname of the output file that collects performance counter and trace data, or the location of the SQL database and dataset. To specify SQL using the DSN!CounterLog format, use the -f option in the command line. By default, the collection log file name is the collection query name suffixed by either .blg for performance counters, or .etl for trace data.</description>
        <from>output path</from>
        <to>output path</to>
      </input>
      <input global="false" required="true">
        <description>-f {bin or bincirc or csv or tsv or SQL}
Specifies the file format used for collecting performance counter and trace data. You can use binary, circular binary, comma and tab separated, or SQL database formats when collecting performance counters. You must use the -o option in the command line with the DNS!counter_log option. For SQL database formats, the Database System Name (DSN) must be predefined, and administrative credentials granted to write to the database. The dataset CounterLog is created in the database, and is specified by the DSN. Defaults to binary.
</description>
        <from>output format</from>
        <to>output format</to>
      </input>
      <input global="false" required="false">
        <description>-v {NNNNN or MMDDHHMM}
Attaches the version control information to the end of the output file and path name. Use numeric NNNNNN format, or date format MMDDHHMM (month, day, 24-hour, minute) for version control.</description>
        <from>version control</from>
        <to>version control</to>
      </input>
      <input global="false" required="true">
        <description>-si [[HH:]MM:]SS
Specifies sample intervals for performance counter collection in hours, minutes, and seconds. Default is 15 seconds.</description>
        <from>sample interval</from>
        <to>sample interval</to>
      </input>
      <input global="false" required="true">
        <description>rf [[HH:]MM:]SS
Specifies that collections run for a set period of time.</description>
        <from>run period</from>
        <to>run period</to>
      </input>
      <input global="false" required="false">
        <description>-max Value
Specifies the maximum size of the collected log file in megabytes. If the log file exceeds the maximum size, the collection will stop. For a SQL database, the maximum size is the number of records to be written.
</description>
        <from>maximum file size</from>
        <to>max value</to>
      </input>
      <input global="false" required="false">
        <description>-rc FileName
Specifies to run this command after the file is closed either at the end, or during the collection period. Use the -rf option in conjunction with -cnf to close the files during the collection periods. Using the -stop option will not turn off this command. Commands always run in the foreground.</description>
        <from>run this command when file is closed</from>
        <to>run command</to>
      </input>
      <input global="false" required="false">
        <description>-config FileName
Specifies the pathname of the settings file that contains command line parameters.</description>
        <from>config filename</from>
        <to>config filename</to>
      </input>
      <output global="false" required="true">
        <description>XML document consisting of one or more &lt;line&gt; elements that contain the command response. Each  &lt;line&gt; element contains an index attribute indicating the order in which the information was returned by the command.</description>
        <to>output</to>
        <from>command output</from>
      </output>
      <output global="false" required="true">
        <description>Did the operation Succeed? Valid value: true.</description>
        <to>success</to>
        <from>exit code</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <switch>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <execute-all-applicable-cases>false</execute-all-applicable-cases>
        <default>
          <sequence />
        </default>
        <case applies-if-any-condition-true="false">
          <condition>
            <document>
              <input>
                <from>output format</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[. !='bin']]></xpath>
            </xpath-expression>
          </condition>
          <condition>
            <document>
              <input>
                <from>output format</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[. !='bincirc']]></xpath>
            </xpath-expression>
          </condition>
          <condition>
            <document>
              <input>
                <from>output format</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[. != 'csv']]></xpath>
            </xpath-expression>
          </condition>
          <condition>
            <document>
              <input>
                <from>output format</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[. !='tsv']]></xpath>
            </xpath-expression>
          </condition>
          <condition>
            <document>
              <input>
                <from>output format</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[. !='SQL']]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <assign>
              <assignment>
                <output>
                  <to>output format</to>
                  <value>
                    <empty />
                  </value>
                </output>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:assign[1]</location>
            </assign>
          </sequence>
        </case>
        <location>:switch[1]</location>
      </switch>
      <call-process>
        <process-name>:AutoPilot-OA-Common_Utilities:Invoke Command</process-name>
        <parameters>
          <input>
            <from>connection details</from>
            <to>connection details</to>
          </input>
          <input>
            <value>
              <empty />
            </value>
            <xslt-stylesheet>
              <stylesheet-replacement-tokens>
                <replacement-token name="collection name">
                  <input global="false">
                    <from>collection name</from>
                  </input>
                </replacement-token>
                <replacement-token name="counter path">
                  <input global="false">
                    <from>counter path</from>
                  </input>
                </replacement-token>
                <replacement-token name="begin">
                  <input global="false">
                    <from>begin</from>
                  </input>
                </replacement-token>
                <replacement-token name="end">
                  <input global="false">
                    <from>end</from>
                  </input>
                </replacement-token>
                <replacement-token name="sample interval">
                  <input global="false">
                    <from>sample interval</from>
                  </input>
                </replacement-token>
                <replacement-token name="output path">
                  <input global="false">
                    <from>output path</from>
                  </input>
                </replacement-token>
                <replacement-token name="output format">
                  <input global="false">
                    <from>output format</from>
                  </input>
                </replacement-token>
                <replacement-token name="max value">
                  <input global="false">
                    <from>max value</from>
                  </input>
                </replacement-token>
                <replacement-token name="version control">
                  <input global="false">
                    <from>version control</from>
                  </input>
                </replacement-token>
                <replacement-token name="run command">
                  <input global="false">
                    <from>run command</from>
                  </input>
                </replacement-token>
                <replacement-token name="run period">
                  <input global="false">
                    <from>run period</from>
                  </input>
                </replacement-token>
                <replacement-token name="config">
                  <input global="false">
                    <from>config filename</from>
                  </input>
                </replacement-token>
              </stylesheet-replacement-tokens>
              <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="yes" />
  <xsl:template match="/">
    <fat-command>
      <command os-id="Cisco IOS">
        <xsl:text disable-output-escaping="no">show</xsl:text>
      </command>
      <command os-id="Linux">
        <xsl:text disable-output-escaping="no">/bin/echo "Not Supported"</xsl:text>
      </command>
      <command os-id="SunOS">
        <xsl:text disable-output-escaping="no">/usr/bin/echo "Not Supported"</xsl:text>
      </command>
      <command os-id="Windows Default">
        <xsl:text disable-output-escaping="no">logman create counter "${collection name}"</xsl:text>
        <xsl:if test="string-length('${counter path}')!=0">
          <xsl:text disable-output-escaping="no"> -c "${counter path}"</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${begin}')!=0">
          <xsl:text disable-output-escaping="no"> -b ${begin}</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${end}')!=0">
          <xsl:text disable-output-escaping="no"> -e ${end}</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${output path}')!=0">
          <xsl:text disable-output-escaping="no"> -o "${output path}"</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${output format}')!=0">
          <xsl:text disable-output-escaping="no"> -f ${output format}</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${version control}')!=0">
          <xsl:text disable-output-escaping="no"> -v ${version control}</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${run command }')!=0">
          <xsl:text disable-output-escaping="no"> -rc ${run command}</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${max value}')!=0">
          <xsl:text disable-output-escaping="no"> -max ${max value}</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${sample interval}')!=0">
          <xsl:text disable-output-escaping="no"> -si ${sample interval}</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${run period}')!=0">
          <xsl:text disable-output-escaping="no"> -rf ${run period}</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${config}')!=0">
          <xsl:text disable-output-escaping="no"> -config ${config}</xsl:text>
        </xsl:if>
      </command>
    </fat-command>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
            </xslt-stylesheet>
            <to>command</to>
          </input>
          <output>
            <from>command output</from>
            <to>command output</to>
          </output>
          <output>
            <from>exit code</from>
            <to>exit code</to>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[string(.)=0]]></xpath>
            </xpath-expression>
          </output>
        </parameters>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>false</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <after-execution>
          <console-output>
            <type>INFO</type>
            <summary>
              <concat>
                <input>
                  <value></value>
                </input>
              </concat>
            </summary>
            <detail>
              <concat>
                <input>
                  <value></value>
                </input>
              </concat>
            </detail>
          </console-output>
        </after-execution>
        <location>:call-process[1]</location>
      </call-process>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>Manages and schedules performance counter collections on local and remote systems.</description>
        <version>1.0</version>
      </documentation>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>3aba6af5-ad49-3ce1-9b3b-ca4818473a3a</process-id>
      <author />
      <category />
      <status />
      <keywords />
      <systems />
      <last-modified-by />
      <last-modified>1291031872192</last-modified>
    </meta>
  </process-def>
</process>