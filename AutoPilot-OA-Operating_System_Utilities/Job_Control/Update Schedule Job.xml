<process draft="false" dev-studio-version="7.6.01.00">
  <process-def name=":AutoPilot-OA-Operating_System_Utilities:Job_Control:Update Schedule Job">
    <parameters>
      <input global="false" required="true">
        <description>XML document conforming to the Connection Details Concept that contains the information required to execute a command via command line.</description>
        <from>connection details</from>
        <to>connection details</to>
      </input>
      <input global="false" required="true">
        <description>Specifies a name for the task. Each task on the system must have a unique name. The name must conform to the rules for file names and must not exceed 238 characters. Use quotation marks to enclose names that include spaces.</description>
        <from>task name</from>
        <to>task name</to>
      </input>
      <input global="false" required="true">
        <description>Specifies the program or command that the task runs. Type the fully qualified path and file name of an executable file, script file, or batch file. The path name must not exceed 262 characters. If you omit the path, Schtasks assumes that the file is in the Systemroot\System32 directory.</description>
        <from>task run</from>
        <to>task run</to>
      </input>
      <input global="false" required="false">
        <description>Specifies the time of day that the task starts (each time it starts) in HH:MM 24-hour format. The default value is the current time on the local computer. The /st parameter is valid with MINUTE, HOURLY, DAILY, WEEKLY, MONTHLY, and ONCE schedules. It is required for a ONCE schedule.</description>
        <from>start time</from>
        <to>start time</to>
      </input>
      <input global="false" required="false">
        <description>Specifies the repetition interval in minutes. This is not applicable for schedule types: MINUTE, HOURLY, ONSTART, ONLOGON, ONIDLE. Valid range is 1 to 599940 minutes (599940 minutes = 9999 hours). If either /ET or /DU is specified, then the repetition interval defaults to 10 minutes.</description>
        <from>interval</from>
        <to>interval</to>
      </input>
      <input global="false" required="false">
        <description>Specifies the time of day that a minute or hourly task schedule ends in HH:MM 24-hour format. After the specified end time, Schtasks does not start the task again until the start time recurs. By default, task schedules have no end time. This parameter is optional and valid only with a MINUTE or HOURLY schedule. For an example, see:"To schedule a task that runs every 100 minutes during non-business hours" in the To schedule a task that runs every N minutes section.</description>
        <from>end time</from>
        <to>end time</to>
      </input>
      <input global="false" required="false">
        <description>Specifies a maximum length of time for a minute or hourly schedule in HHHH:MM 24-hour format. After the specified time elapses, Schtasks does not start the task again until the start time recurs. By default, task schedules have no maximum duration. This parameter is optional and valid only with a MINUTE or HOURLY schedule. For an example, see:"To schedule a task that runs every 3 hours for 10 hours" in the To schedule a task that runs every N hours section.</description>
        <from>duration</from>
        <to>duration</to>
      </input>
      <input global="false" required="false">
        <description>Stops the program that the task runs at the time specified by /et or /du. Without /k, Schtasks does not start the program again after it reaches the time specified by /et or /du, but it does not stop the program if it is still running. This parameter is optional and valid only with a MINUTE or HOURLY schedule. For an example, see:"To schedule a task that runs every 100 minutes during non-business hours" in the To schedule a task that runs every N minutes section.formats</description>
        <from>start date</from>
        <to>start date</to>
      </input>
      <input global="false" required="false">
        <description>Specifies the date on which the schedule ends. This parameter is optional. It is not valid in a ONCE, ONSTART, ONLOGON, or ONIDLE schedule. By default, schedules have no ending date. The format for the EndDate argument varies with the locale selected for the local computer in Regional and Language Options in Control Panel. Only one format is valid for each locale.The valid date formats are listed in the following table. Use the format most similar to the format selected for Short date in Regional and Language Options in Control Panel on the local computer.MM/DD/YYYYUse for month-first formats, such as English (United States) and Spanish (Panama).DD/MM/YYYYUse for day-first formats, such as Bulgarian and Dutch (Netherlands).YYYY/MM/DDUse for year-first formats, such as Swedish and French (Canada).</description>
        <from>end date</from>
        <to>end date</to>
      </input>
      <input global="false" required="false">
        <description>rovides the password for the user account that is specified in the /ru [Domain\]User parameter. If you omit this parameter when specifying a user account, SchTasks.exe prompts you for the password and obscures the text you type. Do not use the /rp parameter for tasks run with permissions of the System account (/ru System). The system account does not have a password and SchTasks.exe does not prompt for one.</description>
        <from>runas user</from>
        <to>runas user</to>
      </input>
      <input global="false" required="false">
        <description>Specifies how often the task runs within its schedule type. This parameter is valid, but optional, for a MINUTE, HOURLY, DAILY, WEEKLY, and MONTHLY schedule. The default value is 1. Schedule typeModifier valuesDescriptionMINUTE1 - 1439The task runs every N minutes.HOURLY1 - 23The task runs every N hours.DAILY1 - 365The task runs every N days.WEEKLY1 - 52The task runs every N weeks.ONCENo modifiers.The task runs once.ONSTARTNo modifiers.The task runs at startup.ONLOGONNo modifiers.The task runs when the user specified by the /u parameter logs on.ONIDLENo modifiers.The task runs after the system is idle for the number of minutes specified by the /i parameter, which is required for use with ONIDLE.MONTHLY1 - 12The task runs every N months.MONTHLYLASTDAYThe task runs on the last day of the month.MONTHLYFIRST, SECOND, THIRD, FOURTH, LASTUse with the /dDay parameter to run a task on a particular week and day. For example, on the third Wednesday of the month.</description>
        <from>runas password</from>
        <to>runas password</to>
      </input>
      <input global="false" required="false">
        <description>Specifies weather to enable or disable the scheduled job.

Valid values: enable or disable.</description>
        <from>enable or disable</from>
        <to>enable disable</to>
      </input>
      <output global="false" required="true">
        <description>XML document consisting of one or more &lt;line&gt; elements that contain the command response. Each  &lt;line&gt; element contains an index attribute indicating the order in which the information was returned by the command.</description>
        <to>output</to>
        <from>command output</from>
      </output>
      <output global="false" required="true">
        <description>Did the operation Succeed? Valid value: true.</description>
        <to>success</to>
        <from>exit code</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <call-process>
        <process-name>:AutoPilot-OA-Common_Utilities:Invoke Command</process-name>
        <parameters>
          <input>
            <from>connection details</from>
            <to>connection details</to>
          </input>
          <input>
            <value>
              <empty />
            </value>
            <xslt-stylesheet>
              <stylesheet-replacement-tokens>
                <replacement-token name="tn">
                  <input global="false">
                    <from>task name</from>
                  </input>
                </replacement-token>
                <replacement-token name="tr">
                  <input global="false">
                    <from>task run</from>
                  </input>
                </replacement-token>
                <replacement-token name="st">
                  <input global="false">
                    <from>start time</from>
                  </input>
                </replacement-token>
                <replacement-token name="ri">
                  <input global="false">
                    <from>interval</from>
                  </input>
                </replacement-token>
                <replacement-token name="et">
                  <input global="false">
                    <from>end time</from>
                  </input>
                </replacement-token>
                <replacement-token name="du">
                  <input global="false">
                    <from>duration</from>
                  </input>
                </replacement-token>
                <replacement-token name="sd">
                  <input global="false">
                    <from>start date</from>
                  </input>
                </replacement-token>
                <replacement-token name="ed">
                  <input global="false">
                    <from>end date</from>
                  </input>
                </replacement-token>
                <replacement-token name="ru">
                  <input global="false">
                    <from>runas user</from>
                  </input>
                </replacement-token>
                <replacement-token name="rp">
                  <input global="false">
                    <from>runas password</from>
                  </input>
                </replacement-token>
                <replacement-token name="enable disable">
                  <input global="false">
                    <from>enable disable</from>
                  </input>
                </replacement-token>
              </stylesheet-replacement-tokens>
              <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="yes" />
  <xsl:template match="/">
    <fat-command>
      <command os-id="Cisco IOS">
        <xsl:text disable-output-escaping="no">show</xsl:text>
      </command>
      <command os-id="Windows Default">
        <xsl:text disable-output-escaping="no">schtasks /change /tn ${tn} /tr ${tr}</xsl:text>
        <xsl:if test="string-length('${ru}')!=0">
          <xsl:text disable-output-escaping="no"> /ru ${ru}</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${rp}')!=0">
          <xsl:text disable-output-escaping="no"> /rp ${rp}</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${st}')!=0">
          <xsl:text disable-output-escaping="no"> /st ${st}</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${ri}')!=0">
          <xsl:text disable-output-escaping="no"> /ri ${ri}</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${et}')!=0">
          <xsl:text disable-output-escaping="no"> /et ${et}</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${du}')!=0">
          <xsl:text disable-output-escaping="no"> /du ${du}</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${et}')!=0 and string-length('${du}')!=0">
          <xsl:text disable-output-escaping="no"> /k</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${sd}')!=0">
          <xsl:text disable-output-escaping="no"> /sd ${sd}</xsl:text>
        </xsl:if>
        <xsl:if test="string-length('${ed}')!=0">
          <xsl:text disable-output-escaping="no"> /ed ${ed}</xsl:text>
        </xsl:if>
        <xsl:text disable-output-escaping="no"> /Z</xsl:text>
        <xsl:if test="string-length('${enable disable}')!=0">
          <xsl:text disable-output-escaping="no"> /${enable disable}</xsl:text>
        </xsl:if>
      </command>
      <command os-id="Linux">
        <xsl:text disable-output-escaping="no">/bin/echo "Not Supported."</xsl:text>
      </command>
      <command os-id="SunOS">
        <xsl:text disable-output-escaping="no">/usr/bin/echo "Not Supported."</xsl:text>
      </command>
    </fat-command>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
            </xslt-stylesheet>
            <to>command</to>
          </input>
          <output>
            <from>command output</from>
            <to>command output</to>
          </output>
          <output>
            <from>exit code</from>
            <to>exit code</to>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[string(.)=0]]></xpath>
            </xpath-expression>
          </output>
        </parameters>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>false</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <after-execution>
          <console-output>
            <type>INFO</type>
            <summary>
              <concat>
                <input>
                  <value></value>
                </input>
              </concat>
            </summary>
            <detail>
              <concat>
                <input>
                  <value></value>
                </input>
              </concat>
            </detail>
          </console-output>
        </after-execution>
        <location>:call-process[1]</location>
      </call-process>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>Change the following parameters of a Scheduled task:

The program that the task runs (/tr).	
The user account under which the task runs (/ru).	
The password for the user account (/rp).
</description>
        <version>1.0</version>
      </documentation>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>7d5f855f-a8df-3248-83c9-99e20df510ae</process-id>
      <author />
      <category />
      <status />
      <keywords />
      <systems />
      <last-modified-by />
      <last-modified>1291031867384</last-modified>
    </meta>
  </process-def>
</process>