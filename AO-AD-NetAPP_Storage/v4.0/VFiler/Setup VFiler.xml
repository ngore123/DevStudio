<process draft="false" dev-studio-version="7.6.01.02">
  <process-def name=":AO-AD-NetAPP_Storage:v4.0:VFiler:Setup VFiler">
    <parameters>
      <input global="false" required="false">
        <description>The name of the adapter. Default Name: NetAppActor</description>
        <from>adapter name</from>
        <to>adapter name</to>
      </input>
      <input global="false" required="true">
        <description>Configure and setup a vFiler based on a specified vFiler template. Depending on the input a CIFS setup will also be done on the vFiler.

Sample Items XML:

&lt;items&gt;
	&lt;item&gt;
		&lt;targets&gt;
			&lt;target&gt;
				&lt;host&gt;10.10.10.10&lt;/host&gt;
				&lt;user-name&gt;userName&lt;/user-name&gt;
				&lt;password&gt;password&lt;/password&gt;
				&lt;protocol&gt;http&lt;/protocol&gt;
				&lt;port&gt;8088&lt;/port&gt;                                
			&lt;/target&gt;
		&lt;/targets&gt;
		&lt;target&gt;server1&lt;/target&gt;
		&lt;vfiler-name-or-id&gt;testfiler&lt;/vfiler-name-or-id&gt;
	 	&lt;allowed-protocols&gt;
			&lt;protocol&gt;nfs&lt;/protocol&gt;
			&lt;protocol&gt;iscsi&lt;/protocol&gt;
			&lt;protocol&gt;cifs&lt;/protocol&gt;
		&lt;/allowed-protocols&gt;
		&lt;cifs-domain-password&gt;root@123&lt;/cifs-domain-password&gt;
		&lt;cifs-domain-user&gt;root&lt;/cifs-domain-user&gt;
		&lt;cifs-workgroup-name&gt;WORKGROUP&lt;/cifs-workgroup-name&gt;
		&lt;ip-bindings&gt;
			&lt;ip-binding-info&gt;
				&lt;interface&gt;ns0&lt;/interface&gt;
				&lt;ip-address&gt;12.12.12.12&lt;/ip-address&gt;
				&lt;mtu-size&gt;10&lt;/mtu-size&gt;
				&lt;netmask&gt;255.255.255.0&lt;/netmask&gt;
				&lt;partner-interface&gt;ns1&lt;/partner-interface&gt;
				&lt;prefix-length&gt;10&lt;/prefix-length&gt;
				&lt;vlan-identifier&gt;49&lt;/vlan-identifier&gt;
			&lt;/ip-binding-info&gt;	
		&lt;/ip-bindings&gt;
		&lt;root-password&gt;root@123&lt;/root-password&gt;
		&lt;run-cifs-setup&gt;true&lt;/run-cifs-setup&gt;
          &lt;script-path&gt;&lt;/script-path&gt;
		&lt;vfiler-template-name-or-id&gt;test&lt;/vfiler-template-name-or-id&gt;
	&lt;/item&gt;
&lt;/items&gt;

Parameters Description

targets [Conditional] 

        It is parent XML element for &lt;target&gt; XML element. 
        The &lt;target&gt; XML element is used to specify dynamic targets at request level. 
        Note: The &lt;targets&gt; XML element is required if the adapter configuration is empty in Grid Manager. 

target [Conditional] 
        It is child XML element of &lt;targets&gt; XML element. This element is used to specify dynamic targets at request level. 

        Using dynamic targets you can define connection information for a remote host within an adapter request. This allows you to configure an adapter in Grid Manager, by specifying configuration information in an adapter request. 

        Note: (1) Adapter configuration specified using request level dynamic targets takes precedence over Grid Manager level configuration information. (2) If request level dynamic target is specified using &lt;targets&gt; XML element, then the &lt;target&gt; element which is child of &lt;item&gt; element is ignored. (3) This element is required if &lt;targets&gt; XML element is present in the adapter request. 

host [Conditional] 
Host name or IP address of server on which NetApp DataFabric Manager is running. 
Note: This element is required if &lt;targets&gt; XML element is present in the adapter request. 

user-name [Conditional] 
NetApp DataFabric Manager login username. 
Note: This element is required if &lt;targets&gt; XML element is present in the adapter request. 

password [Conditional] 
NetApp DataFabric Manager login password. 

You can encrypt the password by specifying the encryption type attribute. 
For example: &lt;password encryption-type = "Base64"&gt;cGFzc3dvcmQ=&lt;/password&gt;. 
Note: This element is required if &lt;targets&gt; XML element is present in the adapter request. 

protocol [Optional] 
Communication protocol used by adapter. Valid value is http or https. Default value is http. 

port [Optional] 
Port on which NetApp DataFabric Manager is enabled. Default value is 8088 for http protocol and 8488 for https protocol. 

target [Optional] 
It is child XML element of &lt;item&gt; XML element. 
You can use this element to specify the connection information for a DFM Server. For this a comma separated list of configuration names can be specified. This executes the request simultaneously on all DFM servers identified by the configuration names. 
Valid values: 
1. The values specified for &lt;target&gt; XML element must be same as the values that have been specified for the name attribute of &lt;config&gt; element in Grid Manager adapter configuration. 
2. You can provide "ALL" as the value. In this case the request will get executed on all the DFM servers defined in Grid Manager adapter configuration. 
3. You can specify multiple comma separated names to allow simultaneous execution of requests across multiple DFM servers. 
4. You can skip this element. In that case the request will be executed on the first defined Grid Manager adapter configuration. 
You can leave this element empty. In that case the request will be executed on the first defined Grid Manager adapter configuration. 

Note: This element is ignored if request level dynamic target is specified using &lt;targets&gt; XML element.


allowed-protocols[Optional]
	List of protocols that needs to be allowed access to the vFiler. This list overrides the list of protocols currently allowed on the vFiler. If this is not present, no changes are done to the allowed protocols of the vFiler.

protocol[Optional]
	Name of the protocol. This tag is required if the list of allowed protocols is being provided in the allowed-protocols tag. Possible values: "nfs", "cifs", "iscsi".

cifs-domain-password[Optional]
	Password for cifs-domain-user. Encrypted using 2-way encryption. Applicable and mandatory if cifs-auth-type is set to "active_directory" in vfiler template specified in vfiler-template-name-or-id. Default value is empty.

cifs-domain-user	[Optional]
	Name of CIFS domain user that has the ability to add the CIFS server to the domain given in cifs-domain-name in vfiler template specified in vfiler-template-name-or-id. Examples: username (assumes domain-name is the user's domain), cifsdomain\username, cifs.domain.com\username. Applicable and mandatory if cifs-auth-type is set to "active_directory" in vfiler template specified in vfiler-template-name-or-id. Default value is empty.

cifs-workgroup-name[Optional]
	CIFS workgroup name of the new vfiler. If vfiler-template-name-or-id is specified, this field is applicable only if cifs-auth-type is "workgroup" in the specified vfiler-template. This field is also applicable when vfiler-template-name-or-id is not given, but cifs setup needs to be done on the vFiler. Default value is "WORKGROUP" and this will be used during CIFS setup of the vFiler if run-cifs-setup is true.

ip-bindings[Optional]
	IP Address to interface binding information. Multiple entries can be made under this tag in individual ip-binding-info tags.

ip-binding-info[Optional]
	This is used to specify a vFiler IP Address to interface binding information.

interface[Conditional]
	This is required if a IP binding is being specified. This is the Name or identifier of the interface to bind the vFiler IP Address to. This can be either a physical interface, VIF or a VLAN. 
Example: "e0a", "myvif", "service_vlan"

ip-address[Conditional]
	This is required if a IP binding is being specified. This is the IP address of the vFiler which is bound to the interface. If this IP Address is not already added to the vFiler, then the IP Address is first added to the vFiler before binding the IP Address with the given interface

mtu-size[Optional]	
	MTU size of the new VLAN interface. This element should be present only if a new VLAN interface is being created during vFiler setup. Also the version of Data ONTAP on the storage system on which the vFiler is being setup, should be 7.3.3 or later. Range: [296..9196]

netmask[Optional]
	Netmask for the IP address in dotted decimal notation. For IPv4 address, either netmask or prefix-length can be supplied. For IPv6 address, netmask is ignored.

partner-interface[Optional]	
	Name or identifier of the interface on the partner node. This element is valid when the storage system on which this vFiler unit is present is in a Active/Active configuration. If a new VLAN is getting created on the local node, then a new corresponding VLAN will also be created on the partner node on this interface.

prefix-length	[Optional]
	Prefix length for the IP address. This is required if IPv6 address is supplied. For IPv4 address, either netmask or prefix-length can be supplied. Range: [1..127]

vlan-identifier[Optional]	
	Identifier for creating a new VLAN interface. If this element is present, the interface element should refer to a physical VLAN tagged interface. Range: [1..4094]

root-password[Optional]
	Root password of the new vFiler. This will be the password for a new root account that will be created on the vFiler. If a root account already exists on this vFiler, then the password for the root account will not be changed. Encrypted using 2-way encryption. Length: [0..64] Default value is empty. Ignored if ip-bindings element is not present.

run-cifs-setup[Optional]
	This is a boolean (true or false) field that indicates whether CIFS setup should be performed on the vFiler unit. Note that if this is true and CIFS is already running on the vFiler unit, CIFS service will be stopped, and then a setup will be performed. Default value is FALSE.

script-path[Optional]
	Path to a script that will be run in pre setup and post setup mode when setting up the vFiler unit.

vfiler-name-or-id[Required]
	Full name or identifier of the vFiler to be setup.

vfiler-template-name-or-id[Optional]
	Name or identifier of vFiler template. The vFiler is setup based on the settings specified in the template. If this is not specified, then DNS, NIS servers cannot be configured for the vFiler. Also, a CIFS setup cannot be done using active_directory. Ignored if ip-bindings element is not present and run-cifs-setup is false.</description>
        <from>items</from>
        <to>items</to>
      </input>
      <output global="false" required="false">
        <to>adapter response</to>
        <from>adapter response</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <assign>
        <assignment>
          <output>
            <to>operation name</to>
            <value>setup-vfiler</value>
          </output>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <location>:assign[1]</location>
      </assign>
      <call-process>
        <process-name>:AO-AD-NetAPP_Storage:Utilities:Invoke Adapter Request</process-name>
        <parameters>
          <input>
            <from>adapter name</from>
            <to>adapter name</to>
          </input>
          <input>
            <from>items</from>
            <to>items</to>
          </input>
          <input>
            <from>operation name</from>
            <to>operation name</to>
          </input>
          <output>
            <from>adapter response</from>
            <to>adapter response</to>
          </output>
        </parameters>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>false</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <after-execution>
          <console-output>
            <type>INFO</type>
            <summary>
              <concat>
                <input>
                  <value></value>
                </input>
              </concat>
            </summary>
            <detail>
              <concat>
                <input>
                  <value></value>
                </input>
              </concat>
            </detail>
          </console-output>
        </after-execution>
        <location>:call-process[1]</location>
      </call-process>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>Configure and setup a vFiler based on a specified vFiler template. Depending on the input a CIFS setup will also be done on the vFiler.</description>
        <version></version>
      </documentation>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>3c3582ea-a7a6-334a-a778-91b7aa09729b</process-id>
      <author />
      <category />
      <status />
      <keywords />
      <systems />
      <last-modified-by />
      <last-modified>1290598221016</last-modified>
    </meta>
  </process-def>
</process>