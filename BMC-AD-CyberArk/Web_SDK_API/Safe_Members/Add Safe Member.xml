<process draft="false" dev-studio-version="8.2.00">
  <process-def name=":BMC-AD-CyberArk:Web_SDK_API:Safe_Members:Add Safe Member">
    <parameters>
      <input global="false" required="false">
        <description>adapter name    [Optional]
            The name of the adapter to use to handle the request. 

Default value: CyberArkActorAdapter</description>
        <from>adapter name</from>
        <to>adapter name</to>
      </input>
      <input global="false" required="true">
        <description>The token that identifies the session. A session token that was returned from the “Logon” method.
</description>
        <from>authorization token</from>
        <to>authorization token</to>
      </input>
      <input global="false" required="true">
        <description>The name of the Safe to add a member to.</description>
        <from>safe name</from>
        <to>safe name</to>
      </input>
      <input global="false" required="true">
        <description>Body parameters in JSON format to provide the member details to be added to the safe.

Below is the Sample Body parameters of member in JSON format 
----------------------------------------------
{
  "member":{
    "MemberName":"&lt;The name of the user to add as a Safe member&gt;",
    "SearchIn":"&lt;Search for the member in the Vault or Domain&gt;",
    "MembershipExpirationDate":"&lt;MM\DD\YY or empty if there is no expiration date&gt;",
    "Permissions":&lt;User’s permissions in the Safe&gt;
     [
       {"Key":"UseAccounts", "Value":&lt;true/false&gt;},
       {"Key":"RetrieveAccounts", "Value":&lt;true/false&gt;},
       {"Key":"ListAccounts", "Value":&lt;true/false&gt;},
       {"Key":"AddAccounts", "Value":&lt;true/false&gt;},
       {"Key":"UpdateAccountContent", "Value":&lt;true/false&gt;},
       {"Key":"UpdateAccountProperties", "Value":&lt;true/false&gt;},
       {"Key":"InitiateCPMAccountManagementOperations", "Value":&lt;true/false&gt;},
       {"Key":"SpecifyNextAccountContent", "Value":&lt;true/false&gt;},
       {"Key":"RenameAccounts", "Value":&lt;true/false&gt;},
       {"Key":"DeleteAccounts", "Value":&lt;true/false&gt;},
       {"Key":"UnlockAccounts", "Value":&lt;true/false&gt;},
       {"Key":"ManageSafe", "Value":&lt;true/false&gt;},
       {"Key":"ManageSafeMembers", "Value":&lt;true/false&gt;},
       {"Key":"BackupSafe", "Value":&lt;true/false&gt;},
       {"Key":"ViewAuditLog", "Value":&lt;true/false&gt;},
       {"Key":"ViewSafeMembers", "Value":&lt;true/false&gt;},
       {"Key":"RequestsAuthorizationLevel", "Value":&lt;0/1/2&gt;},
       {"Key":"AccessWithoutConfirmation", "Value":&lt;true/false&gt;},
       {"Key":"CreateFolders", "Value":&lt;true/false&gt;},
       {"Key":"DeleteFolders", "Value":&lt;true/false&gt;},
       {"Key":"MoveAccountsAndFolders", "Value":&lt;true/false&gt;}
     ]
  }
----------------------------------------------

-------------------------JSON Input Parameters Description-------------------------
1. Parameter: MemberName (mandatory)
   Description: Vault or Domain user or group to add as a Safe member.Note: The MemberName must not contain '&amp;' (ampersand).
   Valid Values: Vault or domain user

2. Parameter: SearchIn
   Description: The Vault or Domain to search for the user or group to add as a Safe member.
   Valid Values: Vault or the domains that are defined in the Vault
   Default value: Vault


3. Parameter: MembershipExpirationDate
   Description: Defines when the member’s Safe membership expires. Specify "" for no expiration date.
   Valid values: Date format MM/DD/YY
   Default : no expiration

4. Parameter:Permissions
   Type: Key/Value list
   Description: Safe member’s permissions in the Safe.
   Valid values: Permissions specified in the following table

Permissions [Array]

1.Parameter:UseAccounts
  Type: Boolean
  Description: Use accounts but not view passwords.
  Valid values: true/false


2. Parameter: RetrieveAccounts
   Type: Boolean
   Description: Retrieve and view accounts in the Safe.
   Valid values: true/false

3. Parameter: ListAccounts
   Type: Boolean
   Description: View accounts list.
   Valid values: true/false


4. Parameter: AddAccounts
   Type: Boolean
   Description: Add accounts in the Safe. Users who are given AddAccounts authorization receive UpdateAccountProperties as well. Users who have this permission automatically have UpdateAccountProperties as well.
   Valid values: true/false

5. Parameter: UpdateAccountContent
   Type: Boolean
   Description: Update existing account content.
   Valid values: true/false

6. Parameter: UpdateAccountProperties
   Type: Boolean
   Description: Update existing account properties.
   Valid values: true/false

7. Parameter: InitiateCPMAccountManagementOperations
   Type: Boolean
   Description: Initiate password management operations through CPM, such as changing passwords, verifying and reconciling passwords. When this parameter is set to false, the SpecifyNextAccountContent is automatically set to false.
   Valid values: true/false

8. Parameter: SpecifyNextAccountContent
   Type: Boolean
   Description: Specify the password that will be used when the CPM changes the password value. This parameter can only be specified when InitiateCPMAccountManagementOperations is set to true.When InitiateCPMAccountManagementOperations is set to false this parameter is automatically set to false.
   Valid values: true/false

9. Parameter: RenameAccounts
   Type: Boolean
   Description: Rename existing accounts in the Safe.
   Valid values: true/false

10. Parameter: DeleteAccounts
    Type: Boolean
    Description: Delete existing passwords in the Safe.
    Valid values: true/false

11. Parameter: UnlockAccounts
    Type: Boolean
    Description: Unlock accounts that are locked by other users.
    Valid values: true/false

12. Parameter: ManageSafe
    Type: Boolean
    Description: Perform administrative tasks in the Safe, including:
    .Update Safe properties
    .Recover the Safe
    .Delete the Safe

    Valid values: true/false

13. Parameter: ManageSafe Members
    Type: Boolean
    Description: Add and remove Safe members, and update their authorizations in the Safe.
    Valid values: true/false

14. Parameter: BackupSafe
    Type: Boolean
    Description: Create a backup of a Safe and its contents, and store in another location.
    Valid values: true/false

15. Parameter: ViewAuditLog
    Type: Boolean
    Description: View account and user activity in the Safe.
    Valid values: true/false

16. Parameter: ViewSafeMembers
    Type: Boolean
    Description: View Safe members` permissions.
    Valid values: true/false

17. Parameter: RequestsAuthorizationLevel
    Type: Numeric
    Description: Requests Authorization Level.

    0 – cannot authorize
    1 – authorization level 1
    2 – authorization level 2

    Valid values: 0/1/2

18. Parameter: AccessWithoutConfirmation
    Type: Boolean
    Description: Access the Safe without confirmation from authorized users. This overrides the Safe properties that specify that Safe members require confirmation to access the Safe.
    Valid values: true/false

19. Parameter: CreateFolders
    Type: Boolean
    Description: Create folders in the Safe.
    Valid values: true/false

20. Parameter: DeleteFolders
    Type: Boolean
    Description: Delete folders from the Safe.
    Valid values: true/false

21. Parameter: MoveAccountsAndFolders
    Type: Boolean
    Description: Move accounts and folders in the Safe to different folders and subfolders.
    Valid values: true/false
----------------------------------------------
Example body parameters JSON input:

{
	"member": {
		"MemberName":"BMC_TrueSightOrchestration",
		"SearchIn":"Vault",
		
		"Permissions":
		[
			{"Key":"UseAccounts", "Value":true},
			{"Key":"RetrieveAccounts", "Value":true},
			{"Key":"ListAccounts", "Value":true},
			{"Key":"AddAccounts", "Value":false},
			{"Key":"UpdateAccountContent", "Value":false},
			{"Key":"UpdateAccountProperties", "Value":false},
			{"Key":"InitiateCPMAccountManagementOperations", "Value":false},
			{"Key":"SpecifyNextAccountContent", "Value":false},
			{"Key":"RenameAccounts", "Value":false},
			{"Key":"DeleteAccounts", "Value":false},
			{"Key":"UnlockAccounts", "Value":false},
			{"Key":"ManageSafe", "Value":false},
			{"Key":"ManageSafeMembers", "Value":false},
			{"Key":"BackupSafe", "Value":false},
			{"Key":"ViewAuditLog", "Value":true},
			{"Key":"ViewSafeMembers", "Value":true},
			{"Key":"RequestsAuthorizationLevel", "Value":0},
			{"Key":"AccessWithoutConfirmation", "Value":true},
			{"Key":"CreateFolders", "Value":false},
			{"Key":"DeleteFolders", "Value":false},
			{"Key":"MoveAccountsAndFolders", "Value":false}
		]
	}
}</description>
        <from>body parameters</from>
        <to>body parameters</to>
      </input>
      <input global="false" required="false">
        <description>Option to return the response in message body in XML or JSON in output context. If no input is provided, it is assumed to XML.

Default Value: XML

Please note: If JSON provided then headers in adapter response will also be converted into JSON and assigned in output context.

Please note: This parameter is not part of adapter request XML, this parameter is only used to process adapter response in given format.
</description>
        <from>return data format</from>
        <to>return data format</to>
      </input>
      <output global="false" required="false">
        <description>Status represents whether request executed successfully on server
Valid values:

success
error</description>
        <to>status</to>
        <from>status</from>
      </output>
      <output global="false" required="false">
        <description>Body in response</description>
        <to>response body</to>
        <from>response body</from>
      </output>
      <output global="false" required="false">
        <description>response code</description>
        <to>status code</to>
        <from>status code</from>
      </output>
      <output global="false" required="false">
        <description>Response header values
</description>
        <to>response headers</to>
        <from>response headers</from>
      </output>
      <output global="false" required="false">
        <description>Error message in case of status error</description>
        <to>error message</to>
        <from>error message</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <assign>
        <assignment>
          <document>
            <input>
              <from>authorization token</from>
            </input>
          </document>
          <result>
            <output>
              <to>request</to>
            </output>
          </result>
          <xslt-stylesheet>
            <stylesheet-replacement-tokens>
              <replacement-token name="body parameters">
                <input global="false">
                  <from>body parameters</from>
                </input>
              </replacement-token>
              <replacement-token name="safe name">
                <input global="false">
                  <from>safe name</from>
                </input>
              </replacement-token>
            </stylesheet-replacement-tokens>
            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="yes" />
  <xsl:template match="/">
    <request>
      <authorization-token>
        <xsl:value-of select="." disable-output-escaping="no" />
      </authorization-token>
      <safe-name>$[safe name]</safe-name>
      <body-parameters>$[body parameters]</body-parameters>
    </request>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
          </xslt-stylesheet>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <after-execution>
          <log>
            <level>debug</level>
            <parameters>
              <input>
                <value>Formed Request</value>
              </input>
              <input>
                <from>request</from>
              </input>
            </parameters>
          </log>
        </after-execution>
        <location>:assign[1]</location>
      </assign>
      <call-process>
        <process-name>:BMC-AD-CyberArk:Utilities:Create And Execute Adapter Request</process-name>
        <parameters>
          <input>
            <from>adapter name</from>
            <to>adapter name</to>
          </input>
          <input>
            <value>cyberark-websdk-safemembers-add-member</value>
            <to>operation name</to>
          </input>
          <input>
            <from>request</from>
            <to>request</to>
          </input>
          <input>
            <from>return data format</from>
            <to>return data format</to>
          </input>
          <output>
            <from>adapter response</from>
            <to>adapter response</to>
          </output>
          <output>
            <from>return data format</from>
            <to>return data format</to>
          </output>
        </parameters>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>false</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <after-execution>
          <log>
            <level>debug</level>
            <parameters>
              <input>
                <value>------------------Adapter Response----------------</value>
              </input>
              <input>
                <from>adapter response</from>
              </input>
            </parameters>
          </log>
        </after-execution>
        <location>:call-process[1]</location>
      </call-process>
      <call-process>
        <process-name>:AutoPilot-OA-Common_Utilities:BAO_Utilities:REST:Process Response</process-name>
        <parameters>
          <input>
            <from>adapter response</from>
            <to>adapter response</to>
          </input>
          <input>
            <from>return data format</from>
            <to>return data format</to>
          </input>
          <output>
            <from>response headers</from>
            <to>response headers</to>
          </output>
          <output>
            <from>response body</from>
            <to>response body</to>
          </output>
          <output>
            <from>status</from>
            <to>status</to>
          </output>
          <output>
            <from>status code</from>
            <to>status code</to>
          </output>
          <output>
            <from>error message</from>
            <to>error message</to>
          </output>
        </parameters>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>false</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <location>:call-process[2]</location>
      </call-process>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
        <consumer>OCP</consumer>
        <consumer>SOAP</consumer>
      </expose-to>
      <documentation>
        <description>This operation adds an existing user as a Safe member.

The user who runs this web service requires Manage Safe Members permissions in the Vault.</description>
        <version></version>
      </documentation>
      <logging-options>
        <is-enabled>false</is-enabled>
        <log-file-name></log-file-name>
      </logging-options>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>283a42a5-e009-4db8-b7b9-ef97f3157c0d</process-id>
      <author>dbhola</author>
      <category></category>
      <status></status>
      <keywords></keywords>
      <systems></systems>
      <last-modified-by>aoadmin</last-modified-by>
      <last-modified>1573750825856</last-modified>
    </meta>
  </process-def>
</process>