<process draft="false" dev-studio-version="8.2.00">
  <process-def name=":BMC-AD-CyberArk:Utilities:Is Secure Context">
    <parameters>
      <input global="false" required="false">
        <description>the input data on which need to be verified whether secure context encrpted data is present or not.</description>
        <from>input</from>
        <to>secure context input</to>
      </input>
      <output global="false" required="false">
        <description>flags whether the input is secure</description>
        <to>is secure context</to>
        <from>secure context exist</from>
      </output>
      <output global="false" required="false">
        <description>flags whether input is having any data or not, this is not mandatory to use and this is just for additional check if user want to check whether any input provided or not</description>
        <to>is empty input</to>
        <from>input empty flag</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <assign>
        <assignment>
          <document>
            <input>
              <from>secure context input</from>
            </input>
          </document>
          <result>
            <output>
              <to>input empty flag</to>
            </output>
          </result>
          <xslt-stylesheet>
            <stylesheet-replacement-tokens>
              <replacement-token name="secure input">
                <input global="false">
                  <from>secure context input</from>
                </input>
              </replacement-token>
            </stylesheet-replacement-tokens>
            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <check-input-is-empty>
      <xsl:choose>
        <xsl:when test="string-length(//EncryptedData/CipherData/CipherValue/text()) != 0">
          <xsl:text disable-output-escaping="no">false</xsl:text>
        </xsl:when>
        <xsl:otherwise>
          <xsl:choose>
            <xsl:when test="string-length(.) != 0">
              <xsl:text disable-output-escaping="no">false</xsl:text>
            </xsl:when>
            <xsl:otherwise>
              <xsl:text disable-output-escaping="no">true</xsl:text>
            </xsl:otherwise>
          </xsl:choose>
        </xsl:otherwise>
      </xsl:choose>
    </check-input-is-empty>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
          </xslt-stylesheet>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <after-execution>
          <log>
            <level>debug</level>
            <parameters>
              <input>
                <value>Secure context input empty flag</value>
              </input>
              <input>
                <from>input empty flag</from>
              </input>
            </parameters>
          </log>
        </after-execution>
        <location>:assign[1]</location>
      </assign>
      <switch>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <execute-all-applicable-cases>false</execute-all-applicable-cases>
        <default>
          <sequence>
            <assign>
              <assignment>
                <output>
                  <to>input empty flag</to>
                  <value>true</value>
                </output>
              </assignment>
              <assignment>
                <output>
                  <to>secure context exist</to>
                  <value>false</value>
                </output>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <after-execution>
                <log>
                  <level>debug</level>
                  <parameters>
                    <input>
                      <value>Input is empty</value>
                    </input>
                    <input>
                      <from>input empty flag</from>
                    </input>
                  </parameters>
                </log>
              </after-execution>
              <location>:switch[1]:sequence[1]:assign[1]</location>
            </assign>
          </sequence>
        </default>
        <case>
          <condition>
            <document>
              <input>
                <from>input empty flag</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[//check-input-is-empty/text()  =  "false"]]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <assign>
              <assignment>
                <document>
                  <input>
                    <from>secure context input</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>secure context output</to>
                  </output>
                </result>
                <xslt-stylesheet>
                  <stylesheet-replacement-tokens>
                    <replacement-token name="input">
                      <input global="false">
                        <from>secure context input</from>
                      </input>
                    </replacement-token>
                  </stylesheet-replacement-tokens>
                  <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <password-holder>
      <xsl:text disable-output-escaping="no">&lt;![CDATA[$[input]]]&gt;</xsl:text>
    </password-holder>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                </xslt-stylesheet>
              </assignment>
              <assignment>
                <output>
                  <to>secure context exist</to>
                  <value>true</value>
                </output>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:assign[1]</location>
            </assign>
            <switch>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>true</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <execute-all-applicable-cases>false</execute-all-applicable-cases>
              <default>
                <sequence />
              </default>
              <case>
                <condition>
                  <document>
                    <input>
                      <from>secure context output</from>
                    </input>
                  </document>
                  <xpath-expression>
                    <xpath-replacement-tokens />
                    <xpath><![CDATA[not(contains(., 'EncryptedData'))  and  not(contains(., 'CipherData'))]]></xpath>
                  </xpath-expression>
                </condition>
                <sequence>
                  <assign>
                    <assignment>
                      <output>
                        <to>secure context exist</to>
                        <value>false</value>
                      </output>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <after-execution>
                      <log>
                        <level>debug</level>
                        <parameters>
                          <input>
                            <value>Secure Context Exist?</value>
                          </input>
                          <input>
                            <from>secure context exist</from>
                          </input>
                        </parameters>
                      </log>
                    </after-execution>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:assign[1]</location>
                  </assign>
                </sequence>
              </case>
              <location>:switch[1]:sequence[2]:switch[1]</location>
            </switch>
          </sequence>
        </case>
        <location>:switch[1]</location>
      </switch>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>This process verify whether the input contains the secure context XML encrypted cipherdata data or not, and return true or false flag accordingly, this process specifically checks whether passwords input is secure or not.  </description>
        <version></version>
      </documentation>
      <logging-options>
        <is-enabled>false</is-enabled>
        <log-file-name></log-file-name>
      </logging-options>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>41d313a5-3d53-4114-b685-3d3e1b9a0476</process-id>
      <author>aoadmin</author>
      <category></category>
      <status></status>
      <keywords></keywords>
      <systems></systems>
      <last-modified-by>AoAdmin</last-modified-by>
      <last-modified>1569236115497</last-modified>
    </meta>
  </process-def>
</process>