<process draft="false" dev-studio-version="99.99.99-SNAPSHOT">
  <process-def name=":AutoPilot-OA-Credentials_Store:EventOrchestration:Get Connection Details">
    <parameters>
      <input global="false" required="true">
        <description>event related to whom connection details needs to be extracted. The event is in common event model format and the information is retrieved from the sourceData section. If this information is not sufficient, one may look into extended data section to determine the details. Event will be of the format:
&lt;event&gt;
  &lt;metaData&gt;
    &lt;eventClass&gt;PATROL_EV&lt;/eventClass&gt;
    &lt;eventId&gt;clm-aus-009801@10.17.78.30:3181.1522660102.62951&lt;/eventId&gt;
    &lt;reportTimeEpoch&gt;0&lt;/reportTimeEpoch&gt;
    &lt;eventToCIAssociationType&gt;IMPACTING&lt;/eventToCIAssociationType&gt;
    &lt;notes&gt;[0x5ac1f345, im_internal.mrl:refine dden_policy_rule, DDEN policy: ServiceStatus_Enrichment matching: enrich-tag_8_1_2018_3_29_7:51:29AM in  enrich-tag_8]&lt;/notes&gt;
    &lt;propagationHistory&gt;[bao1:15014]&lt;/propagationHistory&gt;
  &lt;/metaData&gt;
  &lt;sourceData&gt;
    &lt;componentHost&gt;clm-aus-009801.bmc.com&lt;/componentHost&gt;
    &lt;componentHostAddress&gt;10.17.78.30&lt;/componentHostAddress&gt;
    &lt;location&gt;bmc.com&lt;/location&gt;
    &lt;componentCaption&gt;SERVICES_AO-AMREPO&lt;/componentCaption&gt;
    &lt;componentType&gt;NT_SERVICES&lt;/componentType&gt;
  &lt;/sourceData&gt;
  &lt;situationData&gt;
    &lt;situationCategory&gt;AVAILABILITY_MANAGEMENT&lt;/situationCategory&gt;
    &lt;situationSubCategory&gt;APPLICATION&lt;/situationSubCategory&gt;
    &lt;situationTime&gt;1522660132&lt;/situationTime&gt;
    &lt;severity&gt;CRITICAL&lt;/severity&gt;
    &lt;situationTimeEpoch&gt;0&lt;/situationTimeEpoch&gt;
    &lt;service&gt;AO-AMREPO&lt;/service&gt;
    &lt;messageSummary&gt;ServiceStatus for NT_SERVICES/SERVICES_AO-AMREPO is in ALARM current value is 3.000000&lt;/messageSummary&gt;
  &lt;/situationData&gt;
  &lt;reporterData&gt;
    &lt;componentCaption&gt;clm-aus-009801:3181&lt;/componentCaption&gt;
    &lt;componentType&gt;PATROL Agent&lt;/componentType&gt;
    &lt;eventTime&gt;1522660132&lt;/eventTime&gt;
  &lt;/reporterData&gt;
  &lt;extendedData&gt;
    &lt;nameValueList&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;cell-name&lt;/name&gt;
        &lt;value type="xs:string"&gt;bao1&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;date&lt;/name&gt;
        &lt;value type="xs:string"&gt;20180402143852.000000+330&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-origin&lt;/name&gt;
        &lt;value type="xs:string"&gt;NT_SERVICES.SERVICES_AO-AMREPO.ServiceStatus&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;mc-origin-sev&lt;/name&gt;
        &lt;value type="xs:string"&gt;4&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;event-identification-type&lt;/name&gt;
        &lt;value type="xs:string"&gt;Internal&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-owner&lt;/name&gt;
        &lt;value type="xs:string"&gt;Patrol&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-class&lt;/name&gt;
        &lt;value type="xs:string"&gt;11&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;mc-modhist&lt;/name&gt;
        &lt;value type="xs:string"&gt;[bao1]&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-expectancy&lt;/name&gt;
        &lt;value type="xs:string"&gt;STORED&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-instance&lt;/name&gt;
        &lt;value type="xs:string"&gt;SERVICES_AO-AMREPO&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;mc-origin-key&lt;/name&gt;
        &lt;value type="xs:string"&gt;62951&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-source-id&lt;/name&gt;
        &lt;value type="xs:string"&gt;62951&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;date-reception&lt;/name&gt;
        &lt;value type="xs:string"&gt;1522660132&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-agent&lt;/name&gt;
        &lt;value type="xs:string"&gt;clm-aus-009801.bmc.com&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;mc-operations&lt;/name&gt;
        &lt;value type="xs:string"&gt;[0x5ac1f345, im_internal.mrl:refine dden_policy_rule, ServiceStatus_Enrichment, Dynamic Data Enrichment, ]&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-handler&lt;/name&gt;
        &lt;value type="xs:string"&gt;Patrol&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-agent-port&lt;/name&gt;
        &lt;value type="xs:string"&gt;3181&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-agent-version&lt;/name&gt;
        &lt;value type="xs:string"&gt;V11.0.00i&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-type&lt;/name&gt;
        &lt;value type="xs:string"&gt;ALARM&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;mc-local-reception-time&lt;/name&gt;
        &lt;value type="xs:string"&gt;1522660165&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;mc-origin-class&lt;/name&gt;
        &lt;value type="xs:string"&gt;PATROL Agent&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-args&lt;/name&gt;
        &lt;value type="xs:string"&gt;[Alarm #2, global, ServiceStatus, NT_SERVICES.SERVICES_AO-AMREPO, 3, 3.00, 3]&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-catalog&lt;/name&gt;
        &lt;value type="xs:string"&gt;0&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;itsm-company&lt;/name&gt;
        &lt;value type="xs:string"&gt;Calbro Services&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;mc-arrival-time&lt;/name&gt;
        &lt;value type="xs:string"&gt;1522660165&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-status&lt;/name&gt;
        &lt;value type="xs:string"&gt;OPEN&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-application&lt;/name&gt;
        &lt;value type="xs:string"&gt;AO-AMREPO&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;mc-origin&lt;/name&gt;
        &lt;value type="xs:string"&gt;clm-aus-009801:3181&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;itsm-incident-status&lt;/name&gt;
        &lt;value type="xs:string"&gt;Assigned&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;mc-date-modification&lt;/name&gt;
        &lt;value type="xs:string"&gt;1522660165&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;mc-host-class&lt;/name&gt;
        &lt;value type="xs:string"&gt;NT6.0 Service Pack 2&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-agent-address&lt;/name&gt;
        &lt;value type="xs:string"&gt;10.17.78.30&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;itsm-incident-id&lt;/name&gt;
        &lt;value type="xs:string"&gt;INC000000000128&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue type="nameValue"&gt;
        &lt;name&gt;p-node&lt;/name&gt;
        &lt;value type="xs:string"&gt;clm-aus-009801.bmc.com&lt;/value&gt;
      &lt;/nameValue&gt;
    &lt;/nameValueList&gt;
  &lt;/extendedData&gt;
  &lt;metricsData&gt;
    &lt;metricName&gt;ServiceStatus&lt;/metricName&gt;
    &lt;metricValue&gt;3.000000&lt;/metricValue&gt;
  &lt;/metricsData&gt;
&lt;/event&gt;</description>
        <from>event data</from>
        <to>event data</to>
      </input>
      <output global="false" required="false">
        <description>Connection details based on the connection details concept.

Sample:
&lt;connection-details&gt;
  &lt;adapter-name/&gt;
  &lt;hostname/&gt;
  &lt;username/&gt;
  &lt;password/&gt;
  &lt;invocation-mechanism/&gt;
&lt;/connection-details&gt;</description>
        <to>host connection details</to>
        <from>connection details</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <assign>
        <assignment>
          <document>
            <input>
              <from>event data</from>
            </input>
          </document>
          <result>
            <output>
              <to>event component type</to>
            </output>
          </result>
          <xpath-expression>
            <xpath-replacement-tokens />
            <xpath><![CDATA[//sourceData/componentType/text()]]></xpath>
          </xpath-expression>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <location>:assign[1]</location>
      </assign>
      <switch>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <execute-all-applicable-cases>false</execute-all-applicable-cases>
        <default>
          <sequence>
            <call-process>
              <process-name>:AutoPilot-OA-Credentials_Store:EventOrchestration:Get OS connection details</process-name>
              <parameters>
                <input>
                  <from>event data</from>
                  <to>event data</to>
                </input>
                <output>
                  <from>connection details</from>
                  <to>connection details</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[1]:call-process[1]</location>
            </call-process>
          </sequence>
        </default>
        <case>
          <condition>
            <document>
              <input>
                <from>event component type</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[string(.) = "KOE_INSTANCE" or string(.)  = "KOE_INST_LISTENER"]]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <console-output>
              <type>INFO</type>
            </console-output>
            <call-process>
              <process-name>:AutoPilot-OA-Credentials_Store:EventOrchestration:Get Database connection details</process-name>
              <parameters>
                <input>
                  <from>event data</from>
                  <to>event data</to>
                </input>
                <output>
                  <from>connection details</from>
                  <to>connection details</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:call-process[1]</location>
            </call-process>
          </sequence>
        </case>
        <case>
          <condition>
            <document>
              <input>
                <from>event component type</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[string(.) = "PROACTIVENET_COMPONENT"]]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <call-process>
              <process-name>:AutoPilot-OA-Credentials_Store:EventOrchestration:Get PatrolAgent connection details</process-name>
              <parameters>
                <input>
                  <from>event data</from>
                  <to>event data</to>
                </input>
                <output>
                  <from>connection details</from>
                  <to>connection details</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[3]:call-process[1]</location>
            </call-process>
          </sequence>
        </case>
        <case>
          <condition>
            <document>
              <input>
                <from>event component type</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[string(.) = "ARS_SERVER"]]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <call-process>
              <process-name>:AutoPilot-OA-Credentials_Store:EventOrchestration:Get Remedy connection details</process-name>
              <unique-id>fb5255c3-9b59-406a-ac8b-9ae24f20e4af</unique-id>
              <parameters>
                <input>
                  <from>event data</from>
                  <to>event data</to>
                </input>
                <output>
                  <from>connection details</from>
                  <to>connection details</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[4]:call-process[1]</location>
            </call-process>
          </sequence>
        </case>
        <location>:switch[1]</location>
      </switch>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>This workflows extracts the connection details of a given host based on the module configuration.</description>
        <version></version>
      </documentation>
      <logging-options>
        <is-enabled>false</is-enabled>
        <log-file-name></log-file-name>
      </logging-options>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>86688711-7cdd-4a90-a60e-0f4733d20148</process-id>
      <author>admin</author>
      <category></category>
      <status></status>
      <keywords></keywords>
      <systems></systems>
      <last-modified-by>aoadmin</last-modified-by>
      <last-modified>1575260834205</last-modified>
    </meta>
  </process-def>
</process>