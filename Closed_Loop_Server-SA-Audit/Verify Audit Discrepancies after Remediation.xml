<process draft="false" dev-studio-version="7.6.02.02">
  <process-def name=":Closed_Loop_Server-SA-Audit:Verify Audit Discrepancies after Remediation">
    <parameters>
      <input global="false" required="true">
        <description>inputevent: inputevent
This is the trap generated by the BladeLogic Operations Manager in response to a job completion.

&lt;trap&gt;
  &lt;host&gt;172.21.124.100&lt;/host&gt;
  &lt;sysuptime&gt;0&lt;/sysuptime&gt;
  &lt;enterprise&gt;.1.3.6.1.4.1.12788&lt;/enterprise&gt;
  &lt;generic-trap-type&gt;6&lt;/generic-trap-type&gt;
  &lt;specific-trap-type&gt;1001&lt;/specific-trap-type&gt;
  &lt;varbinds&gt;
    &lt;varbind&gt;
      &lt;oid&gt;.1.3.6.1.4.1.12788.1.1.1&lt;/oid&gt;
      &lt;value&gt;dummyComplianceJob_bldemo_1219464000000 @2008/08/22 16:08:07:703-0400&lt;/value&gt;
    &lt;/varbind&gt;
    &lt;varbind&gt;
      &lt;oid&gt;.1.3.6.1.4.1.12788.1.1.2&lt;/oid&gt;
      &lt;value&gt;Wed Aug 24 16:31:36 EDT 2008&lt;/value&gt;
    &lt;/varbind&gt;
    &lt;varbind&gt;
      &lt;oid&gt;.1.3.6.1.4.1.12788.1.1.3&lt;/oid&gt;
      &lt;value&gt;Wed Aug 24 16:32:10 EDT 2008&lt;/value&gt;
    &lt;/varbind&gt;
    &lt;varbind&gt;
      &lt;oid&gt;.1.3.6.1.4.1.12788.1.1.4&lt;/oid&gt;
      &lt;value&gt;0&lt;/value&gt;
    &lt;/varbind&gt;
    &lt;varbind&gt;
      &lt;oid&gt;.1.3.6.1.4.1.12788.1.1.5&lt;/oid&gt;
      &lt;value&gt;0&lt;/value&gt;
    &lt;/varbind&gt;
    &lt;varbind&gt;
      &lt;oid&gt;.1.3.6.1.4.1.12788.1.1.6&lt;/oid&gt;
      &lt;value&gt;4018123&lt;/value&gt;
    &lt;/varbind&gt;
    &lt;varbind&gt;
      &lt;oid&gt;.1.3.6.1.4.1.12788.1.1.7&lt;/oid&gt;
      &lt;value&gt;2038758&lt;/value&gt;
    &lt;/varbind&gt;
    &lt;varbind&gt;
      &lt;oid&gt;.1.3.6.1.4.1.12788.1.1.8&lt;/oid&gt;
      &lt;value&gt;30&lt;/value&gt;
    &lt;/varbind&gt;
  &lt;/varbinds&gt;
&lt;/trap&gt;</description>
        <from>inputevent</from>
        <to>inputevent</to>
      </input>
      <output global="false" required="false">
        <to>success status</to>
        <from>success status</from>
      </output>
      <output global="false" required="false">
        <to>status message</to>
        <from>status message</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <call-process>
        <process-name>:Closed_Loop_Server-SA-Audit:Utilities:Extract Configuration Data</process-name>
        <parameters>
          <input>
            <value>BLADELOGIC</value>
            <to>configuration name</to>
          </input>
          <output>
            <from>trap mappings</from>
            <to>trap mappings</to>
          </output>
          <output>
            <from>bl connection details</from>
            <to>bl connection details</to>
          </output>
          <output>
            <from>export path</from>
            <to>export path</to>
          </output>
          <output>
            <from>file connection details</from>
            <to>file connection details</to>
          </output>
          <output>
            <from>jobs</from>
            <to>jobs</to>
          </output>
          <output>
            <from>remediation job delimiter</from>
            <to>remediation job delimiter</to>
          </output>
          <output>
            <from>bl property remediation job change ticket name</from>
            <to>bl property remediation job change ticket name</to>
          </output>
          <output>
            <from>incident platform</from>
            <to>incident platform</to>
          </output>
          <output>
            <from>incident template name</from>
            <to>incident template name</to>
          </output>
          <output>
            <from>change platform</from>
            <to>change platform</to>
          </output>
          <output>
            <from>change template name</from>
            <to>change template name</to>
          </output>
          <output>
            <from>task platform</from>
            <to>task platform</to>
          </output>
          <output>
            <from>authentication enable</from>
            <to>authentication enable</to>
          </output>
          <output>
            <from>authentication platform</from>
            <to>authentication platform</to>
          </output>
          <output>
            <from>authentication schema</from>
            <to>authentication schema</to>
          </output>
          <output>
            <from>authentication version</from>
            <to>authentication version</to>
          </output>
          <output>
            <from>authentication adapter</from>
            <to>authentication adapter</to>
          </output>
          <output>
            <from>authentication query mappings</from>
            <to>authentication query mappings</to>
          </output>
          <output>
            <from>authentication username</from>
            <to>authentication username</to>
          </output>
          <output>
            <from>success status</from>
            <to>success status</to>
          </output>
          <output>
            <from>status message</from>
            <to>status message</to>
          </output>
          <output>
            <from>configuration name</from>
            <to>configuration name</to>
          </output>
          <output>
            <from>incident default status</from>
            <to>incident default status</to>
          </output>
          <output>
            <from>incident default service type</from>
            <to>incident default service type</to>
          </output>
          <output>
            <from>incident default impact</from>
            <to>incident default impact</to>
          </output>
          <output>
            <from>incident default urgency</from>
            <to>incident default urgency</to>
          </output>
          <output>
            <from>change default status</from>
            <to>change default status</to>
          </output>
          <output>
            <from>change default change type</from>
            <to>change default change type</to>
          </output>
          <output>
            <from>change default impact</from>
            <to>change default impact</to>
          </output>
          <output>
            <from>change default urgency</from>
            <to>change default urgency</to>
          </output>
          <output>
            <from>change default risk level</from>
            <to>change default risk level</to>
          </output>
          <output>
            <from>change default timing</from>
            <to>change default timing</to>
          </output>
          <output>
            <from>incident default status reason</from>
            <to>incident default status reason</to>
          </output>
          <output>
            <from>incident default reported source</from>
            <to>incident default reported source</to>
          </output>
          <output>
            <from>configuration enable</from>
            <to>configuration enable</to>
          </output>
          <output>
            <from>configuration platform</from>
            <to>configuration platform</to>
          </output>
          <output>
            <from>package group name</from>
            <to>package group name</to>
          </output>
          <output>
            <from>bSoftLinked</from>
            <to>bSoftLinked</to>
          </output>
          <output>
            <from>bCollectFileAttributes</from>
            <to>bCollectFileAttributes</to>
          </output>
          <output>
            <from>bCopyFileContents</from>
            <to>bCopyFileContents</to>
          </output>
          <output>
            <from>bCollectRegistryAcl</from>
            <to>bCollectRegistryAcl</to>
          </output>
          <output>
            <from>isSimulateEnabled</from>
            <to>isSimulateEnabled</to>
          </output>
          <output>
            <from>isCommitEnabled</from>
            <to>isCommitEnabled</to>
          </output>
          <output>
            <from>isStagedIndirect</from>
            <to>isStagedIndirect</to>
          </output>
          <output>
            <from>remediation job group</from>
            <to>remediation job group</to>
          </output>
          <output>
            <from>snmp target</from>
            <to>snmp target</to>
          </output>
          <output>
            <from>change date format</from>
            <to>change date format</to>
          </output>
          <output>
            <from>destination verify job group</from>
            <to>destination verify job group</to>
          </output>
          <output>
            <from>bl version</from>
            <to>bl version</to>
          </output>
          <output>
            <from>blcli tunnelling</from>
            <to>blcli tunnelling</to>
          </output>
          <output>
            <from>bl connection details instance 2</from>
            <to>bl connection details instance 2</to>
          </output>
        </parameters>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>false</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <after-execution>
          <console-output>
            <type>INFO</type>
            <summary>
              <concat>
                <input>
                  <value></value>
                </input>
              </concat>
            </summary>
            <detail>
              <concat>
                <input>
                  <value></value>
                </input>
              </concat>
            </detail>
          </console-output>
        </after-execution>
        <location>:call-process[1]</location>
      </call-process>
      <call-process>
        <process-name>:Closed_Loop_Server-SA-Audit:Utilities:Receive Blade Logic Trap</process-name>
        <parameters>
          <input>
            <from>inputevent</from>
            <to>inputevent</to>
          </input>
          <input>
            <from>trap mappings</from>
            <to>trap mappings</to>
          </input>
          <output>
            <from>blade logic alert</from>
            <to>bladelogic alert</to>
          </output>
          <output>
            <from>success</from>
            <to>success status</to>
          </output>
        </parameters>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>false</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <location>:call-process[2]</location>
      </call-process>
      <call-process>
        <process-name>:BMC_BladeLogic-AD-Operations_Manager:v7.42:Job:Get Fully Resolved Property Value</process-name>
        <parameters>
          <input>
            <from>bl connection details</from>
            <to>connection details</to>
          </input>
          <input>
            <from>bladelogic alert</from>
            <to>jobTypeString</to>
            <xslt-stylesheet>
              <stylesheet-replacement-tokens />
              <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:choose>
        <xsl:when test="//jc-type-id/text()='30'">
          <xsl:text disable-output-escaping="no">DEPLOY_JOB</xsl:text>
        </xsl:when>
        <xsl:when test="//jc-type-id/text()='200'">
          <xsl:text disable-output-escaping="no">BATCH_JOB</xsl:text>
        </xsl:when>
      </xsl:choose>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
            </xslt-stylesheet>
          </input>
          <input>
            <from>remediation job group</from>
            <to>jobGroupName</to>
          </input>
          <input>
            <from>bladelogic alert</from>
            <to>jobName</to>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[//jc-job-name/text()]]></xpath>
            </xpath-expression>
          </input>
          <input>
            <from>bl property remediation job change ticket name</from>
            <to>propertyName</to>
          </input>
          <output>
            <from>status</from>
            <to>success status</to>
          </output>
          <output>
            <from>error message</from>
            <to>status message</to>
          </output>
          <output>
            <from>propertyValue</from>
            <to>property value</to>
          </output>
        </parameters>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>false</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <location>:call-process[3]</location>
      </call-process>
      <switch>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <execute-all-applicable-cases>false</execute-all-applicable-cases>
        <default>
          <sequence>
            <assign>
              <assignment>
                <document>
                  <input>
                    <from>success status</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>status message</to>
                  </output>
                </result>
                <xslt-stylesheet>
                  <stylesheet-replacement-tokens>
                    <replacement-token name="status message">
                      <input global="false">
                        <from>status message</from>
                      </input>
                    </replacement-token>
                  </stylesheet-replacement-tokens>
                  <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:choose>
        <xsl:when test="string(.)='false'">${status message}</xsl:when>
        <xsl:otherwise>
          <xsl:text disable-output-escaping="no">The given SNMP trap is not a result of audit remediation job. Cancelling further execution.</xsl:text>
        </xsl:otherwise>
      </xsl:choose>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                </xslt-stylesheet>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[1]:assign[1]</location>
            </assign>
          </sequence>
        </default>
        <case>
          <condition>
            <document>
              <input>
                <from>property value</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[string-length(.)>0]]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <assign>
              <assignment>
                <document>
                  <input>
                    <from>bladelogic alert</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>change id</to>
                  </output>
                </result>
                <xpath-expression>
                  <xpath-replacement-tokens>
                    <replacement-token name="delimiter">
                      <input global="false">
                        <from>remediation job delimiter</from>
                      </input>
                    </replacement-token>
                  </xpath-replacement-tokens>
                  <xpath><![CDATA[substring-before(substring-after(//jc-job-name/text(), '${delimiter}'), '${delimiter}')]]></xpath>
                </xpath-expression>
              </assignment>
              <assignment>
                <document>
                  <input>
                    <from>bladelogic alert</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>overall remediation status</to>
                  </output>
                </result>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[//jc-overall-status/text()]]></xpath>
                </xpath-expression>
              </assignment>
              <assignment>
                <document>
                  <input>
                    <from>bladelogic alert</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>remediation exit code</to>
                  </output>
                </result>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[//jc-exit-code/text()]]></xpath>
                </xpath-expression>
              </assignment>
              <assignment>
                <document>
                  <input>
                    <from>bladelogic alert</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>job start date</to>
                  </output>
                </result>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[//jc-start-time/text()]]></xpath>
                </xpath-expression>
              </assignment>
              <assignment>
                <document>
                  <input>
                    <from>bladelogic alert</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>job end date</to>
                  </output>
                </result>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[//jc-end-time/text()]]></xpath>
                </xpath-expression>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:assign[1]</location>
            </assign>
            <call-process>
              <process-name>:AutoPilot-OA-Change_Management:Searches:Get Change by Change ID</process-name>
              <parameters>
                <input>
                  <from>change platform</from>
                  <to>configuration name</to>
                </input>
                <input>
                  <from>change id</from>
                  <to>change id</to>
                </input>
                <output>
                  <from>changes</from>
                  <to>changes</to>
                </output>
                <output>
                  <from>success status</from>
                  <to>success status</to>
                </output>
                <output>
                  <from>status message</from>
                  <to>status message</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:call-process[1]</location>
            </call-process>
            <switch>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>true</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <execute-all-applicable-cases>false</execute-all-applicable-cases>
              <default>
                <sequence>
                  <assign>
                    <assignment>
                      <document>
                        <input>
                          <from>success status</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>status message</to>
                        </output>
                      </result>
                      <xslt-stylesheet>
                        <stylesheet-replacement-tokens>
                          <replacement-token name="status message">
                            <input global="false">
                              <from>status message</from>
                            </input>
                          </replacement-token>
                        </stylesheet-replacement-tokens>
                        <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:choose>
        <xsl:when test="string(.)='failure'">${status message}</xsl:when>
        <xsl:otherwise>
          <xsl:text disable-output-escaping="no">The SNMP trap does not belong to CLSA module. Cancelling further execution.</xsl:text>
        </xsl:otherwise>
      </xsl:choose>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                      </xslt-stylesheet>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[1]:assign[1]</location>
                  </assign>
                </sequence>
              </default>
              <case applies-if-any-condition-true="false">
                <condition>
                  <document>
                    <input>
                      <from>success status</from>
                    </input>
                  </document>
                  <xpath-expression>
                    <xpath-replacement-tokens />
                    <xpath><![CDATA[string(.)='success']]></xpath>
                  </xpath-expression>
                </condition>
                <condition>
                  <document>
                    <input>
                      <from>changes</from>
                    </input>
                  </document>
                  <xpath-expression>
                    <xpath-replacement-tokens />
                    <xpath><![CDATA[contains(//detailed-description/text(), 'JobType:31')]]></xpath>
                  </xpath-expression>
                </condition>
                <sequence>
                  <assign>
                    <assignment>
                      <document>
                        <input>
                          <from>changes</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>change id</to>
                        </output>
                      </result>
                      <xpath-expression>
                        <xpath-replacement-tokens />
                        <xpath><![CDATA[//change-id/text()]]></xpath>
                      </xpath-expression>
                    </assignment>
                    <assignment>
                      <document>
                        <input>
                          <from>changes</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>incident number</to>
                        </output>
                      </result>
                      <xpath-expression>
                        <xpath-replacement-tokens />
                        <xpath><![CDATA[normalize-space(substring-before(substring-after(//detailed-description/text(), 'IncidentNumber:'), ' JobName:'))]]></xpath>
                      </xpath-expression>
                    </assignment>
                    <assignment>
                      <document>
                        <input>
                          <from>changes</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>audit job name</to>
                        </output>
                      </result>
                      <xpath-expression>
                        <xpath-replacement-tokens />
                        <xpath><![CDATA[substring-before(substring-after(//detailed-description/text(), 'JobName:'), ' InconsistentTarget:')]]></xpath>
                      </xpath-expression>
                    </assignment>
                    <assignment>
                      <document>
                        <input>
                          <from>changes</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>inconsistent target</to>
                        </output>
                      </result>
                      <xpath-expression>
                        <xpath-replacement-tokens />
                        <xpath><![CDATA[substring-before(substring-after(//detailed-description/text(), 'InconsistentTarget:'), ' Templates:')]]></xpath>
                      </xpath-expression>
                    </assignment>
                    <assignment>
                      <document>
                        <input>
                          <from>changes</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>current templates</to>
                        </output>
                      </result>
                      <xpath-expression>
                        <xpath-replacement-tokens />
                        <xpath><![CDATA[normalize-space(substring-before(substring-after(//detailed-description/text(), 'Templates:'), 'RunIndex:'))]]></xpath>
                      </xpath-expression>
                    </assignment>
                    <assignment>
                      <document>
                        <input>
                          <from>jobs</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>current job</to>
                        </output>
                      </result>
                      <xslt-stylesheet>
                        <stylesheet-replacement-tokens>
                          <replacement-token name="audit job name">
                            <input global="false">
                              <from>audit job name</from>
                            </input>
                          </replacement-token>
                        </stylesheet-replacement-tokens>
                        <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <xsl:copy-of select="//job[job-name/text()='${audit job name}']" />
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                      </xslt-stylesheet>
                    </assignment>
                    <assignment>
                      <document>
                        <input>
                          <from>current job</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>current job group</to>
                        </output>
                      </result>
                      <xpath-expression>
                        <xpath-replacement-tokens />
                        <xpath><![CDATA[//job-group/text()]]></xpath>
                      </xpath-expression>
                    </assignment>
                    <assignment>
                      <document>
                        <input>
                          <from>current job</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>current job name</to>
                        </output>
                      </result>
                      <xpath-expression>
                        <xpath-replacement-tokens />
                        <xpath><![CDATA[//job-name/text()]]></xpath>
                      </xpath-expression>
                    </assignment>
                    <assignment>
                      <output>
                        <to>new template list</to>
                        <value>
                          <templates />
                        </value>
                      </output>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:assign[1]</location>
                  </assign>
                  <call-process>
                    <process-name>:AutoPilot-OA-Common_Utilities:Tokenize String</process-name>
                    <parameters>
                      <input>
                        <from>current templates</from>
                        <to>string</to>
                      </input>
                      <input>
                        <value>,</value>
                        <to>delimiter</to>
                      </input>
                      <output>
                        <from>tokens</from>
                        <to>current templates</to>
                      </output>
                    </parameters>
                    <meta>
                      <documentation />
                      <run-mode-handling>
                        <run-mode>OCP</run-mode>
                        <allow-step-into>false</allow-step-into>
                      </run-mode-handling>
                      <checkpoint>false</checkpoint>
                    </meta>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:call-process[1]</location>
                  </call-process>
                  <for-each>
                    <document>
                      <input>
                        <from>current templates</from>
                      </input>
                    </document>
                    <result>
                      <output>
                        <to>current template</to>
                      </output>
                    </result>
                    <xpath-expression>
                      <xpath-replacement-tokens />
                      <xpath><![CDATA[//token]]></xpath>
                    </xpath-expression>
                    <meta>
                      <documentation />
                      <run-mode-handling>
                        <run-mode>OCP</run-mode>
                        <allow-step-into>true</allow-step-into>
                      </run-mode-handling>
                      <checkpoint>false</checkpoint>
                    </meta>
                    <sequence>
                      <call-process>
                        <process-name>:AutoPilot-OA-Common_Utilities:Tokenize String</process-name>
                        <parameters>
                          <input>
                            <from>current template</from>
                            <to>string</to>
                          </input>
                          <input>
                            <value>/</value>
                            <to>delimiter</to>
                          </input>
                          <output>
                            <from>tokens</from>
                            <to>current template</to>
                          </output>
                        </parameters>
                        <meta>
                          <documentation />
                          <run-mode-handling>
                            <run-mode>OCP</run-mode>
                            <allow-step-into>false</allow-step-into>
                          </run-mode-handling>
                          <checkpoint>false</checkpoint>
                        </meta>
                        <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:call-process[2]</location>
                      </call-process>
                      <assign>
                        <assignment>
                          <document>
                            <input>
                              <from>current template</from>
                            </input>
                          </document>
                          <result>
                            <output>
                              <to>current template</to>
                            </output>
                          </result>
                          <xslt-stylesheet>
                            <stylesheet-replacement-tokens />
                            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <template>
      <group>
        <xsl:for-each select="//token[position() &lt; last() and string-length(text()) &gt; 0] ">
          <xsl:value-of select="concat('/', text())" disable-output-escaping="no" />
        </xsl:for-each>
      </group>
      <name>
        <xsl:value-of select="//token[position() = last()]/text()" disable-output-escaping="no" />
      </name>
    </template>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                          </xslt-stylesheet>
                        </assignment>
                        <assignment>
                          <document>
                            <input>
                              <from>new template list</from>
                            </input>
                          </document>
                          <result>
                            <output>
                              <to>new template list</to>
                            </output>
                          </result>
                          <xslt-stylesheet>
                            <stylesheet-replacement-tokens>
                              <replacement-token name="current template">
                                <input global="false">
                                  <from>current template</from>
                                </input>
                              </replacement-token>
                            </stylesheet-replacement-tokens>
                            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <templates>
      <xsl:copy-of select="//template" />
      ${current template}
    </templates>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                          </xslt-stylesheet>
                        </assignment>
                        <meta>
                          <documentation />
                          <checkpoint>false</checkpoint>
                        </meta>
                        <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:assign[2]</location>
                      </assign>
                    </sequence>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:for-each[1]</location>
                  </for-each>
                  <assign>
                    <assignment>
                      <document>
                        <input>
                          <from>current job</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>current job</to>
                        </output>
                      </result>
                      <xslt-stylesheet>
                        <stylesheet-replacement-tokens>
                          <replacement-token name="job name">
                            <input global="false">
                              <from>current job name</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="job group">
                            <input global="false">
                              <from>current job group</from>
                            </input>
                          </replacement-token>
                          <replacement-token name="template list">
                            <input global="false">
                              <from>new template list</from>
                            </input>
                          </replacement-token>
                        </stylesheet-replacement-tokens>
                        <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <job>
      <job-group>${job group}</job-group>
      <job-name>${job name}</job-name>
      ${template list}
    </job>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                      </xslt-stylesheet>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:assign[3]</location>
                  </assign>
                  <call-process>
                    <process-name>:Closed_Loop_Server-SA-Audit:Utilities:Verify Remediation</process-name>
                    <parameters>
                      <input>
                        <from>bl connection details</from>
                        <to>bl connection details</to>
                      </input>
                      <input>
                        <from>file connection details</from>
                        <to>file connection details</to>
                      </input>
                      <input>
                        <from>audit job name</from>
                        <to>verification job name</to>
                        <xpath-expression>
                          <xpath-replacement-tokens />
                          <xpath><![CDATA[concat(., 'Verify')]]></xpath>
                        </xpath-expression>
                      </input>
                      <input>
                        <from>current job</from>
                        <to>verification job group</to>
                        <xpath-expression>
                          <xpath-replacement-tokens />
                          <xpath><![CDATA[//job-group/text()]]></xpath>
                        </xpath-expression>
                      </input>
                      <input>
                        <from>destination verify job group</from>
                        <to>destination verify job group</to>
                      </input>
                      <input>
                        <from>inconsistent target</from>
                        <to>target server</to>
                      </input>
                      <input>
                        <from>current job</from>
                        <to>job</to>
                      </input>
                      <input>
                        <from>export path</from>
                        <to>export file path</to>
                      </input>
                      <input>
                        <from>change id</from>
                        <to>change id</to>
                      </input>
                      <input>
                        <from>remediation job delimiter</from>
                        <to>job delimiter</to>
                      </input>
                      <input>
                        <from>bl version</from>
                        <to>bl version</to>
                      </input>
                      <input>
                        <from>bl connection details instance 2</from>
                        <to>bl connection details instance 2</to>
                      </input>
                      <input>
                        <from>blcli tunnelling</from>
                        <to>blcli tunnelling</to>
                      </input>
                      <output>
                        <from>success status</from>
                        <to>success status</to>
                      </output>
                      <output>
                        <from>status message</from>
                        <to>verification status message</to>
                      </output>
                      <output>
                        <from>output</from>
                        <to>verification output</to>
                      </output>
                    </parameters>
                    <meta>
                      <documentation />
                      <run-mode-handling>
                        <run-mode>OCP</run-mode>
                        <allow-step-into>false</allow-step-into>
                      </run-mode-handling>
                      <checkpoint>false</checkpoint>
                    </meta>
                    <after-execution>
                      <console-output>
                        <type>INFO</type>
                        <summary>
                          <concat>
                            <input>
                              <value></value>
                            </input>
                          </concat>
                        </summary>
                        <detail>
                          <concat>
                            <input>
                              <value></value>
                            </input>
                          </concat>
                        </detail>
                      </console-output>
                      <log>
                        <level>debug</level>
                        <parameters>
                          <input>
                            <from>verification output</from>
                          </input>
                        </parameters>
                      </log>
                    </after-execution>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:call-process[3]</location>
                  </call-process>
                  <assign>
                    <assignment>
                      <document>
                        <input>
                          <from>verification status message</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>verification status message</to>
                        </output>
                      </result>
                      <xpath-expression>
                        <xpath-replacement-tokens />
                        <xpath><![CDATA[//text()]]></xpath>
                      </xpath-expression>
                    </assignment>
                    <assignment>
                      <document>
                        <input>
                          <from>verification output</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>workinfo details</to>
                        </output>
                      </result>
                      <xslt-stylesheet>
                        <stylesheet-replacement-tokens>
                          <replacement-token name="status message">
                            <input global="false">
                              <from>verification status message</from>
                            </input>
                          </replacement-token>
                        </stylesheet-replacement-tokens>
                        <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:choose>
        <xsl:when test="string-length(//text()) &gt; 0">
          <xsl:text disable-output-escaping="no">Hostname: </xsl:text>
          <xsl:value-of select="//targets/target[position()=1]/@server-name" disable-output-escaping="no" />
          <xsl:text disable-output-escaping="no">
Server Object,Stat,Item,Target,ACL Path,Consistent,Details
</xsl:text>
          <xsl:for-each select="//compliant-audit-items">
            <xsl:value-of select="concat(server-object/text(), ',', stat/text(), ',', item/text(), ',', target/text(), ',', acl/text(), ',', consistent/text(), ',', details/text())" disable-output-escaping="no" />
            <xsl:text disable-output-escaping="no">
</xsl:text>
          </xsl:for-each>
        </xsl:when>
        <xsl:otherwise>${status message}</xsl:otherwise>
      </xsl:choose>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                      </xslt-stylesheet>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:assign[4]</location>
                  </assign>
                  <switch>
                    <meta>
                      <documentation />
                      <run-mode-handling>
                        <run-mode>OCP</run-mode>
                        <allow-step-into>true</allow-step-into>
                      </run-mode-handling>
                      <checkpoint>false</checkpoint>
                    </meta>
                    <execute-all-applicable-cases>false</execute-all-applicable-cases>
                    <default>
                      <sequence>
                        <call-process>
                          <process-name>:AutoPilot-OA-Incident_Management:Update WorkInfo</process-name>
                          <parameters>
                            <input>
                              <from>incident platform</from>
                              <to>configuration name</to>
                            </input>
                            <input>
                              <from>incident number</from>
                              <to>incident number</to>
                            </input>
                            <input>
                              <value>Remediation attempt failed</value>
                              <to>workinfo summary</to>
                            </input>
                            <input>
                              <from>workinfo details</from>
                              <to>workinfo details</to>
                            </input>
                            <input>
                              <value>General Information</value>
                              <to>workinfo type</to>
                            </input>
                            <input>
                              <value>Yes</value>
                              <to>locked</to>
                            </input>
                            <input>
                              <value>Internal</value>
                              <to>view access</to>
                            </input>
                            <output>
                              <from>incidents</from>
                              <to>incidents</to>
                            </output>
                            <output>
                              <from>success status</from>
                              <to>success status</to>
                            </output>
                            <output>
                              <from>status message</from>
                              <to>status message</to>
                            </output>
                          </parameters>
                          <meta>
                            <documentation />
                            <run-mode-handling>
                              <run-mode>OCP</run-mode>
                              <allow-step-into>false</allow-step-into>
                            </run-mode-handling>
                            <checkpoint>false</checkpoint>
                          </meta>
                          <after-execution>
                            <console-output>
                              <type>INFO</type>
                              <summary>
                                <concat>
                                  <input>
                                    <value></value>
                                  </input>
                                </concat>
                              </summary>
                              <detail>
                                <concat>
                                  <input>
                                    <value></value>
                                  </input>
                                </concat>
                              </detail>
                            </console-output>
                          </after-execution>
                          <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[1]:call-process[1]</location>
                        </call-process>
                        <switch>
                          <meta>
                            <documentation />
                            <run-mode-handling>
                              <run-mode>OCP</run-mode>
                              <allow-step-into>true</allow-step-into>
                            </run-mode-handling>
                            <checkpoint>false</checkpoint>
                          </meta>
                          <execute-all-applicable-cases>false</execute-all-applicable-cases>
                          <default>
                            <sequence />
                          </default>
                          <case>
                            <condition>
                              <document>
                                <input>
                                  <from>success status</from>
                                </input>
                              </document>
                              <xpath-expression>
                                <xpath-replacement-tokens />
                                <xpath><![CDATA[string(.)='success']]></xpath>
                              </xpath-expression>
                            </condition>
                            <sequence>
                              <assign>
                                <assignment>
                                  <input>
                                    <from>incident number</from>
                                  </input>
                                  <output>
                                    <to>incident</to>
                                    <concept type="AutoPilot-OA-Incident_Management:Incident">
                                      <attribute>incident-number</attribute>
                                    </concept>
                                  </output>
                                </assignment>
                                <assignment>
                                  <output>
                                    <to>incident</to>
                                    <value>2-High</value>
                                    <concept type="AutoPilot-OA-Incident_Management:Incident">
                                      <attribute>urgency</attribute>
                                    </concept>
                                  </output>
                                </assignment>
                                <assignment>
                                  <document>
                                    <input>
                                      <from>incident</from>
                                    </input>
                                  </document>
                                  <result>
                                    <output>
                                      <to>update incidents</to>
                                    </output>
                                  </result>
                                  <xslt-stylesheet>
                                    <stylesheet-replacement-tokens>
                                      <replacement-token name="incident">
                                        <input global="false">
                                          <from>incident</from>
                                        </input>
                                      </replacement-token>
                                    </stylesheet-replacement-tokens>
                                    <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <Incidents>
      <xsl:choose>
        <xsl:when test="string-length(//incident) &gt; 0">
          <xsl:copy-of select="//incident" />
        </xsl:when>
        <xsl:otherwise>${incident}</xsl:otherwise>
      </xsl:choose>
    </Incidents>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                                  </xslt-stylesheet>
                                </assignment>
                                <meta>
                                  <documentation />
                                  <checkpoint>false</checkpoint>
                                </meta>
                                <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[1]:switch[1]:sequence[2]:assign[1]</location>
                              </assign>
                              <call-process>
                                <process-name>:AutoPilot-OA-Incident_Management:Update Incidents</process-name>
                                <parameters>
                                  <input>
                                    <from>incident platform</from>
                                    <to>configuration name</to>
                                  </input>
                                  <input>
                                    <from>update incidents</from>
                                    <to>incidents</to>
                                  </input>
                                  <output>
                                    <from>success status</from>
                                    <to>success status</to>
                                  </output>
                                  <output>
                                    <from>status message</from>
                                    <to>status message</to>
                                  </output>
                                </parameters>
                                <meta>
                                  <documentation />
                                  <run-mode-handling>
                                    <run-mode>OCP</run-mode>
                                    <allow-step-into>false</allow-step-into>
                                  </run-mode-handling>
                                  <checkpoint>false</checkpoint>
                                </meta>
                                <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[1]:switch[1]:sequence[2]:call-process[1]</location>
                              </call-process>
                            </sequence>
                          </case>
                          <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[1]:switch[1]</location>
                        </switch>
                      </sequence>
                    </default>
                    <case>
                      <condition>
                        <document>
                          <input>
                            <from>success status</from>
                          </input>
                        </document>
                        <xpath-expression>
                          <xpath-replacement-tokens />
                          <xpath><![CDATA[string(.) = 'true']]></xpath>
                        </xpath-expression>
                      </condition>
                      <sequence>
                        <console-output>
                          <type>INFO</type>
                          <summary>
                            <concat>
                              <input>
                                <value></value>
                              </input>
                            </concat>
                          </summary>
                          <detail>
                            <concat>
                              <input>
                                <value></value>
                              </input>
                            </concat>
                          </detail>
                        </console-output>
                        <call-process>
                          <process-name>:AutoPilot-OA-Incident_Management:Update WorkInfo</process-name>
                          <parameters>
                            <input>
                              <from>incident platform</from>
                              <to>configuration name</to>
                            </input>
                            <input>
                              <from>incident number</from>
                              <to>incident number</to>
                            </input>
                            <input>
                              <value>Remediation attempt successful</value>
                              <to>workinfo summary</to>
                            </input>
                            <input>
                              <from>workinfo details</from>
                              <to>workinfo details</to>
                            </input>
                            <input>
                              <value>General Information</value>
                              <to>workinfo type</to>
                            </input>
                            <input>
                              <value>Yes</value>
                              <to>locked</to>
                            </input>
                            <input>
                              <value>Internal</value>
                              <to>view access</to>
                            </input>
                            <output>
                              <from>success status</from>
                              <to>success status</to>
                            </output>
                            <output>
                              <from>status message</from>
                              <to>status message</to>
                            </output>
                          </parameters>
                          <meta>
                            <documentation />
                            <run-mode-handling>
                              <run-mode>OCP</run-mode>
                              <allow-step-into>false</allow-step-into>
                            </run-mode-handling>
                            <checkpoint>false</checkpoint>
                          </meta>
                          <after-execution>
                            <console-output>
                              <type>INFO</type>
                              <summary>
                                <concat>
                                  <input>
                                    <value></value>
                                  </input>
                                </concat>
                              </summary>
                              <detail>
                                <concat>
                                  <input>
                                    <value></value>
                                  </input>
                                </concat>
                              </detail>
                            </console-output>
                          </after-execution>
                          <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[2]:call-process[1]</location>
                        </call-process>
                        <switch>
                          <meta>
                            <documentation />
                            <run-mode-handling>
                              <run-mode>OCP</run-mode>
                              <allow-step-into>true</allow-step-into>
                            </run-mode-handling>
                            <checkpoint>false</checkpoint>
                          </meta>
                          <execute-all-applicable-cases>false</execute-all-applicable-cases>
                          <default>
                            <sequence />
                          </default>
                          <case>
                            <condition>
                              <document>
                                <input>
                                  <from>success status</from>
                                </input>
                              </document>
                              <xpath-expression>
                                <xpath-replacement-tokens />
                                <xpath><![CDATA[string(.)='success']]></xpath>
                              </xpath-expression>
                            </condition>
                            <sequence>
                              <call-process>
                                <process-name>:AutoPilot-OA-Incident_Management:Update Incident Status</process-name>
                                <parameters>
                                  <input>
                                    <from>incident platform</from>
                                    <to>configuration name</to>
                                  </input>
                                  <input>
                                    <from>incident number</from>
                                    <to>incident number</to>
                                  </input>
                                  <input>
                                    <value>Closed</value>
                                    <to>new status</to>
                                  </input>
                                  <input>
                                    <value>No Further Action Required</value>
                                    <to>status reason</to>
                                  </input>
                                  <output>
                                    <from>success status</from>
                                    <to>success status</to>
                                  </output>
                                  <output>
                                    <from>status message</from>
                                    <to>status message</to>
                                  </output>
                                </parameters>
                                <meta>
                                  <documentation />
                                  <run-mode-handling>
                                    <run-mode>OCP</run-mode>
                                    <allow-step-into>false</allow-step-into>
                                  </run-mode-handling>
                                  <checkpoint>false</checkpoint>
                                </meta>
                                <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[2]:call-process[1]</location>
                              </call-process>
                            </sequence>
                          </case>
                          <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]</location>
                        </switch>
                      </sequence>
                    </case>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]</location>
                  </switch>
                </sequence>
              </case>
              <location>:switch[1]:sequence[2]:switch[1]</location>
            </switch>
          </sequence>
        </case>
        <location>:switch[1]</location>
      </switch>
      <assign>
        <assignment>
          <document>
            <input>
              <from>success status</from>
            </input>
          </document>
          <result>
            <output>
              <to>success status</to>
            </output>
          </result>
          <xslt-stylesheet>
            <stylesheet-replacement-tokens />
            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:choose>
        <xsl:when test="string(.)!='success' and string(.)!='failure'">
          <xsl:choose>
            <xsl:when test="string(.)='true'">
              <xsl:text disable-output-escaping="no">success</xsl:text>
            </xsl:when>
            <xsl:otherwise>
              <xsl:text disable-output-escaping="no">failure</xsl:text>
            </xsl:otherwise>
          </xsl:choose>
        </xsl:when>
        <xsl:otherwise>
          <xsl:value-of select="." disable-output-escaping="no" />
        </xsl:otherwise>
      </xsl:choose>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
          </xslt-stylesheet>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <location>:assign[1]</location>
      </assign>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>This workflow is triggered by RBA monitor adapter upon receiving a SNMP alert from BL for  a job completion. This workflow checks the BL job status. If the job status is complete, it updates the status of incident ticket and task to 'closed'. If inconsistencies are not resolved, it escalates the incident.</description>
        <version></version>
      </documentation>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>06fd6858-5b4f-3df7-b04a-06734e6b13d0</process-id>
      <author></author>
      <category></category>
      <status></status>
      <keywords></keywords>
      <systems></systems>
      <last-modified-by></last-modified-by>
      <last-modified>1320398582279</last-modified>
    </meta>
  </process-def>
</process>