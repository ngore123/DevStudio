<process draft="false" dev-studio-version="7.6.01.02">
  <process-def name=":AO-AD-HP_ServiceManager:v7.1:Configuration_Management:Find Device">
    <parameters>
      <input global="false" required="false">
        <description>The name of the adapter to use to handle the request. Default adapter name: HPSMActor.</description>
        <from>adapter name</from>
        <to>adapter name</to>
      </input>
      <input global="false" required="true">
        <description>
The items for the adapter request. This should be an XML document with a root element named "items" having multiple child "item" elements, which should contain the data necessary to execute the specific request. 

Find Device

This wrapper finds a 'Device'

Sample Item Xml: 

&lt;items&gt;
	&lt;item&gt;
		&lt;operation-name&gt;retrieve-device&lt;/operation-name&gt;
		&lt;model&gt;
			&lt;keys&gt;
			  &lt;configuration-item&gt;
				&lt;value&gt;NewDevice10&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/configuration-item&gt;

			&lt;/keys&gt;
			&lt;instance&gt;
			  &lt;configuration-item&gt;
				&lt;value&gt;NewDevice10&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/configuration-item&gt;
			 
			  &lt;configuration-item-type&gt;
				&lt;value&gt;device&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/configuration-item-type&gt;
			 
			  &lt;status&gt;
				&lt;value&gt;status&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/status&gt;

			  &lt;vendor&gt;
				&lt;value&gt;Vendor name&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/vendor&gt;
			  &lt;parent-device&gt;
				&lt;value&gt;parent device&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/parent-device&gt;
			  &lt;model&gt;
				&lt;value&gt;model&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/model&gt;
			  &lt;serial-number&gt;
				&lt;value&gt;serial number&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/serial-number&gt;
			  &lt;location&gt;
				&lt;value&gt;location&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/location&gt;
			  &lt;contact-name&gt;
				&lt;value&gt;contact name&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/contact-name&gt;
			  &lt;part-number&gt;
				&lt;value&gt;part number&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/part-number&gt;
			
			  &lt;configuration-item-sub-type&gt;
				&lt;value&gt;cist&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/configuration-item-sub-type&gt;
			  &lt;location-code&gt;
				&lt;value&gt;location code&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/location-code&gt;
			  &lt;building&gt;
				&lt;value&gt;bulding&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/building&gt;
			  &lt;floor&gt;
				&lt;value&gt;floor&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/floor&gt;
			  &lt;room&gt;
				&lt;value&gt;room&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/room&gt;
			  &lt;system-down&gt;
				&lt;value&gt;true&lt;/value&gt;
				&lt;type&gt;Boolean&lt;/type&gt;
			  &lt;/system-down&gt;
			  &lt;asset-tag&gt;
				&lt;value&gt;asset tag&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/asset-tag&gt;
			  &lt;critical&gt;
				&lt;value&gt;true&lt;/value&gt;
				&lt;type&gt;Boolean&lt;/type&gt;
			  &lt;/critical&gt;
			  &lt;company&gt;
				&lt;value&gt;company&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/company&gt;
			  &lt;department&gt;
				&lt;value&gt;department&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/department&gt;
			  &lt;assignment-group&gt;
				&lt;value&gt;assignment&lt;/value&gt;
				&lt;type&gt;String&lt;/type&gt;
			  &lt;/assignment-group&gt; 
			&lt;/instance&gt;
		&lt;/model&gt;
	&lt;/item&gt;
&lt;/items&gt;

Elements’ Description: 

Locating any Device takes place as follows:-

The elements inside instance describe the Device. Following are cases,

Case1: You provide (either in &lt;keys&gt; or in &lt;instance&gt; or in both) only key then the Device is uniquely located.

Case2: You provide (either in &lt;keys&gt; or in &lt;instance&gt; or in both) key element(s) along with some other elements then the Device is located only by key elements. All other elements get None. Device would get searched on the basis of the key element(s).

Case3: You provide (either in &lt;keys&gt; or in &lt;instance&gt; or in both) only those elements  that are not key. Then the Device is located by logically ANDing all those elements.

Case4: You don’t provide anything. Then all records under 'Configuration Management' would be fetched.

NOTE:  For a given pattern string P is said to be matched with text string T if the string P is prefix string of T. for example, 

P = xyz 
T = xyz123 
Then P is matched with T. 

If, 
P = xyz
T = 1xyz23 
Then P is not matched with T.

etc.

this means, if you’re searching for vendor, and you’ve given vendor name to be “abc” and if there are two Devices with vendor name “abc123” and “abc456” then both these Device would be fetched.

Complete Elements’ Description: 

item [Required] : This is a child of &lt;items&gt;. This &lt;item&gt; tag can be multiple times to support "multiple items support". 

operation-name [Required] : This is used to specify the operation that needs to be performed.

	Valid values: retrieve-device

model[Required]: It is the parent tag for containing all other tags.
	
keys [Required] : used to specify search criteria

instance [Required] : It can have several child elements. The children of this element describe attributes of a Device.

configuration-item [Optional]: This is the name of the Device. This tag is used as key. 
	
	Name of this element in the application: Configuration Item.

	Valid Values: Any value.

configuration-item-type[Optional]: the type of the configuration item. 

	Name of this element in the application: Type.
	
	Valid Values: any value.
	
status[Optional] : the status of the configuration item.

	Name of this element in the application: Status.
	
	Valid Values: Any one value out of following set of values
	
	Installed
	Available
	Warehouse
	Transfer
	RMA
	Replaced
	Reserved
	Retired

vendor [Optional]: The vendor name. 

	Name of this element in the application: General &gt;  Vendor Name.
	
	Valid Values: Any value.

parent-device [Optional] : parent device of the Device.

	Name of this element in the application: Hidden. 
	
	Valid Values: Any value. 

model [Optional] : The model attribute of the Device. 
	
	Name of this element in the application: Hidden.

	Valid Values: Any value.

serial-number[Optional]: The serial number of the Device.

	Name of this element in the application: General &gt; Serial Number.

	Valid Values: Any value.

location [Optional] :  The location attribute of the Device.
	
	Name of this element in the application: General &gt; Location.

	Valid Values: Any value.

contact-name [Optional] : The contact name.

	Name of this element in the application: General &gt; Contact Name.
	
	Valid Values: Any value. 

part-number [Optional] : Part number of the Device.

	Name of this element in the application: General &gt; Part Number.

	Valid Values: Any value.

configuration-item-sub-type [Optional]: Sub type of configuration item. 

	Name of this element in the application: Subtype.

	Valid Values: Any value.

location-code [Optional] : The location code of the Device. 

	Name of this element in the application: Hidden.

	Valid Values: Any value. 

building [Optional] : The building attribute of the Device. 

	Name of this element in the application: General &gt; Building. 
	
	Valid Values: Any value.

floor [Optional] : Floor information of the Device.
	
	Name of this element in the application: General &gt; Floor.

	Valid values: Any value. 

room [Optional] : The room information of the Device.
	
	Name of this element in the application: General &gt; Room.

	Valid Values: Any value.

system-down [Optional]: The information whether system is down or not.

	Name of this element in the application: "System Down?" (check box).

	Valid values: true, false.

asset-tag [Optional] : The asset tag information. 
	
	Name of this element in the application: Asset Tag.

	Valid Values: Any value.

critical [Optional] : The information whether the Device is critical or not.

	Name of this element in the application: Critical CI (check box)

	Valid Values: true, false. 

company [Optional] : Associated company of the Device.

	Name of this element in the application: Company.

	Valid values: Any value.

department [Optional] : Associated department Device.

	Name of this element in the application: Department. 
	
	Valid Values: Any value.

assignment-group [Optional]: The assignment group of the Device.

	Name of this element in the application: General &gt; Assignment. 

	Valid Values: Any value. 

</description>
        <from>items</from>
        <to>items</to>
      </input>
      <input global="false" required="false">
        <description>Provide username/password in form of xml. 

This input parameter is required when the user wants to override the default values for username and password provided in the adapter configuration. This is required for cases where an operation cannot be executed with the default username/password provided in the adapter configuration and only user with special permissions can execute the operation. Examples of such operations can be - 'approve-change', 'deny-change', 'close-change', 'approve-task'

Sample XML Format: 

&lt;connection-parameters&gt;
	&lt;alternate-username&gt;USERNAME&lt;/alternate-username&gt;
	&lt;alternate-password&gt;PASSWORD&lt;/alternate-password&gt;
&lt;/connection-parameters&gt;</description>
        <from>connection parameters</from>
        <to>connection parameters</to>
      </input>
      <output global="false" required="false">
        <description>The adapter response containing the results. </description>
        <to>adapter response</to>
        <from>adapter response</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <switch>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <execute-all-applicable-cases>false</execute-all-applicable-cases>
        <default>
          <sequence>
            <call-process>
              <process-name>:AO-AD-HP_ServiceManager:Utilities:Operation Name Error Reporting</process-name>
              <parameters>
                <input>
                  <value>retrieve-device</value>
                  <to>operation name</to>
                </input>
                <input>
                  <from>items</from>
                  <to>items</to>
                </input>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[1]:call-process[1]</location>
            </call-process>
          </sequence>
        </default>
        <case>
          <condition>
            <document>
              <input>
                <from>items</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[(//operation-name)[1]/text() = 'retrieve-device']]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <assign>
              <assignment>
                <document>
                  <input>
                    <from>items</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>items</to>
                  </output>
                </result>
                <xslt-stylesheet>
                  <stylesheet-replacement-tokens />
                  <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <items>
      <xsl:for-each select="//item">
        <item>
          <entity-type>
            <xsl:text disable-output-escaping="no">device</xsl:text>
          </entity-type>
          <xsl:copy-of select="./*" />
        </item>
      </xsl:for-each>
    </items>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                </xslt-stylesheet>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:assign[1]</location>
            </assign>
            <call-process>
              <process-name>:AO-AD-HP_ServiceManager:Utilities:Configuration_Management:Find Configuration Item Utility</process-name>
              <parameters>
                <input>
                  <from>adapter name</from>
                  <to>adapter name</to>
                </input>
                <input>
                  <from>items</from>
                  <to>items</to>
                </input>
                <input>
                  <from>connection parameters</from>
                  <to>connection parameters</to>
                </input>
                <output>
                  <from>adapter response</from>
                  <to>adapter response</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:call-process[1]</location>
            </call-process>
          </sequence>
        </case>
        <location>:switch[1]</location>
      </switch>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>This wrapper finds a 'Device'</description>
        <version>1.0</version>
      </documentation>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>27c7a96c-bea5-3349-9d84-89c7f951c331</process-id>
      <author />
      <category />
      <status />
      <keywords />
      <systems />
      <last-modified-by />
      <last-modified>1290594367205</last-modified>
    </meta>
  </process-def>
</process>