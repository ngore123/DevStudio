<process draft="false" dev-studio-version="7.6.01.02">
  <process-def name=":AO-AD-HP_ServiceManager:v7.1:Configuration_Management:Update Office Electronic">
    <parameters>
      <input global="false" required="false">
        <description>The name of the adapter to use to handle the request. Default adapter name: HPSMActor.</description>
        <from>adapter name</from>
        <to>adapter name</to>
      </input>
      <input global="false" required="true">
        <description>The items for the adapter request. This should be an XML document with a root element named "items" having a child "item", which should contain the data necessary to execute the specific request. 


Update Office Electronic
 
This wrapper updates ‘Office Electronic’ record.

Sample Item Xml:

&lt;items&gt;
	&lt;item&gt;
		&lt;operation-name&gt;update-office-electronic&lt;/operation-name&gt;
		&lt;model&gt;
            &lt;keys&gt;
              &lt;logical-name&gt;
                &lt;value&gt;OffElec-001&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/logical-name&gt;
            &lt;/keys&gt;
            &lt;instance&gt;
              &lt;file-device&gt;
                &lt;type&gt;Structure&lt;/type&gt;
                &lt;logical-name&gt;
                  &lt;value&gt;OffElec-001&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/logical-name&gt;
				&lt;asset-tag&gt;
				  &lt;value&gt;assetTag&lt;/value&gt;
				  &lt;type&gt;String&lt;/type&gt;
				&lt;/asset-tag&gt;
				&lt;company&gt;
				  &lt;value&gt;company&lt;/value&gt;
				  &lt;type&gt;String&lt;/type&gt;
				&lt;/company&gt;
                &lt;vendor&gt;
                  &lt;value&gt;Hewlett-Packard&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/vendor&gt;
                &lt;serial-no&gt;
                  &lt;value&gt;Serial No 12&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/serial-no&gt;
                &lt;location&gt;
                  &lt;value&gt;Australia&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/location&gt;
                &lt;configuration-item-type&gt;
                  &lt;value&gt;officeelectronics&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/configuration-item-type&gt;
                &lt;id&gt;
                  &lt;value&gt;CI10921&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/id&gt;
                &lt;updated-by&gt;
                  &lt;value&gt;falcon&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/updated-by&gt;
                &lt;part-no&gt;
                  &lt;value&gt;Prt No 11&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/part-no&gt;
                &lt;istatus&gt;
                  &lt;value&gt;In use&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/istatus&gt;
                &lt;version&gt;
                  &lt;value&gt;Ver 12&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/version&gt;
                &lt;subtype&gt;
                  &lt;value&gt;Copy Machine&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/subtype&gt;
                &lt;location-code&gt;
                  &lt;value&gt;advantageaustralia&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/location-code&gt;
                &lt;building&gt;
                  &lt;value&gt;Building DEL4&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/building&gt;
                &lt;floor&gt;
                  &lt;value&gt;LG&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/floor&gt;
                &lt;room&gt;
                  &lt;value&gt;BETA&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/room&gt;
                &lt;sysmodtime&gt;
                  &lt;value&gt;2010.02.09 12:09:23&lt;/value&gt;
                  &lt;type&gt;DateTime&lt;/type&gt;
                &lt;/sysmodtime&gt;
                &lt;sysmodcount&gt;
                  &lt;value&gt;1&lt;/value&gt;
                  &lt;type&gt;Decimal&lt;/type&gt;
                &lt;/sysmodcount&gt;
                &lt;sysmoduser&gt;
                  &lt;value&gt;falcon&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/sysmoduser&gt;
                &lt;assignment&gt;
                  &lt;value&gt;Applications&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/assignment&gt;
                &lt;title&gt;
                  &lt;value&gt;Title for Office Elec&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/title&gt;
                &lt;environment&gt;
                  &lt;value&gt;Development&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/environment&gt;
                &lt;owner&gt;
                  &lt;value&gt;Rajat&lt;/value&gt;
                  &lt;type&gt;String&lt;/type&gt;
                &lt;/owner&gt;
              &lt;/file-device&gt;
              &lt;file-officeelectronics&gt;
                &lt;type&gt;Structure&lt;/type&gt;
              &lt;/file-officeelectronics&gt;
            &lt;/instance&gt;
          &lt;/model&gt;
	&lt;/item&gt;
&lt;/items&gt; 
Elements’ Description: 
Update Process takes place in following manner-

The record is first selected (located) by the information provided in the &lt;keys&gt; element. Essentially, you populate &lt;keys&gt; element with valid key elements otherwise the record wouldn’t be located. 

Once the record is located properly, the fields are updated by the information provided in &lt;instance&gt; element. That is, the respective fields of located record are replaced by the elements’ values that are provided in &lt;instance&gt; element.

NOTE: While locating a record, complete matching of key is required. This means if you give key value to be “abc” and there is a record in the application repository which has key element as “abc123” then this record wouldn’t be located for the update (compare with Find Wrappers.)
 
Modification/Update in located record is done in following manner-

Suppose an random element with name &lt;random-element&gt; which has an 'fieldValue1'. i.e. on retrieving, we'll get.

&lt;instance&gt;
	...
	...
	
	&lt;random-element&gt;
		&lt;value&gt;fieldValue1&lt;/value&gt;
		&lt;type&gt;fieldType&lt;type&gt;
	&lt;/random-element&gt;
	...
	...
&lt;/instance&gt;

Now see following cases of updation-


Case-1:
&lt;instance&gt;
&lt;/instance&gt;

i.e., we don't provide even the element &lt;random-element&gt;
Result: the field get ignored, i.e. not updated.

Case-2:
&lt;instance&gt;
	&lt;random-element&gt;
		&lt;value&gt;&lt;/value&gt;
		&lt;type&gt;fieldType&lt;type&gt;
	&lt;/random-element&gt;
&lt;/instance&gt;

i.e., we don't provide anything inside &lt;value&gt; element (child of element &lt;random-element&gt;.)
Result: the field get ignored, i.e. not updated.

Case-3:
&lt;instance&gt;
	&lt;random-element&gt;
		&lt;value&gt; &lt;/value&gt;
		&lt;type&gt;fieldType&lt;type&gt;
	&lt;/random-element&gt;
&lt;/instance&gt;

i.e., we provide an space character " " (or more contiguous space characters, like "   ") inside &lt;value&gt; element (child of element &lt;random-element&gt;.)
Result: the field get's updated, and the field &lt;random-elements&gt; is set to blank ""(compare with space character " ".)


Case-4:
&lt;instance&gt;
	&lt;random-element&gt;
		&lt;value&gt;fieldValue2&lt;/value&gt;
		&lt;type&gt;fieldType&lt;type&gt;
	&lt;/random-element&gt;
&lt;/instance&gt;

i.e., we provide "fieldValue2" inside &lt;value&gt; element (child of element &lt;random-element&gt;.)
Result: the value "fieldValue2" is set to field of &lt;random-element&gt;. 



NOTE: One can update the key elements too.

Complete Elements’ Description: 

item [Required]:
	This is a child of &lt;items&gt;. This &lt;item&gt; tag can be multiple times to support "multiple items support". 

operation-name [Required]: 

	This shows, what operation you want to perform.

	Valid values: update-office-electronic
	 

model [Required]: It is the parent tag for containing all other tags.
	 
keys [Required]: used to ask application to search for the record with the elements inside it.

logical-name [Required] : Unique Name for identifying the office electronic item.

Valid values: Any unique string. 

Name of this element in the application : CI Name

Note : &lt;logical-name&gt; must be the child item of keys tag.

Instance [Required] :
It can have many children. The children of this element describe fields of a record.

File-device [Required]: It can have many children.  The children of this element describe fields of a record.

Istatus [Optional] : Specifies the status of the office electronic item.

	Name of the field on application : Status

	Valid Values :
	Planned/On order
	Received
	In Stock
	Reserved
	In use
	Maintenance
	Disposed/Retired
	Installed	

Assignment[Optional]: Specifies the assignment group for the office electronic item. 

	Name of this element in the application: Config Admin Group

	Valid Value: Any string, or you can select any existing record from the application.
	
Vendor [Optional]: The vendor name. 

	Name of this element in the application: “Vendor &gt; Vendor Name.”
	
Valid Values: Any string or you can select vendor record from the application’s repository.

Serial-no [Optional]: The serial number of the record.
	
	Name of this element in the application: “Model &gt; Serial Number.”
	
	Valid Values:  Any string. 

Location [Optional]: location mapped by the record.
	
	Name of this element in the application: “Location &gt; Location.”
	
	Valid Values: Any String or you can select any existing location record.

Configuration-item-type[Optional]: the type of the configuration item. 

	Name of this element in the application: General &gt; CI Type
	
	Valid Values: if you’re retrieving “office electronic” then you must populate this element with “officeelectronics”.	

Part-no [Optional]: The part number.
	
	Name of this element in the application: “Part Number”
		
	Valid Values: Any string, or you can select any existing contact record. 

Version [Optional] : Version of the office electronic item.
	
	Name of this element in the application : "Version"
	
	Valid Values: Any string.
	
Model [Optional]: the model of the office electronic. 

	Name of this element in the application: This field seems to be hidden.

	Valid Values: Any string. 

Updated-by [Optional] : the name of the person that has updated the record. 

	This field is maintained by application. The value can be any string.

	Default value: the user who had updated the record (e.g., “falcon”.)

subtype [Optional] : The subtype for a selected configuration item type. 

	Name of this element in the application: CI Subtype.
	
Valid Values: this is customizable and we can add/delete more subtypes. Currently there are following subtypes for the “office electronic” configuration item type. 

	Copy Machine
	Printer
	Fax Machine
	Paper Shredder
	Camera
	Speaker
	Calculator
	Multifunction
	Word Processer
	Typewriter
	VCR
	Television
	UPS
	Net Printer
	
Building [Optional]: The building.

	Name of this element in the application:  Location &gt; Building.

	Valid Values: Any string.

Floor[Optional]: The floor related to the location. 
	
	Name of this element in the application: Location &gt; Floor.

	Valid Values: Any string. 

Room[Optional]: the room information. 

	Name of this element in the application: Location &gt; Room.

	Valid Values: Any string. 

System-down[Optional]: this tell whether the system is down or not. 

	Name of this element in the application: the field seems to be hidden.

	Valid Values: true/ false. 
	True -&gt; system is down, false -&gt; system is not down. 

	Default Value: false.

Asset-tag [Optional]: the asset tag for the record. 

	Name of this element in the application: Asset Tag.

	Valid Values: Any string.

Company[Optional]: Company name. 

	Name of this field in the application: Hidden.
	
	Valid Values: Any string. 

Sysmodtime [Optional]: The system time. 

	Name of this element in the application: Hidden. 

	Valid Values: Any input in DateTime format. 

	Default Value: Date of creation of the record. 

Sysmoduser [Optional]: (Not Writable) The system user. 

	Name of this element in the application: Hidden. 

	Valid Value: Any string. 

	Default Value: the user who is using the service (eg, falcon)

Sysmodcount [Optional]: Some count. 

	Name of this element in the application: Hidden. 

	Valid Values: Any decimal value, or more precisely natural number. 

	Default Value: 0

Environment [Optional]: The environment of the office electronic item.

	Name of this element in the application : Environment

	Valid Values :
	Development
	Test
	Production
	Failover
	None
	
Owner [Optional] : Owner department of the office electronic item.
	
	Name of this element in the application : Owner
                  
	Valid Values : Any valid department in the application.  The list can be customized using the appilcation.

Default-impact [Optional]: Default impact of the office electronic item.

	Name of this element in the application : Default Impact
	
	Valid Values :
	1 - Enterprise
	2 - Site / Dept
	3 - Multiple Users
	4 - User

Title [Optional] : The title for the office electronic item.
		
	Name of this element in the application : Title
	
	Valid Values : Any String
	
Problem-priority [Optional] : The priority of the office electronic item.
	
	Name of this element in the application : Priority
	
	Valid Values :
	1 - Critical
	2 - High
	3 - Average
	4 - Low

Id [Optional] : Specifies the ID of the office electronic item.
	
	Name of this element in the application : CI Identifier
	
	Valid Values : Any Unique String

File-officeelectronics [Required]: It's a structure type element.  A structure type element looks like follows :

&lt;structure-type-element&gt;
	&lt;type&gt;structure&lt;/structure&gt;
	
	&lt;!-- here multiple children can exist, each one show one field of structure "structure-type-element" --&gt;
	
&lt;/structure-type-element&gt;</description>
        <from>items</from>
        <to>items</to>
      </input>
      <input global="false" required="false">
        <description>Provide username/password in form of xml. 

This input parameter is required when the user wants to override the default values for username and password provided in the adapter configuration. This is required for cases where an operation cannot be executed with the default username/password provided in the adapter configuration and only user with special permissions can execute the operation. Examples of such operations can be - 'approve-change', 'deny-change', 'close-change', 'approve-task'

Sample XML Format: 

&lt;connection-parameters&gt;
	&lt;alternate-username&gt;USERNAME&lt;/alternate-username&gt;
	&lt;alternate-password&gt;PASSWORD&lt;/alternate-password&gt;
&lt;/connection-parameters&gt;</description>
        <from>connection parameters</from>
        <to>connection parameters</to>
      </input>
      <output global="false" required="false">
        <description>The adapter response containing the results. </description>
        <to>adapter response</to>
        <from>adapter response</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <switch>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <execute-all-applicable-cases>false</execute-all-applicable-cases>
        <default>
          <sequence>
            <call-process>
              <process-name>:AO-AD-HP_ServiceManager:Utilities:Operation Name Error Reporting</process-name>
              <parameters>
                <input>
                  <value>update-office-electronic</value>
                  <to>operation name</to>
                </input>
                <input>
                  <from>items</from>
                  <to>items</to>
                </input>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[1]:call-process[1]</location>
            </call-process>
          </sequence>
        </default>
        <case>
          <condition>
            <document>
              <input>
                <from>items</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[(//operation-name)[1]/text() = 'update-office-electronic']]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <assign>
              <assignment>
                <document>
                  <input>
                    <from>items</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>items</to>
                  </output>
                </result>
                <xslt-stylesheet>
                  <stylesheet-replacement-tokens />
                  <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <items>
      <xsl:for-each select="//item">
        <item>
          <entity-type>
            <xsl:text disable-output-escaping="no">office-electronic</xsl:text>
          </entity-type>
          <xsl:copy-of select="./*" />
        </item>
      </xsl:for-each>
    </items>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                </xslt-stylesheet>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:assign[1]</location>
            </assign>
            <call-process>
              <process-name>:AO-AD-HP_ServiceManager:Utilities:Configuration_Management:Update Configuration Item Utility</process-name>
              <parameters>
                <input>
                  <from>adapter name</from>
                  <to>adapter name</to>
                </input>
                <input>
                  <from>items</from>
                  <to>items</to>
                </input>
                <input>
                  <from>connection parameters</from>
                  <to>connection parameters</to>
                </input>
                <output>
                  <from>adapter response</from>
                  <to>adapter response</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:call-process[1]</location>
            </call-process>
          </sequence>
        </case>
        <location>:switch[1]</location>
      </switch>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>Update Office Electronic
 
This wrapper updates ‘Office Electronic’ record via the application. The application saves this record into its repository which can later be used.

</description>
        <version>1.0</version>
      </documentation>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>1877a473-f3a6-3b8b-973b-4c67b1360164</process-id>
      <author />
      <category />
      <status />
      <keywords />
      <systems />
      <last-modified-by />
      <last-modified>1290594394330</last-modified>
    </meta>
  </process-def>
</process>