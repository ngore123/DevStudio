<process draft="false" dev-studio-version="7.6.01.02">
  <process-def name=":AO-AD-HP_ServiceManager:v7.1:Configuration_Management:Update Location">
    <parameters>
      <input global="false" required="false">
        <description>The name of the adapter to use to handle the request. Default adapter name: HPSMActor.</description>
        <from>adapter name</from>
        <to>adapter name</to>
      </input>
      <input global="false" required="true">
        <description>The items for the adapter request. This should be an XML document with a root element named "items" having multiple child "item" elements, which should contain the data necessary to execute the specific request. 


Update Location 

This wrapper updates a 'Location'.

Sample Item Xml: 

&lt;items&gt;
	&lt;item&gt;
		&lt;operation-name&gt;update-location&lt;/operation-name&gt;
		&lt;model&gt;
		  &lt;keys&gt;
			&lt;location&gt;
			  &lt;value&gt;MyLocation25&lt;/value&gt;
			  &lt;type&gt;String&lt;/type&gt;
			&lt;/location&gt;
		  &lt;/keys&gt;
		  &lt;instance&gt;
			&lt;location&gt;
			  &lt;value&gt;MyLocation25&lt;/value&gt;
			  &lt;type&gt;String&lt;/type&gt;
			&lt;/location&gt;
			&lt;location-name&gt;
			  &lt;value&gt;Location Name-updated&lt;/value&gt;
			  &lt;type&gt;String&lt;/type&gt;
			&lt;/location-name&gt;
			
			&lt;address&gt;
			  &lt;type&gt;Array&lt;/type&gt;
			  &lt;address&gt;
				&lt;element&gt;
				  &lt;value&gt;Address&lt;/value&gt;
				  &lt;type&gt;String&lt;/type&gt;
				&lt;/element&gt;
			  &lt;/address&gt;
			&lt;/address&gt;
			&lt;city&gt;
			  &lt;value&gt;City&lt;/value&gt;
			  &lt;type&gt;String&lt;/type&gt;
			&lt;/city&gt;
			&lt;state&gt;
			  &lt;value&gt;State&lt;/value&gt;
			  &lt;type&gt;String&lt;/type&gt;
			&lt;/state&gt;
			&lt;zip&gt;
			  &lt;value&gt;zip&lt;/value&gt;
			  &lt;type&gt;String&lt;/type&gt;
			&lt;/zip&gt;
			&lt;primary-contact&gt;
			  &lt;value&gt;primary contact&lt;/value&gt;
			  &lt;type&gt;String&lt;/type&gt;
			&lt;/primary-contact&gt;
			&lt;phone&gt;
			  &lt;value&gt;Phone&lt;/value&gt;
			  &lt;type&gt;String&lt;/type&gt;
			&lt;/phone&gt;
			&lt;location-open-time&gt;
			  &lt;value&gt;11:00:00&lt;/value&gt;
			  &lt;type&gt;Time&lt;/type&gt;
			&lt;/location-open-time&gt;
			&lt;location-closing-time&gt;
			  &lt;value&gt;12:00:00&lt;/value&gt;
			  &lt;type&gt;Time&lt;/type&gt;
			&lt;/location-closing-time&gt;
			&lt;primary-contact-department&gt;
			  &lt;value&gt;primary contact department&lt;/value&gt;
			  &lt;type&gt;String&lt;/type&gt;
			&lt;/primary-contact-department&gt;
			&lt;location-code&gt;
			  &lt;value&gt;Location Code&lt;/value&gt;
			  &lt;type&gt;String&lt;/type&gt;
			&lt;/location-code&gt;
			&lt;comments&gt;
			  &lt;type&gt;Array&lt;/type&gt;
			  &lt;comments&gt;
				&lt;element&gt;
				  &lt;value&gt;Comment line 1&lt;/value&gt;
				  &lt;type&gt;String&lt;/type&gt;
				&lt;/element&gt;
				&lt;element&gt;
				  &lt;value&gt;Comment line 2&lt;/value&gt;
				  &lt;type&gt;String&lt;/type&gt;
				&lt;/element&gt;
			  &lt;/comments&gt;
			&lt;/comments&gt;
			&lt;country&gt;
			  &lt;value&gt;Country&lt;/value&gt;
			  &lt;type&gt;String&lt;/type&gt;
			&lt;/country&gt;
			&lt;email&gt;
			  &lt;value&gt;Email&lt;/value&gt;
			  &lt;type&gt;String&lt;/type&gt;
			&lt;/email&gt;
			&lt;company&gt;
			  &lt;value&gt;Company&lt;/value&gt;
			  &lt;type&gt;String&lt;/type&gt;
			&lt;/company&gt;
			&lt;site-category&gt;
			  &lt;value&gt;A&lt;/value&gt;
			  &lt;type&gt;String&lt;/type&gt;
			&lt;/site-category&gt;
			&lt;/instance&gt;
		&lt;/model&gt;
	&lt;/item&gt;
&lt;/items&gt;

Elements’ Description: 

Update Process takes place as follows:-

The record is fetched by the information provided in the &lt;keys&gt; element. 

Once the record is found, the fields are updated by the information provided in &lt;instance&gt; element. i.e., the respective fields of located record are replaced by the elements’ values that are provided in &lt;instance&gt; element.

NOTE: While locating a record, complete matching of key is required. This means if you give key value to be “abc” and there is a record in the application repository which has key element as “abc123” then this record will not be located for the update.
 
Modification/Update in located record is done in following manner-

Suppose a random element exists with name &lt;random-element&gt; which has an 'fieldValue1' as its value. i.e. on retrieving, we'll get.

&lt;instance&gt;
	...
	...
	
	&lt;random-element&gt;
		&lt;value&gt;fieldValue1&lt;/value&gt;
		&lt;type&gt;fieldType&lt;type&gt;
	&lt;/random-element&gt;
	...
	...
&lt;/instance&gt;

See following cases of updation-


Case-1:
&lt;instance&gt;
&lt;/instance&gt;

i.e., we don't provide even the element &lt;random-element&gt;
Result: the field is not updated.

Case-2:
&lt;instance&gt;
	&lt;random-element&gt;
		&lt;value&gt;&lt;/value&gt;
		&lt;type&gt;fieldType&lt;type&gt;
	&lt;/random-element&gt;
&lt;/instance&gt;

i.e., we don't provide anything inside &lt;value&gt; element (child of element &lt;random-element&gt;.)
Result: the field gets None, i.e. not updated.

Case-3:
&lt;instance&gt;
	&lt;random-element&gt;
		&lt;value&gt; &lt;/value&gt;
		&lt;type&gt;fieldType&lt;type&gt;
	&lt;/random-element&gt;
&lt;/instance&gt;

i.e., we provide an space character " " (or more contiguous space characters, like "   ") inside &lt;value&gt; element (child of element &lt;random-element&gt;.)
Result: the field gets updated, and the field &lt;random-elements&gt; is set to blank ""(compare with space character " ".)


Case-4:
&lt;instance&gt;
	&lt;random-element&gt;
		&lt;value&gt;fieldValue2&lt;/value&gt;
		&lt;type&gt;fieldType&lt;type&gt;
	&lt;/random-element&gt;
&lt;/instance&gt;

i.e., we provide "fieldValue2" inside &lt;value&gt; element (child of element &lt;random-element&gt;.)
Result: the value "fieldValue2" is set to field of &lt;random-element&gt;. 

NOTE: One can update the key elements too. Required elements cannot be set to blank.

Complete Elements’ Description: 

item [Required]:
	This is a child of &lt;items&gt;. This &lt;item&gt; tag can be multiple times to support "multiple items support". 

operation-name [Required]: This is used to specify the operation that needs to be performed.

	Valid values: update-location

model[Required]: It is the parent tag for containing all other tags.
	
keys [Required]: used as a unique identifier of the records by the application.

instance [Required] : It can have several child elements. The children of this element describe fields of a record.

location[Optional]: The location field.

Name of this element in the application: Location.

Valid Values: Any unique string. This is also used as the key.

Default Value: None.

Note: this tag can be child of &lt;keys&gt; and &lt;instance&gt; both. It is a required tag under &lt;keys&gt; and optional tag under &lt;instance&gt;. We provide it under &lt;keys&gt; to locate the 'Location' to be updated and we provide it under &lt;instance&gt; to specify the new desired value of &lt;location&gt; tag to be updated. 

location-name[Optional]: The location name field.

	Name of this element in the application: Location Name.

	Valid Values: Any string.

	Default Value: None.

address [Optional]: It's an array type element. An array type element is looks like-


&lt;array-type-element&gt;
	&lt;type&gt;array&lt;/type&gt;
	&lt;array-type-element&gt;

		&lt;!-- here multiple child elements can exist. each with name "element" --&gt;
		&lt;element&gt;&lt;/element&gt;
		&lt;element&gt;&lt;/element&gt;
		&lt;element&gt;&lt;/element&gt;
		...

	&lt;/array-type-element&gt;
&lt;/array-type-element&gt;

Note: one element shows one line in the address field. 

element [Optional]: Shows one line in the address field. 

	Name of this element in the application: Address.

	Valid Values: Any string. 

	Default Value: None.

city[Optional]: The 'City' field. 

	Name of this element in the application: City.

	Valid Values: Any string. 
	
	Default Values: None.

state[Optional]: The name of state.

	Name of this element in the application: State/ Province.

	Valid Values: Any string. 
	
	Default Value: None.

zip [Optional]: zip code.

	Name of this element in the application: Postal Code.

	Valid Values: Any string. 

	Default value: None.

primary-contact [Optional]: the primary contact. 

	Name of this element in the application: Primary Contact.
	
	Valid Values: Any string.

	Default Value: None.

phone [Optional]: The phone number. 

	Name of this element in the application: Phone. 

	Valid Values: Any string. 

	Default Value: None.

location-open-time [Optional]: The opening time of the location. 

	Name of this element in the application:  Hours (1st field)

	Valid Values: Input in time format HH:MM:SS
	HH -&gt; hour, MM -&gt; min., SS -&gt; sec.

	Default Value: None.

location-closing-time [Optional]: The closing time of the location. 

	Name of this element in the application: Hours (2nd field)

	Valid Values: Input in time format HH:MM:SS
	HH -&gt; hour, MM -&gt; min., SS -&gt; sec.

	Default Value: None.

primary-contact-department [Optional]: The primary contact department. 

	Name of this element in the location: Department. 

	Valid Values: Any string. 

	Default value: None.

location-code[Optional]: The code for the location. 

	Name of this element in the location: Location Code. 

	Valid Values: Any string. 

	Default Value: None.

Comment [Optional]: Related comment. It’s an array type element. An array type element is looks like-

&lt;array-type-element&gt;
	&lt;type&gt;array&lt;/type&gt;
	&lt;array-type-element&gt;

		&lt;!-- here multiple child elements can exist. each with name "element" --&gt;
		&lt;element&gt;&lt;/element&gt;
		&lt;element&gt;&lt;/element&gt;
		&lt;element&gt;&lt;/element&gt;
		...

	&lt;/array-type-element&gt;
&lt;/array-type-element&gt;
	
element[Optional]: This shows one line in the comment filed. 

Name of these elements in the application: Comment (one element shows one line.) 

	Valid Values: Any string.
	
	Default Value: None.

country[Optional]: Country name. 

	Name of this element in the application: Country.

	Valid Values: Any string. 
	
	Default Value: None.

email [Optional]: Email ID. 

	Name of this field in the application: Email. 
	
	Valid Values: Any string. 
	
	Default Value: None.

company[Optional]: Company name. 

	Name of this field in the application: Company.
	
	Valid Values: Any string. 

	Default Value: None.

site-category[Optional]: Category of the place. 

	Name of this element in the application: Site Category. 

	Valid Values: A, B, C, D. 
	A -&gt; Critical Site, B -&gt; Major Site, C -&gt; Satellite Site, D -&gt; Home site. 

Default Value: None. 

</description>
        <from>items</from>
        <to>items</to>
      </input>
      <input global="false" required="false">
        <description>Provide username/password in form of xml. 

This input parameter is required when the user wants to override the default values for username and password provided in the adapter configuration. This is required for cases where an operation cannot be executed with the default username/password provided in the adapter configuration and only user with special permissions can execute the operation. Examples of such operations can be - 'approve-change', 'deny-change', 'close-change', 'approve-task'

Sample XML Format: 

&lt;connection-parameters&gt;
	&lt;alternate-username&gt;USERNAME&lt;/alternate-username&gt;
	&lt;alternate-password&gt;PASSWORD&lt;/alternate-password&gt;
&lt;/connection-parameters&gt;</description>
        <from>connection parameters</from>
        <to>connection parameters</to>
      </input>
      <output global="false" required="false">
        <description>The adapter response containing the results. </description>
        <to>adapter response</to>
        <from>adapter response</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <switch>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <execute-all-applicable-cases>false</execute-all-applicable-cases>
        <default>
          <sequence>
            <call-process>
              <process-name>:AO-AD-HP_ServiceManager:Utilities:Operation Name Error Reporting</process-name>
              <parameters>
                <input>
                  <value>update-location</value>
                  <to>operation name</to>
                </input>
                <input>
                  <from>items</from>
                  <to>items</to>
                </input>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[1]:call-process[1]</location>
            </call-process>
          </sequence>
        </default>
        <case>
          <condition>
            <document>
              <input>
                <from>items</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[(//operation-name)[1]/text() = 'update-location']]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <assign>
              <assignment>
                <document>
                  <input>
                    <from>items</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>items</to>
                  </output>
                </result>
                <xslt-stylesheet>
                  <stylesheet-replacement-tokens />
                  <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <items>
      <xsl:for-each select="//item">
        <item>
          <entity-type>
            <xsl:text disable-output-escaping="no">location</xsl:text>
          </entity-type>
          <xsl:copy-of select="./*" />
        </item>
      </xsl:for-each>
    </items>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                </xslt-stylesheet>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:assign[1]</location>
            </assign>
            <call-process>
              <process-name>:AO-AD-HP_ServiceManager:Utilities:Configuration_Management:Update Configuration Item Utility</process-name>
              <parameters>
                <input>
                  <from>adapter name</from>
                  <to>adapter name</to>
                </input>
                <input>
                  <from>items</from>
                  <to>items</to>
                </input>
                <input>
                  <from>connection parameters</from>
                  <to>connection parameters</to>
                </input>
                <output>
                  <from>adapter response</from>
                  <to>adapter response</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:call-process[1]</location>
            </call-process>
          </sequence>
        </case>
        <location>:switch[1]</location>
      </switch>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>
This wrapper updates a 'Location'.
</description>
        <version>1.0</version>
      </documentation>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>5cd5cff4-70b7-3273-bf03-264d2821ed91</process-id>
      <author />
      <category />
      <status />
      <keywords />
      <systems />
      <last-modified-by />
      <last-modified>1290594390440</last-modified>
    </meta>
  </process-def>
</process>