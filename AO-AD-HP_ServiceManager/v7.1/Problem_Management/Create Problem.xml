<process draft="false" dev-studio-version="7.6.01.02">
  <process-def name=":AO-AD-HP_ServiceManager:v7.1:Problem_Management:Create Problem">
    <parameters>
      <input global="false" required="false">
        <description>            The name of the adapter to use to handle the request. Default adapter name: HPSMActor. 
</description>
        <from>adapter name</from>
        <to>adapter name</to>
      </input>
      <input global="false" required="true">
        <description>The items for the adapter request. This should be an XML document with a root element named "items" having a child "item", which should contain the data necessary to execute the specific request. To execute multiple item, give multiple &lt;item&gt; element in the &lt;items&gt; element. 


Create Problem: 

This wrapper create a problem record.

Sample Item Xml: 

&lt;items&gt;
	&lt;item&gt;
		&lt;operation-name&gt;create-problem&lt;/operation-name&gt;
		&lt;model&gt;
			&lt;keys&gt;
				&lt;id&gt;
					&lt;value&gt;PM10071&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/id&gt;
			&lt;/keys&gt;
			&lt;instance&gt;
				&lt;id&gt;
					&lt;value&gt;PM00071&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/id&gt;

				&lt;subcategory&gt;
					&lt;value&gt;hardware&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/subcategory&gt;
				&lt;product-type&gt;
					&lt;value&gt;missing or stolen&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/product-type&gt;
				&lt;problem-type&gt;
					&lt;value&gt;none&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/problem-type&gt;
				&lt;initial-impact&gt;
					&lt;value&gt;2&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/initial-impact&gt;
				&lt;severity&gt;
					&lt;value&gt;2&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/severity&gt;
				&lt;description&gt;
					&lt;type&gt;Array&lt;/type&gt;
					&lt;description&gt;
						&lt;element&gt;
							&lt;value&gt;description line 1&lt;/value&gt;
							&lt;type&gt;String&lt;/type&gt;
						&lt;/element&gt;
						&lt;element&gt;
							&lt;value&gt;description line 2&lt;/value&gt;
							&lt;type&gt;String&lt;/type&gt;
						&lt;/element&gt;
					&lt;/description&gt;
				&lt;/description&gt;
				&lt;assignment&gt;
					&lt;value&gt;E-mail / Webmail (Europe)&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/assignment&gt;
				&lt;category&gt;
					&lt;value&gt;BPPM&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/category&gt;
				&lt;status&gt;
					&lt;value&gt;Status&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/status&gt;
				&lt;brief-description&gt;
					&lt;value&gt;brief description&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/brief-description&gt;
				
				&lt;affected-item&gt;
					&lt;value&gt;Intranet / Internet (North America)&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/affected-item&gt;
				&lt;root-cause&gt;	
					&lt;type&gt;Array&lt;/type&gt;
					&lt;root-cause&gt;
						&lt;element&gt;
							&lt;value&gt;root cause line 1&lt;/value&gt;
							&lt;type&gt;String&lt;/type&gt;
						&lt;/element&gt;
						&lt;element&gt;
							&lt;value&gt;root cause line 2&lt;/value&gt;
							&lt;type&gt;String&lt;/type&gt;
						&lt;/element&gt;
					&lt;/root-cause&gt;
				&lt;/root-cause&gt;
				&lt;update&gt;
					&lt;type&gt;Array&lt;/type&gt;
					&lt;update&gt;
						&lt;element&gt;
							&lt;value&gt;update line 1&lt;/value&gt;
							&lt;type&gt;String&lt;/type&gt;
						&lt;/element&gt;
						&lt;element&gt;
							&lt;value&gt;update line 2&lt;/value&gt;
							&lt;type&gt;String&lt;/type&gt;
						&lt;/element&gt;
					&lt;/update&gt;
				&lt;/update&gt;
				&lt;open&gt;
					&lt;value&gt;true&lt;/value&gt;
					&lt;type&gt;Boolean&lt;/type&gt;
				&lt;/open&gt;
				&lt;opened-by&gt;
					&lt;value&gt;opened by&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/opened-by&gt;
				
				&lt;updated-by&gt;
					&lt;value&gt;updated by&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/updated-by&gt;
				
				&lt;closed-by&gt;
					&lt;value&gt;closed by&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/closed-by&gt;
				
				&lt;reopened-by&gt;
					&lt;value&gt;reopened by&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/reopened-by&gt;
				&lt;priority-code&gt;
					&lt;value&gt;1&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/priority-code&gt;

				&lt;sysmodcount&gt;
					&lt;value&gt;2&lt;/value&gt;
					&lt;type&gt;Decimal&lt;/type&gt;
				&lt;/sysmodcount&gt;
				&lt;sysmoduser&gt;
					&lt;value&gt;sysmoduser&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/sysmoduser&gt;
				&lt;assignee-name&gt;
					&lt;value&gt;assignee name&lt;/value&gt;
					&lt;type&gt;String&lt;/type&gt;
				&lt;/assignee-name&gt;
				&lt;workaround&gt;
					&lt;type&gt;workaround&lt;/type&gt;
					&lt;workaround&gt;
						&lt;element&gt;
							&lt;value&gt;workaround line 1&lt;/value&gt;
							&lt;type&gt;String&lt;/type&gt;
						&lt;/element&gt;
						&lt;element&gt;
							&lt;value&gt;workaround line 2&lt;/value&gt;
							&lt;type&gt;String&lt;/type&gt;
						&lt;/element&gt;
					&lt;/workaround&gt;
				&lt;/workaround&gt;
				
			&lt;/instance&gt;
		&lt;/model&gt;
	&lt;/item&gt;
&lt;/items&gt;


Elements’ Description:  

Operation-name[Required]: 
	Valid value: create-problem

model[Required]: It is the parent tag for containing all other tags.

keys [Required]: used to uniquely identify the record. 

Instance [Required]: It can have many children. The children of this element describe fields of a record.

Id [Optional]: unique id for the application.
Name of this element in the application: Problem ID
Valid values: any unique string. 
Default value: system generated unique string.

product-type [Required]:
Name of this element in the application: Problem Detail &gt; Subarea
Valid values : Any valid product type

subcategory [Required]:
Name of this element in the application: Problem Detail &gt; Area
Valid values : Any valid subcategory

category [Optional]:
Name of this element in the application: Hidden.
Valid values : Any valid category

problem-type [Optional]:
Name of this element in the application: Hidden
Valid values : Any valid problem type

Initial-impact [Required]:
Name of this element in the application: Problem Detail &gt; Impact
Valid values: 1, 2, 3, 4. 
1 &gt; Enterprise, 2 &gt; Site/Dept, 3 &gt; Multiple User, 4 &gt; User.

Severity[Required]:
Name of this element in the application: Problem Detail &gt; Urgency
Valid values: 1, 2, 3, 4.
1 &gt; critical, 2 &gt; high, 3 &gt; average, 4 &gt; low.

Description [Required]:
Name of this element in the application: Description 
Valid values: It’s an array type element with each of its element can take String as input. 

Assignment [Required]:
Name of this element in the application: Assignment Group 
Valid values: one of list of assignment group.

status [Optional]: 
Name of this element in the application: Hidden.
This field is set by application. The possible status are- open, closed, updated, assigned, work-in-progress, cancelled etc.
Default value: Open.

brief-description [Required]:
Name of this element in the application: Title
Valid values: any string.

Note : This field is optional in WebService API but required in the Application. If you do not specify its value the adapter request will be executed without any error. But as it's required on application, so it's recommended that you provide a value for this field.

affected-item [Required]:
Name of this element in the application: Service
Valid values: any valid value for Service in Affected Items

root-cause [Optional]:
Name of this element in the application: Root Cause Description
Valid values: It's an array type element with each element can have any string value.
Default value: “”.

update [Optional]:
Name of this element in the application: Activities &gt; Journal Updates
Valid values: It's an array type element with each element can have any string value.
Defaut value: “”.

open [Optional]: 
Name of this element in the application: Hidden.
Valid values: this field is maintained by application. Possible values of it are true or false.
Default value: true

Opened-by [Optional]:
Name of this element in the application: History &gt; Opened (first column 'By')
Valid values: any string.
Default value: Current user logged in (e.g., ”falcon”.)

updated-by [Optional]:
Name of this element in the application: History &gt; Last Updated (first column 'By')  
Valid Values: This field is maintained by application. The value can be any string.
Default value: the user who has updated the record (e.g., “falcon”.)

Closed-by [Optional]: 
Name of this element in the application: History &gt; Closed (first column 'By') 
Valid Values: This field is maintained by application itself. Possible values are string type.
Default value: the user who has closed the record (e.g., “falcon”.)

Reopened-by [Optional]:
Name of this element in the application: History &gt; Reopened (first column 'By') 
Valid values: any stirng.
Default value: the user who has reopened the record. 

Priority-code [Optional]: 
Name of this element in the application: Problem Detail &gt; Priority.
Valid values: This element is maintained by application. Its value is same as that of &lt;initial-impact&gt; element.

Sysmodcount [Optional]: 
Name of this element in the application: Hidden.
Valid values: This element is maintained by application. It's of “String” type.
Default value: 0

sysmoduser [Optional]: 
Name of this element in the application: Hidden.
This element is maintained by application. It's of string. Type. 
Default value: the webservice user (e.g., “falcon”.)


assignee-name [Optional]: 
Name of this element in the application: Problem Coordinator
Valid values: Any string. 
Default value: “”.

workaround [Optional]:
Name of this element in the application: Suggested Workaround
Valid values: it's an array type element with each of its element of string type. 
Default value: “”.
</description>
        <from>items</from>
        <to>items</to>
      </input>
      <input global="false" required="false">
        <description>Provide username/password in form of xml. 

This input parameter is required when the user wants to override the default values for username and password provided in the adapter configuration. This is required for cases where an operation cannot be executed with the default username/password provided in the adapter configuration and only user with special permissions can execute the operation. Examples of such operations can be - 'approve-change', 'deny-change', 'close-change', 'approve-task'

Sample XML Format: 

&lt;connection-parameters&gt;
	&lt;alternate-username&gt;USERNAME&lt;/alternate-username&gt;
	&lt;alternate-password&gt;PASSWORD&lt;/alternate-password&gt;
&lt;/connection-parameters&gt;</description>
        <from>connection parameters</from>
        <to>connection parameters</to>
      </input>
      <output global="false" required="false">
        <description> The adapter response containing the results. </description>
        <to>adapter response</to>
        <from>adapter response</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <switch>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <execute-all-applicable-cases>false</execute-all-applicable-cases>
        <default>
          <sequence>
            <call-process>
              <process-name>:AO-AD-HP_ServiceManager:Utilities:Operation Name Error Reporting</process-name>
              <parameters>
                <input>
                  <value>create-problem</value>
                  <to>operation name</to>
                </input>
                <input>
                  <from>items</from>
                  <to>items</to>
                </input>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[1]:call-process[1]</location>
            </call-process>
          </sequence>
        </default>
        <case>
          <condition>
            <document>
              <input>
                <from>items</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[(//operation-name)[1]/text() = 'create-problem']]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <call-process>
              <process-name>:AO-AD-HP_ServiceManager:Utilities:Set Default Adapter Name</process-name>
              <parameters>
                <input>
                  <from>adapter name</from>
                  <to>adapter name</to>
                </input>
                <output>
                  <from>adapter name</from>
                  <to>adapter name</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:call-process[1]</location>
            </call-process>
            <assign>
              <assignment>
                <document>
                  <input>
                    <from>items</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>request element</to>
                  </output>
                </result>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[concat((//operation-name)[1], "-request")]]></xpath>
                </xpath-expression>
              </assignment>
              <assignment>
                <document>
                  <input>
                    <from>connection parameters</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>username</to>
                  </output>
                </result>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[(//alternate-username)[1]/text()]]></xpath>
                </xpath-expression>
              </assignment>
              <assignment>
                <document>
                  <input>
                    <from>connection parameters</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>password</to>
                  </output>
                </result>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[(//alternate-password)[1]/text()]]></xpath>
                </xpath-expression>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:assign[1]</location>
            </assign>
            <assign>
              <assignment>
                <document>
                  <input>
                    <from>items</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>adapter request</to>
                  </output>
                </result>
                <xslt-stylesheet>
                  <stylesheet-replacement-tokens>
                    <replacement-token name="items">
                      <input global="false">
                        <from>items</from>
                      </input>
                    </replacement-token>
                    <replacement-token name="request element">
                      <input global="false">
                        <from>request element</from>
                      </input>
                    </replacement-token>
                    <replacement-token name="username">
                      <input global="false">
                        <from>username</from>
                      </input>
                    </replacement-token>
                    <replacement-token name="password">
                      <input global="false">
                        <from>password</from>
                      </input>
                    </replacement-token>
                  </stylesheet-replacement-tokens>
                  <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <request-data>
      <hp-service-manager-request>
        <xsl:if test="username/text() != &quot;&quot;">
          <username>${username}</username>
        </xsl:if>
        <xsl:if test="password/text() != &quot;&quot;">
          <password>${password}</password>
        </xsl:if>
        <entity>
          <xsl:text disable-output-escaping="no">problem</xsl:text>
        </entity>
        <entity-type>
          <xsl:copy-of select="(//entity-type)[1]/text()" />
        </entity-type>
        <request>
          <operation-name>
            <xsl:copy-of select="(//operation-name)[1]/text()" />
          </operation-name>
          <xsl:for-each select="/items/item">
            <parameters>
              <xsl:element name="${request element}">
                <xsl:copy-of select="./model" />
              </xsl:element>
            </parameters>
          </xsl:for-each>
        </request>
      </hp-service-manager-request>
    </request-data>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                </xslt-stylesheet>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:assign[2]</location>
            </assign>
            <call-adapter>
              <parameters>
                <input global="false">
                  <from>adapter name</from>
                </input>
                <input>
                  <value>
                    <adapter-request>
                      <peer-location>
                        <location>any</location>
                      </peer-location>
                      <request-action>invoke</request-action>
                    </adapter-request>
                  </value>
                </input>
                <input global="false">
                  <from>adapter request</from>
                </input>
                <input global="false">
                  <from>adapter request</from>
                </input>
                <output global="false">
                  <to>adapter response</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <before-execution>
                <log>
                  <level>debug</level>
                  <parameters>
                    <input>
                      <value>Adapter Request:</value>
                    </input>
                    <input>
                      <from>adapter request</from>
                    </input>
                    <input>
                      <from>adapter name</from>
                    </input>
                  </parameters>
                </log>
              </before-execution>
              <after-execution>
                <log>
                  <level>debug</level>
                  <parameters>
                    <input>
                      <value>Adapter Response:</value>
                    </input>
                    <input>
                      <from>adapter response</from>
                    </input>
                  </parameters>
                </log>
              </after-execution>
              <location>:switch[1]:sequence[2]:call-adapter[1]</location>
            </call-adapter>
          </sequence>
        </case>
        <location>:switch[1]</location>
      </switch>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>Create Problem: 

This wrapper creates a problem.</description>
        <version>1.0</version>
      </documentation>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>105dd871-6e89-38ba-b443-bcf15069afa6</process-id>
      <author />
      <category />
      <status />
      <keywords />
      <systems />
      <last-modified-by />
      <last-modified>1290594404377</last-modified>
    </meta>
  </process-def>
</process>