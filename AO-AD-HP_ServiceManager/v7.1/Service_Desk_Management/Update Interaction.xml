<process draft="false" dev-studio-version="7.6.01.02">
  <process-def name=":AO-AD-HP_ServiceManager:v7.1:Service_Desk_Management:Update Interaction">
    <parameters>
      <input global="false" required="false">
        <description>            The name of the adapter to use to handle the request. Default adapter name: HPSMActor. 
</description>
        <from>adapter name</from>
        <to>adapter name</to>
      </input>
      <input global="false" required="true">
        <description>The items for the adapter request. This should be an XML document with a root element named "items" having a child "item", which should contain the data necessary to execute the specific request. To execute multiple item, give multiple &lt;item&gt; element in the &lt;items&gt; element. 

Update Interaction 

This wrapper updates an interaction record.
Sample Item Xml:  

&lt;items&gt;
	&lt;item&gt;
		&lt;operation-name&gt;update-interaction&lt;/operation-name&gt;
          &lt;model&gt;
            &lt;keys&gt;
              &lt;call-i-d&gt;
                &lt;value&gt;Incident1005&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/call-i-d&gt;
            &lt;/keys&gt;
            &lt;instance&gt;
              &lt;callback-contact&gt;
                &lt;value&gt;FALCON&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/callback-contact&gt;
              &lt;notify-by&gt;
                &lt;value&gt;notify by&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/notify-by&gt;
              &lt;category&gt;
                &lt;value&gt;incident&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/category&gt;
              &lt;subcategory&gt;
                &lt;value&gt;performance&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/subcategory&gt;
              &lt;product-type&gt;
                &lt;value&gt;system or application hangs&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/product-type&gt;
              &lt;problem-type&gt;
                &lt;value&gt;none&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/problem-type&gt;
              &lt;initial-impact&gt;
                &lt;value&gt;1&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/initial-impact&gt;
              &lt;severity&gt;
                &lt;value&gt;1&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/severity&gt;
			  &lt;title&gt;
                     &lt;value&gt;test title 2&lt;/value&gt;
	                &lt;type&gt;String&lt;/type&gt;
              &lt;/title&gt;
              &lt;description&gt;
                &lt;type&gt;Array&lt;/type&gt;
                &lt;description&gt;
                  &lt;element&gt;
                    &lt;value&gt;description line 1&lt;/value&gt;
                    &lt;type&gt;String&lt;/type&gt;
                  &lt;/element&gt;
                  &lt;element&gt;
                    &lt;value&gt;description line 2&lt;/value&gt;
                    &lt;type&gt;String&lt;/type&gt;
                  &lt;/element&gt;
                &lt;/description&gt;
              &lt;/description&gt;
			  &lt;service&gt;
                &lt;value&gt;&lt;![CDATA[Handheld, PDA &amp; Telephony]]&gt;&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/service&gt;
              &lt;call-owner&gt;
                &lt;value&gt;Call owner&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/call-owner&gt;
              &lt;status&gt;
                &lt;value&gt;Status&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/status&gt;
              &lt;caller-department&gt;
                &lt;value&gt;caller deparment&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/caller-department&gt;
              &lt;knowledge-candidate&gt;
                &lt;value&gt;true&lt;/value&gt;
                &lt;type&gt;Boolean&lt;/type&gt;
              &lt;/knowledge-candidate&gt;
              &lt;SLAAgreement-i-d&gt;
                &lt;value&gt;1&lt;/value&gt;
                &lt;type&gt;Int&lt;/type&gt;
              &lt;/SLAAgreement-i-d&gt;
              &lt;priority&gt;
                &lt;value&gt;1&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/priority&gt;
              &lt;failed-entitlement&gt;
                &lt;value&gt;true&lt;/value&gt;
                &lt;type&gt;Boolean&lt;/type&gt;
              &lt;/failed-entitlement&gt;
              &lt;resolution-code&gt;
                &lt;value&gt;resolution code&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/resolution-code&gt;
              &lt;company&gt;
                &lt;value&gt;company&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/company&gt;
              &lt;contact-name&gt;
                &lt;value&gt;FALCON&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/contact-name&gt;
              &lt;reported-by-contact&gt;
                &lt;value&gt;FALCON&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/reported-by-contact&gt;
              &lt;reported-by-different-contact&gt;
                &lt;value&gt;true&lt;/value&gt;
                &lt;type&gt;Boolean&lt;/type&gt;
              &lt;/reported-by-different-contact&gt;
              &lt;location-full-name&gt;
                &lt;value&gt;location full name&lt;/value&gt;
                &lt;type&gt;String&lt;/type&gt;
              &lt;/location-full-name&gt;
              &lt;entered-by-e-s-s&gt;
                &lt;value&gt;true&lt;/value&gt;
                &lt;type&gt;Boolean&lt;/type&gt;
              &lt;/entered-by-e-s-s&gt;
              &lt;SLABreached&gt;
                &lt;value&gt;true&lt;/value&gt;
                &lt;type&gt;Boolean&lt;/type&gt;
              &lt;/SLABreached&gt;
              &lt;update&gt;
                &lt;type&gt;Array&lt;/type&gt;
                &lt;update&gt;
                  &lt;element&gt;
                    &lt;value&gt;update line 1&lt;/value&gt;
                    &lt;type&gt;String&lt;/type&gt;
                  &lt;/element&gt;
                &lt;/update&gt;
              &lt;/update&gt;             
              &lt;s-l-a-agreement-i-d&gt;
                &lt;value&gt;1&lt;/value&gt;
                &lt;type&gt;Int&lt;/type&gt;
              &lt;/s-l-a-agreement-i-d&gt;
              &lt;s-l-a-breached&gt;
                &lt;value&gt;true&lt;/value&gt;
                &lt;type&gt;Boolean&lt;/type&gt;
              &lt;/s-l-a-breached&gt;
            &lt;/instance&gt;
          &lt;/model&gt;
&lt;/item&gt;
&lt;/items&gt;


Update Process takes place in following manner-

The record is first selected (located) by the information provided in the &lt;keys&gt; element. Essentially, you populate &lt;keys&gt; element with valid key elements otherwise the record wouldn't be located.

Once the record is located properly, the fields are updated by the information provided in &lt;instance&gt; element. That is, the respective fields of located record are replaced by the elements' values that are provided in &lt;instance&gt; element.

NOTE: While locating a record, complete matching of key is required. This means if you give key value to be "abc" and there is a record in the application repository which has key element as "abc123" then this record wouldn't be located for the update (compare with Find Wrappers.)
 
Modification/Update in located record is done in following manner-

Suppose an random element with name &lt;random-element&gt; which has an 'fieldValue1'. i.e. on retrieving, we'll get.

&lt;instance&gt;
...
...

&lt;random-element&gt;
&lt;value&gt;fieldValue1&lt;/value&gt;
&lt;type&gt;fieldType&lt;type&gt;
&lt;/random-element&gt;
...
...
&lt;/instance&gt;

Now see following cases of updation-


Case-1:
&lt;instance&gt;
&lt;/instance&gt;

i.e., we don't provide even the element &lt;random-element&gt;
Result: the field get ignored, i.e. not updated.

Case-2:
&lt;instance&gt;
&lt;random-element&gt;
&lt;value&gt;&lt;/value&gt;
&lt;type&gt;fieldType&lt;type&gt;
&lt;/random-element&gt;
&lt;/instance&gt;

i.e., we don't provide anything inside &lt;value&gt; element (child of element &lt;random-element&gt;.)
Result: the field get ignored, i.e. not updated.

Case-3:
&lt;instance&gt;
&lt;random-element&gt;
&lt;value&gt; &lt;/value&gt;
&lt;type&gt;fieldType&lt;type&gt;
&lt;/random-element&gt;
&lt;/instance&gt;

i.e., we provide an space character " " (or more contiguous space characters, like " ") inside &lt;value&gt; element (child of element &lt;random-element&gt;.)
Result: the field get's updated, and the field &lt;random-elements&gt; is set to blank ""(compare with space character " ".)


Case-4:
&lt;instance&gt;
&lt;random-element&gt;
&lt;value&gt;fieldValue2&lt;/value&gt;
&lt;type&gt;fieldType&lt;type&gt;
&lt;/random-element&gt;
&lt;/instance&gt;

i.e., we provide "fieldValue2" inside &lt;value&gt; element (child of element &lt;random-element&gt;.)
Result: the value "fieldValue2" is set to field of &lt;random-element&gt;.




Elements’ Description:  

item [Required]:
This is a child of &lt;items&gt;. This &lt;item&gt; tag can be multiple times to support "multiple items support". 

model [Required]: It is the parent tag for containing all other tags.

keys [Required]: used to define a search criteria to find a unique interaction record.

Instance [Required]: It can have many child elements. The child elements describe fields of a record.

Operation-name [Required]:
	Valid values: update-interaction

Call-i-d [Required]: 
	Valid values: any unique string.
	Note: with the default setting of the application, this field is not editable.

callback-contact [Optional]:
	Valid values: any valid/existing contact name of contact record.

notify-by [Optional]: 
	Valid values: any string. 
	Default value: Ignored.

service[Optional]:
      Valid values: : Any valid Service value
	  
category [Optional]:
	Valid values: any valid category value.
	Note: with the default setting of the application, this field is not editable.

subcategory [Optional]:
	Name of this tag in the application: Area
	Valid values: any valid subcategory value.
	Note: with the default setting of the application, this field is not editable.

product-type [Optional]:
	Name of this tag in the application: Sub-area
	Valid values: any valid product-type value.
	Note: with the default setting of the application, this field is not editable.

Initial-impact [Optional]:
	Valid values: 1, 2, 3, 4. 
	1 &gt; Enterprise, 2 &gt; Site/Dept, 3 &gt; Multiple User, 4 &gt; User.
	Default value: Ignored.

Severity[Optional]: 
	Valid values: 1, 2, 3, 4.
	1 &gt; critical, 2 &gt; high, 3 &gt; average, 4 &gt; low.
	Default value: Ignored.

Description [Optional]: 
	Valid values: It's an array type of element with each of its element of string type. 
	Default value: Ignored.
	Note: with the default setting of the application, this field is not editable.

title[Optional]:
   Valid values: Any string
	  
call-owner [Optional]:
	This field is maintained by application itself. The possible values are of string type.
	Default value: Ignored.
	
status [Optional]: 
	This field is maintained by application itself. Possible values: open-idle, open-	linked 	etc.
	Default value: Ignored.
	Note: with the default setting of the application, this field is not editable.

caller-department [Optional]: 
	Valid values: any string.
	Default value: Ignored.

knowledge-candidate [Optional]:
	Valid values: true, false.
	Default value: Ignored.

SLAAgreement-i-d [Optional]:
	It refers to element &lt;s-l-a-agreement-i-d&gt;. The type of this field is “Int.”
	Default value: Ignored.

priority [Optional]:
	Valid values: any string.
	Note: with the default setting of the application, this field is not editable.

failed-entitlement [Optional]:
	Valid values: true, false.
	Default value: Ignored.

resolution-code [Optional]:
	Valid values: any string.
	Default value: Ignored.

company [Optional]:
	Valid values: any string.
	Default value: Ignored.

contact-name [Optional]:
	Valid value: any string.
	Default value: Ignored.

reported-by-contact [Optional]:
	Valid values: any string.
	Default value: Ignored.

reported-by-different-contact [Optional]:
	Valid value: true, false.
	Default value: Ignored.

location-full-name [Optional]:
	Valid values: any string.
	Default value: Ignored.
	Note: with the default setting of the application, this field is not editable.

entered-by-e-s-s [Optional]: 
	Valid values: true, false.
	Default value: Ignored.

SLABreached [Optional]: 
	It's referring to element &lt;s-l-a-breached&gt;. Possible values are true or false.
	Default value: same value as that of element &lt;s-l-a-breached&gt;.

Next-s-l-a-breach [Optional]:
	Valid values: any input in “DateTime”.
	Default value: Ignored.

update [Optional]:
	Valid values: It's an array type element with each of its element of “String” type.
	Default value: Ignored.

s-l-a-agreement-i-d [Optional]:
	Valid values: any integer input. 
	Default value: Ignored.

s-l-a-breached [Optional]:
	Valid values: true, false.
	Default value: Ignored.

	Note: For including special characters in String fields , special characters should be wrapped with CDATA tag. Sample:  &lt;value&gt;&lt;![CDATA[Handheld, PDA &amp; Telephony]]&gt;&lt;/value&gt; </description>
        <from>items</from>
        <to>items</to>
      </input>
      <input global="false" required="false">
        <description>Provide username/password in form of xml. 

This input parameter is required when the user wants to override the default values for username and password provided in the adapter configuration. This is required for cases where an operation cannot be executed with the default username/password provided in the adapter configuration and only user with special permissions can execute the operation. Examples of such operations can be - 'approve-change', 'deny-change', 'close-change', 'approve-task'

Sample XML Format: 

&lt;connection-parameters&gt;
	&lt;alternate-username&gt;USERNAME&lt;/alternate-username&gt;
	&lt;alternate-password&gt;PASSWORD&lt;/alternate-password&gt;
&lt;/connection-parameters&gt;</description>
        <from>connection parameters</from>
        <to>connection parameters</to>
      </input>
      <output global="false" required="false">
        <description> The adapter response containing the results. </description>
        <to>adapter response</to>
        <from>adapter response</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <switch>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <execute-all-applicable-cases>false</execute-all-applicable-cases>
        <default>
          <sequence>
            <call-process>
              <process-name>:AO-AD-HP_ServiceManager:Utilities:Operation Name Error Reporting</process-name>
              <parameters>
                <input>
                  <value>update-interaction</value>
                  <to>operation name</to>
                </input>
                <input>
                  <from>items</from>
                  <to>items</to>
                </input>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[1]:call-process[1]</location>
            </call-process>
          </sequence>
        </default>
        <case>
          <condition>
            <document>
              <input>
                <from>items</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[(//operation-name)[1]/text() = 'update-interaction']]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <call-process>
              <process-name>:AO-AD-HP_ServiceManager:Utilities:Set Default Adapter Name</process-name>
              <parameters>
                <input>
                  <from>adapter name</from>
                  <to>adapter name</to>
                </input>
                <output>
                  <from>adapter name</from>
                  <to>adapter name</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:call-process[1]</location>
            </call-process>
            <assign>
              <assignment>
                <document>
                  <input>
                    <from>items</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>request element</to>
                  </output>
                </result>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[concat((//operation-name)[1], "-request")]]></xpath>
                </xpath-expression>
              </assignment>
              <assignment>
                <document>
                  <input>
                    <from>connection parameters</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>username</to>
                  </output>
                </result>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[(//alternate-username)[1]/text()]]></xpath>
                </xpath-expression>
              </assignment>
              <assignment>
                <document>
                  <input>
                    <from>connection parameters</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>password</to>
                  </output>
                </result>
                <xpath-expression>
                  <xpath-replacement-tokens />
                  <xpath><![CDATA[(//alternate-password)[1]/text()]]></xpath>
                </xpath-expression>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:assign[1]</location>
            </assign>
            <assign>
              <assignment>
                <document>
                  <input>
                    <from>items</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>adapter request</to>
                  </output>
                </result>
                <xslt-stylesheet>
                  <stylesheet-replacement-tokens>
                    <replacement-token name="items">
                      <input global="false">
                        <from>items</from>
                      </input>
                    </replacement-token>
                    <replacement-token name="request element">
                      <input global="false">
                        <from>request element</from>
                      </input>
                    </replacement-token>
                    <replacement-token name="username">
                      <input global="false">
                        <from>username</from>
                      </input>
                    </replacement-token>
                    <replacement-token name="password">
                      <input global="false">
                        <from>password</from>
                      </input>
                    </replacement-token>
                  </stylesheet-replacement-tokens>
                  <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <request-data>
      <hp-service-manager-request>
        <xsl:if test="string('${username}') != ''">
          <username>${username}</username>
        </xsl:if>
        <xsl:if test="string('${password}') != ''">
          <password>${password}</password>
        </xsl:if>
        <entity>
          <xsl:text disable-output-escaping="no">servicedesk</xsl:text>
        </entity>
        <entity-type>
          <xsl:copy-of select="(//entity-type)[1]/text()" />
        </entity-type>
        <request>
          <operation-name>
            <xsl:copy-of select="(//operation-name)[1]/text()" />
          </operation-name>
          <xsl:for-each select="/items/item">
            <parameters>
              <xsl:element name="${request element}">
                <xsl:copy-of select="./model" />
              </xsl:element>
            </parameters>
          </xsl:for-each>
        </request>
      </hp-service-manager-request>
    </request-data>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                </xslt-stylesheet>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:assign[2]</location>
            </assign>
            <call-adapter>
              <parameters>
                <input global="false">
                  <from>adapter name</from>
                </input>
                <input>
                  <value>
                    <adapter-request>
                      <peer-location>
                        <location>any</location>
                      </peer-location>
                      <request-action>invoke</request-action>
                    </adapter-request>
                  </value>
                </input>
                <input global="false">
                  <from>adapter request</from>
                </input>
                <input global="false">
                  <from>adapter request</from>
                </input>
                <output global="false">
                  <to>adapter response</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <before-execution>
                <log>
                  <level>debug</level>
                  <parameters>
                    <input>
                      <value>Adapter Request:</value>
                    </input>
                    <input>
                      <from>adapter request</from>
                    </input>
                    <input>
                      <from>adapter name</from>
                    </input>
                  </parameters>
                </log>
              </before-execution>
              <after-execution>
                <log>
                  <level>debug</level>
                  <parameters>
                    <input>
                      <value>Adapter Response:</value>
                    </input>
                    <input>
                      <from>adapter response</from>
                    </input>
                  </parameters>
                </log>
              </after-execution>
              <location>:switch[1]:sequence[2]:call-adapter[1]</location>
            </call-adapter>
          </sequence>
        </case>
        <location>:switch[1]</location>
      </switch>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
      </expose-to>
      <documentation>
        <description>Update Interaction 

This wrapper updates an interaction record.
</description>
        <version>1.0</version>
      </documentation>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>2f2ec513-7f4e-3b7c-ae3f-0f06abbc480b</process-id>
      <author />
      <category />
      <status />
      <keywords />
      <systems />
      <last-modified-by />
      <last-modified>1290594411830</last-modified>
    </meta>
  </process-def>
</process>