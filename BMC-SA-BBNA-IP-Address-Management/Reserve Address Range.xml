<process draft="false" dev-studio-version="7.9.00">
  <process-def name=":BMC-SA-BBNA-IP-Address-Management:Reserve Address Range">
    <parameters>
      <input global="false" required="true">
        <description>range address.</description>
        <from>range address</from>
        <to>range address</to>
      </input>
      <input global="false" required="true">
        <description>Pool details to be reserved.
Format must be in below format...

&lt;pools&gt;
     &lt;pool&gt;
		&lt;pool-address&gt;&lt;/pool-address&gt;
		&lt;pool-mask&gt;&lt;/pool-mask&gt;
     &lt;/pool&gt;
     &lt;pool&gt;
		&lt;pool-address&gt;&lt;/pool-address&gt;
		&lt;pool-mask&gt;&lt;/pool-mask&gt;
     &lt;/pool&gt;
&lt;/pools&gt;</description>
        <from>pools</from>
        <to>pools</to>
      </input>
      <input global="false" required="false">
        <description>scope</description>
        <from>scope</from>
        <to>scope</to>
      </input>
      <input global="false" required="false">
        <from>network bits</from>
        <to>network bits</to>
      </input>
      <output global="false" required="false">
        <description>operation status.
valid values: true, false.</description>
        <to>success</to>
        <from>success</from>
      </output>
      <output global="false" required="false">
        <description>Operation result
Format:
&lt;operation-result&gt;
     &lt;message&gt;error message incase of any error&lt;/message&gt;
     &lt;pool-names&gt;
           &lt; pool-id&gt;xxxx&lt;/ pool-id&gt;
           &lt; pool-id&gt;yyyy&lt;/ pool-id&gt;
           &lt; pool-id&gt;zzzz&lt;/ pool-id&gt;
     &lt;/pool-names&gt;
	&lt;info&gt;some information&lt;/info&gt;
&lt;/operation-result&gt;
</description>
        <to>operation result</to>
        <from>operation result</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <switch>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <before-execution>
          <log>
            <level>debug</level>
            <parameters>
              <input>
                <value>------------ Reserve Address Range Starts ------------</value>
              </input>
              <input>
                <value></value>
              </input>
            </parameters>
          </log>
        </before-execution>
        <execute-all-applicable-cases>false</execute-all-applicable-cases>
        <default>
          <sequence>
            <call-process>
              <process-name>:AutoPilot-OA-IP-Address-Management:Reserve Range Wrapper</process-name>
              <parameters>
                <input global="true">
                  <configuration>:BMC-SA-BBNA-IP-Address-Management:IP_Address_Management:Configuration_Name</configuration>
                  <to>configuration name</to>
                </input>
                <input>
                  <from>range address</from>
                  <to>range address</to>
                </input>
                <input>
                  <from>pools</from>
                  <to>pools</to>
                </input>
                <input>
                  <from>scope</from>
                  <to>scope</to>
                </input>
                <input>
                  <from>network bits</from>
                  <to>network bits</to>
                </input>
                <output>
                  <from>success status</from>
                  <to>success</to>
                </output>
                <output>
                  <from>error message</from>
                  <to>error message</to>
                </output>
                <output>
                  <from>pool ids</from>
                  <to>pool ids</to>
                </output>
                <output>
                  <from>info message</from>
                  <to>info message</to>
                </output>
              </parameters>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>false</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[1]:call-process[1]</location>
            </call-process>
          </sequence>
        </default>
        <case>
          <condition>
            <document>
              <input global="true">
                <configuration>:BMC-SA-BBNA-IP-Address-Management:IP_Address_Management:Configuration_Name</configuration>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[starts-with(., "Infoblox")]]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <assign>
              <assignment>
                <output>
                  <to>pool ids</to>
                  <value>
                    <pool-ids>
</pool-ids>
                  </value>
                </output>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <location>:switch[1]:sequence[2]:assign[1]</location>
            </assign>
            <for-each>
              <document>
                <input>
                  <from>pools</from>
                </input>
              </document>
              <result>
                <output>
                  <to>pool</to>
                </output>
              </result>
              <xpath-expression>
                <xpath-replacement-tokens />
                <xpath><![CDATA[//pool]]></xpath>
              </xpath-expression>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>true</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <sequence>
                <assign>
                  <assignment>
                    <document>
                      <input>
                        <from>pool</from>
                      </input>
                    </document>
                    <result>
                      <output>
                        <to>pool-address</to>
                      </output>
                    </result>
                    <xpath-expression>
                      <xpath-replacement-tokens />
                      <xpath><![CDATA[//pool-address/text()]]></xpath>
                    </xpath-expression>
                  </assignment>
                  <assignment>
                    <document>
                      <input>
                        <from>pool</from>
                      </input>
                    </document>
                    <result>
                      <output>
                        <to>pool-mask</to>
                      </output>
                    </result>
                    <xpath-expression>
                      <xpath-replacement-tokens />
                      <xpath><![CDATA[//pool-mask/text()]]></xpath>
                    </xpath-expression>
                  </assignment>
                  <meta>
                    <documentation />
                    <checkpoint>false</checkpoint>
                  </meta>
                  <location>:switch[1]:sequence[2]:assign[2]</location>
                </assign>
                <call-process>
                  <process-name>:BMC-SA-BBNA-IP-Address-Management:Reserve Address Pool</process-name>
                  <parameters>
                    <input>
                      <from>pool-address</from>
                      <to>pool address</to>
                    </input>
                    <input>
                      <from>pool-mask</from>
                      <to>pool mask</to>
                    </input>
                    <input>
                      <from>scope</from>
                      <to>scope</to>
                    </input>
                    <input>
                      <from>network bits</from>
                      <to>network bits</to>
                    </input>
                    <output>
                      <from>success</from>
                      <to>success</to>
                    </output>
                    <output>
                      <from>operation result</from>
                      <to>operation result</to>
                    </output>
                  </parameters>
                  <meta>
                    <documentation />
                    <run-mode-handling>
                      <run-mode>OCP</run-mode>
                      <allow-step-into>false</allow-step-into>
                    </run-mode-handling>
                    <checkpoint>false</checkpoint>
                  </meta>
                  <location>:switch[1]:sequence[2]:call-process[1]</location>
                </call-process>
                <switch>
                  <meta>
                    <documentation />
                    <run-mode-handling>
                      <run-mode>OCP</run-mode>
                      <allow-step-into>true</allow-step-into>
                    </run-mode-handling>
                    <checkpoint>false</checkpoint>
                  </meta>
                  <execute-all-applicable-cases>false</execute-all-applicable-cases>
                  <default>
                    <sequence>
                      <assign>
                        <meta>
                          <documentation />
                          <checkpoint>false</checkpoint>
                        </meta>
                        <location>:switch[1]:sequence[2]:switch[1]:sequence[1]:assign[1]</location>
                      </assign>
                    </sequence>
                  </default>
                  <case>
                    <condition>
                      <document>
                        <input>
                          <from>success</from>
                        </input>
                      </document>
                      <xpath-expression>
                        <xpath-replacement-tokens />
                        <xpath><![CDATA[text() = 'true']]></xpath>
                      </xpath-expression>
                    </condition>
                    <sequence>
                      <assign>
                        <assignment>
                          <document>
                            <input>
                              <from>operation result</from>
                            </input>
                          </document>
                          <result>
                            <output>
                              <to>reserved-id</to>
                            </output>
                          </result>
                          <xpath-expression>
                            <xpath-replacement-tokens />
                            <xpath><![CDATA[//pool-id/text()]]></xpath>
                          </xpath-expression>
                        </assignment>
                        <meta>
                          <documentation />
                          <checkpoint>false</checkpoint>
                        </meta>
                        <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:assign[1]</location>
                      </assign>
                      <assign>
                        <assignment>
                          <document>
                            <input>
                              <from>pool ids</from>
                            </input>
                          </document>
                          <result>
                            <output>
                              <to>pool ids</to>
                            </output>
                          </result>
                          <xslt-stylesheet>
                            <stylesheet-replacement-tokens>
                              <replacement-token name="resId">
                                <input global="false">
                                  <from>reserved-id</from>
                                </input>
                              </replacement-token>
                            </stylesheet-replacement-tokens>
                            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <pool-ids>
      <xsl:copy-of select="//pool-ids/*" />
      <pool-id>
        <xsl:text disable-output-escaping="no">${resId}</xsl:text>
      </pool-id>
    </pool-ids>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                          </xslt-stylesheet>
                        </assignment>
                        <assignment>
                          <output>
                            <to>info message</to>
                            <value>Network pool  is successfully reserved</value>
                          </output>
                        </assignment>
                        <assignment>
                          <output>
                            <to>error message</to>
                            <value></value>
                          </output>
                        </assignment>
                        <assignment>
                          <output>
                            <to>info message</to>
                            <value>Info</value>
                          </output>
                        </assignment>
                        <meta>
                          <documentation />
                          <checkpoint>false</checkpoint>
                        </meta>
                        <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:assign[2]</location>
                      </assign>
                    </sequence>
                  </case>
                  <location>:switch[1]:sequence[2]:switch[1]</location>
                </switch>
              </sequence>
              <location>:switch[1]:sequence[2]:for-each[1]</location>
            </for-each>
          </sequence>
        </case>
        <location>:switch[1]</location>
      </switch>
      <assign>
        <assignment>
          <document>
            <input>
              <from>info message</from>
            </input>
          </document>
          <result>
            <output>
              <to>operation result</to>
            </output>
          </result>
          <xslt-stylesheet>
            <stylesheet-replacement-tokens>
              <replacement-token name="error">
                <input global="false">
                  <from>error message</from>
                </input>
              </replacement-token>
              <replacement-token name="pools">
                <input global="false">
                  <from>pool ids</from>
                </input>
              </replacement-token>
              <replacement-token name="info">
                <input global="false">
                  <from>info message</from>
                </input>
              </replacement-token>
              <replacement-token name="success">
                <input global="false">
                  <from>success</from>
                </input>
              </replacement-token>
            </stylesheet-replacement-tokens>
            <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xalan="http://xml.apache.org/xalan" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <operation-result>
      <xsl:if test="string('${success}') = &quot;false&quot;">
        <message>
          <xsl:text disable-output-escaping="no">$[error]</xsl:text>
        </message>
      </xsl:if>
      <xsl:if test="string('${success}') = &quot;true&quot;">
        <pool-ids>
          <xsl:variable name="pools">${pools}</xsl:variable>
          <xsl:copy-of select="xalan:nodeset($pools)//node()[name() = 'pool-id']" />
        </pool-ids>
      </xsl:if>
      <xsl:if test="string-length(.) != 0">
        <info>
          <xsl:text disable-output-escaping="no">${info}</xsl:text>
        </info>
      </xsl:if>
    </operation-result>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
          </xslt-stylesheet>
        </assignment>
        <meta>
          <documentation />
          <checkpoint>false</checkpoint>
        </meta>
        <after-execution>
          <log>
            <level>debug</level>
            <parameters>
              <input>
                <value>------------ Reserve Address Range Ends ------------ </value>
              </input>
              <input>
                <from>operation result</from>
              </input>
            </parameters>
          </log>
        </after-execution>
        <location>:assign[1]</location>
      </assign>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
        <consumer>SOAP</consumer>
      </expose-to>
      <documentation>
        <description>Reserve Address Range:
Reserves a whole range of continuous pools of specified size, returning the list of pool ids in order. 
For IPAM providers which do not support reservation (e.g. Vital QIP), the method will return a list of contiguous pools but will not guarantee exclusive use of those pools. 
For IPAM providers which support the concept of multiple reservations of  the same pool, if the scope argument is populated, then the same pools  are allowed to be reserved by this caller even if they were already  reserved by another caller, as long as the two callers in question both  used different scope values.  The pool ids returned to each caller in that case will be different, but the address involved will be overlapping.
Note that if the pools don't exist yet in IPAM, the assumption is that they will be automatically created as a side effect of reserving them.  </description>
        <version></version>
      </documentation>
      <logging-options>
        <is-enabled>false</is-enabled>
        <log-file-name></log-file-name>
      </logging-options>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>false</record-metrics>
      <process-id>ebe7b8af-cd71-4b66-b564-aee36ce770b7</process-id>
      <author>admin</author>
      <category></category>
      <status></status>
      <keywords></keywords>
      <systems></systems>
      <last-modified-by>aoadmin</last-modified-by>
      <last-modified>1477027569623</last-modified>
    </meta>
  </process-def>
</process>