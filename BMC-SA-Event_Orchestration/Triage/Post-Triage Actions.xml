<process draft="false" dev-studio-version="8.2.00">
  <process-def name=":BMC-SA-Event_Orchestration:Triage:Post-Triage Actions">
    <parameters>
      <input global="false" required="true">
        <description>For example: BMC_TrueSight</description>
        <from>event source type</from>
        <to>event source type</to>
      </input>
      <input global="false" required="true">
        <description>For example: BMC_AR_System</description>
        <from>itsm type</from>
        <to>itsm type</to>
      </input>
      <input global="false" required="true">
        <description>For example: Service Down</description>
        <from>event type</from>
        <to>event type</to>
      </input>
      <input global="false" required="true">
        <description>Alll specific configuration from the module.</description>
        <from>all configurations</from>
        <to>all configurations</to>
      </input>
      <input global="false" required="true">
        <description>Input event data based on common event model like:

&lt;event&gt;
  &lt;metaData&gt;
    &lt;eventModelVersion&gt;1.1.00&lt;/eventModelVersion&gt;
    &lt;eventClass&gt;PATROL_EV&lt;/eventClass&gt;
    &lt;reportTime&gt;1520007159&lt;/reportTime&gt;
    &lt;reportTimeEpoch&gt;0&lt;/reportTimeEpoch&gt;
    &lt;notes&gt;testing&lt;/notes&gt;
	&lt;eventId&gt;Admin.bmcproactivenetperformancemanageractoradapter.47043420&lt;/eventId&gt;
  &lt;/metaData&gt;
  &lt;sourceData&gt;
    &lt;componentHost&gt;clm-aus-018145&lt;/componentHost&gt;
    &lt;componentHostAddress&gt;172.22.231.209&lt;/componentHostAddress&gt;
  &lt;/sourceData&gt;
  &lt;situationData&gt;
    &lt;situationCategory&gt;CAPACITY_MANAGEMENT&lt;/situationCategory&gt;
	&lt;situationSubCategory&gt;Service Down&lt;/situationSubCategory&gt;
	&lt;application&gt;BAO-REPO&lt;/application&gt;
    &lt;severity&gt;CRITICAL&lt;/severity&gt;
    &lt;situationTimeEpoch&gt;0&lt;/situationTimeEpoch&gt;
    &lt;messageSummary&gt;TESTEVENT02&lt;/messageSummary&gt;
  &lt;/situationData&gt;
  &lt;reporterData&gt;
    &lt;componentHostAddress&gt;172.22.231.209&lt;/componentHostAddress&gt;
    &lt;eventTime&gt;1520007159&lt;/eventTime&gt;
  &lt;/reporterData&gt;
  &lt;extendedData&gt;
    &lt;nameValueList&gt;
      &lt;nameValue xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="nameValue"&gt;
        &lt;name&gt;cell-name&lt;/name&gt;
        &lt;value xmlns:xs="http://www.w3.org/2001/XMLSchema" xsi:type="xs:string"&gt;Admin&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="nameValue"&gt;
        &lt;name&gt;mc-incident-id&lt;/name&gt;
        &lt;value xmlns:xs="http://www.w3.org/2001/XMLSchema" xsi:type="xs:string"&gt;INC00000111112&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="nameValue"&gt;
        &lt;name&gt;pem-alert-type&lt;/name&gt;
        &lt;value xmlns:xs="http://www.w3.org/2001/XMLSchema" xsi:type="xs:string"&gt;Disk Full&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="nameValue"&gt;
        &lt;name&gt;blah-blah&lt;/name&gt;
        &lt;value xmlns:xs="http://www.w3.org/2001/XMLSchema" xsi:type="xs:string"&gt;blah&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="nameValue"&gt;
        &lt;name&gt;mc-event-sub-category&lt;/name&gt;
        &lt;value xmlns:xs="http://www.w3.org/2001/XMLSchema" xsi:type="xs:string"&gt;Disk Full&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="nameValue"&gt;
        &lt;name&gt;mc-arrival-time&lt;/name&gt;
        &lt;value xmlns:xs="http://www.w3.org/2001/XMLSchema" xsi:type="xs:string"&gt;1520007159&lt;/value&gt;
      &lt;/nameValue&gt;
      &lt;nameValue xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="nameValue"&gt;
        &lt;name&gt;mc-origin-key&lt;/name&gt;
        &lt;value xmlns:xs="http://www.w3.org/2001/XMLSchema" xsi:type="xs:string"&gt;10&lt;/value&gt;
      &lt;/nameValue&gt;
    &lt;/nameValueList&gt;
  &lt;/extendedData&gt;
  &lt;metricsData /&gt;
&lt;/event&gt;</description>
        <from>event data</from>
        <to>event data</to>
      </input>
      <input global="false" required="false">
        <description>BAO's authentication token.</description>
        <from>authentication token</from>
        <to>authentication token</to>
      </input>
      <input global="false" required="true">
        <description>Connection data to target based on event data.</description>
        <from>target connection data</from>
        <to>target connection data</to>
      </input>
      <input global="false" required="true">
        <description>Flags accumulated in previous steps.
&lt;flags&gt;
  &lt;status&gt;success&lt;/status&gt;
  &lt;continue-processing&gt;true&lt;/continue-processing&gt;
  &lt;remediation-required&gt;true&lt;/remediation-required&gt;
&lt;/flags&gt;</description>
        <from>flags</from>
        <to>flags</to>
      </input>
      <input global="false" required="false">
        <description>Output of triage effort. This will tell  us if we need to perform any actions like creating or updating incident.

For now, flags can be used and this is not used in the workflow.</description>
        <from>triage response</from>
        <to>triage response</to>
      </input>
      <input global="false" required="true">
        <description>Truesight auth token</description>
        <from>ts auth token</from>
        <to>ts auth token</to>
      </input>
      <input global="false" required="true">
        <description>Action id

1. BMC_TrueSight-ServiceDown-1
2. BMC_TrueSight-HostDown-1</description>
        <from>action id</from>
        <to>action id</to>
      </input>
      <input global="false" required="true">
        <description>Something like below extracted from event

&lt;itsm-data&gt;
  &lt;itsm-manufacturer /&gt;
  &lt;itsm-location /&gt;
  &lt;itsm-model-version /&gt;
  &lt;itsm-incident-id /&gt;
  &lt;itsm-type /&gt;
  &lt;itsm-category /&gt;
  &lt;itsm-item /&gt;
  &lt;itsm-product-name /&gt;
  &lt;itsm-company /&gt;
  &lt;itsm-operational-category3 /&gt;
  &lt;itsm-operational-category2 /&gt;
  &lt;itsm-operational-category1 /&gt;
  &lt;itsm-incident-status /&gt;
&lt;/itsm-data&gt;</description>
        <from>itsm data</from>
        <to>itsm data</to>
      </input>
      <input global="false" required="false">
        <description>ITSM authentication token, if any.</description>
        <from>itsm authentication token</from>
        <to>itsm authentication token</to>
      </input>
      <output global="false" required="false">
        <description>&lt;post-triage-response-data&gt;
  &lt;incident-id&gt;INC000000000309&lt;/incident-id&gt;
&lt;/post-triage-response-data&gt;</description>
        <to>post triage response data</to>
        <from>post triage response data</from>
      </output>
      <output global="false" required="false">
        <description>Collection of previous flags and incident related information.
&lt;flags&gt;
  &lt;status&gt;success&lt;/status&gt;
  &lt;remediation-required&gt;true&lt;/remediation-required&gt;
  &lt;continue-processing&gt;true&lt;/continue-processing&gt;
  &lt;incident-created&gt;true&lt;/incident-created&gt;
  &lt;incident-updated&gt;false&lt;/incident-updated&gt;
&lt;/flags&gt;</description>
        <to>flags</to>
        <from>flags</from>
      </output>
      <output global="false" required="false">
        <description>If incident is created, then, event data is updated with incident id</description>
        <to>event data</to>
        <from>event data</from>
      </output>
      <output global="false" required="false">
        <description>ITSM data updated with incident information like below:

&lt;itsm-data&gt;
  &lt;itsm-manufacturer /&gt;
  &lt;itsm-location /&gt;
  &lt;itsm-model-version /&gt;
  &lt;itsm-incident-id&gt;INC12345678900&lt;/itsm-Incident-id&gt;
  &lt;itsm-type /&gt;
  &lt;itsm-category /&gt;
  &lt;itsm-item /&gt;
  &lt;itsm-product-name /&gt;
  &lt;itsm-company /&gt;
  &lt;itsm-operational-category3 /&gt;
  &lt;itsm-operational-category2 /&gt;
  &lt;itsm-operational-category1 /&gt;
  &lt;itsm-incident-status /&gt;
&lt;/itsm-data&gt;</description>
        <to>itsm data</to>
        <from>itsm data</from>
      </output>
    </parameters>
    <access />
    <sequence>
      <switch>
        <meta>
          <documentation />
          <run-mode-handling>
            <run-mode>OCP</run-mode>
            <allow-step-into>true</allow-step-into>
          </run-mode-handling>
          <checkpoint>false</checkpoint>
        </meta>
        <execute-all-applicable-cases>false</execute-all-applicable-cases>
        <default>
          <sequence>
            <assign>
              <assignment>
                <output>
                  <to>remediation required</to>
                  <value></value>
                </output>
              </assignment>
              <assignment>
                <output>
                  <to>status</to>
                  <value></value>
                </output>
              </assignment>
              <assignment>
                <output>
                  <to>error message</to>
                  <value></value>
                </output>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <before-execution>
                <log>
                  <level>debug</level>
                  <parameters>
                    <input>
                      <value>===== Bypassing post triage actions=====</value>
                    </input>
                    <input>
                      <from>flags</from>
                    </input>
                  </parameters>
                </log>
              </before-execution>
              <location>:switch[1]:sequence[1]:assign[1]</location>
            </assign>
          </sequence>
        </default>
        <case>
          <condition>
            <document>
              <input>
                <from>flags</from>
              </input>
            </document>
            <xpath-expression>
              <xpath-replacement-tokens />
              <xpath><![CDATA[not(boolean(//drop-event)) or //*[name() = 'drop-event']/text() = 'false' ]]></xpath>
            </xpath-expression>
          </condition>
          <sequence>
            <assign>
              <assignment>
                <output>
                  <to>post triage response data</to>
                  <value></value>
                </output>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <before-execution>
                <log>
                  <level>debug</level>
                  <parameters>
                    <input>
                      <value>========Post-Triage Actions Input=======</value>
                    </input>
                    <input>
                      <from>flags</from>
                    </input>
                    <input>
                      <from>itsm type</from>
                    </input>
                    <input>
                      <from>triage response</from>
                    </input>
                    <input>
                      <from>itsm data</from>
                    </input>
                  </parameters>
                </log>
              </before-execution>
              <location>:switch[1]:sequence[2]:assign[1]</location>
            </assign>
            <assign>
              <assignment>
                <document>
                  <input>
                    <from>authentication token</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>tso auth token present</to>
                  </output>
                </result>
                <xslt-stylesheet>
                  <stylesheet-replacement-tokens />
                  <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:choose>
        <xsl:when test="string-length(normalize-space(.)) &gt; 0">
          <xsl:text disable-output-escaping="no">true</xsl:text>
        </xsl:when>
        <xsl:otherwise>
          <xsl:text disable-output-escaping="no">false</xsl:text>
        </xsl:otherwise>
      </xsl:choose>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                </xslt-stylesheet>
              </assignment>
              <assignment>
                <document>
                  <input>
                    <from>itsm authentication token</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>itsm auth token present</to>
                  </output>
                </result>
                <xslt-stylesheet>
                  <stylesheet-replacement-tokens />
                  <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:choose>
        <xsl:when test="string-length(normalize-space(.)) &gt; 0">
          <xsl:text disable-output-escaping="no">true</xsl:text>
        </xsl:when>
        <xsl:otherwise>
          <xsl:text disable-output-escaping="no">false</xsl:text>
        </xsl:otherwise>
      </xsl:choose>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                </xslt-stylesheet>
              </assignment>
              <assignment>
                <document>
                  <input>
                    <from>ts auth token</from>
                  </input>
                </document>
                <result>
                  <output>
                    <to>event source auth token present</to>
                  </output>
                </result>
                <xslt-stylesheet>
                  <stylesheet-replacement-tokens />
                  <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:choose>
        <xsl:when test="string-length(normalize-space(.)) &gt; 0">
          <xsl:text disable-output-escaping="no">true</xsl:text>
        </xsl:when>
        <xsl:otherwise>
          <xsl:text disable-output-escaping="no">false</xsl:text>
        </xsl:otherwise>
      </xsl:choose>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                </xslt-stylesheet>
              </assignment>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <after-execution>
                <log>
                  <level>debug</level>
                  <parameters>
                    <input>
                      <value>===Post-Triage Auth Tokens===</value>
                    </input>
                    <input>
                      <from>tso auth token present</from>
                    </input>
                    <input>
                      <from>event source auth token present</from>
                    </input>
                    <input>
                      <from>itsm auth token present</from>
                    </input>
                  </parameters>
                </log>
              </after-execution>
              <location>:switch[1]:sequence[2]:assign[2]</location>
            </assign>
            <switch>
              <meta>
                <documentation />
                <run-mode-handling>
                  <run-mode>OCP</run-mode>
                  <allow-step-into>true</allow-step-into>
                </run-mode-handling>
                <checkpoint>false</checkpoint>
              </meta>
              <execute-all-applicable-cases>false</execute-all-applicable-cases>
              <default>
                <sequence>
                  <assign>
                    <assignment>
                      <document>
                        <input>
                          <from>flags</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>related event msg</to>
                        </output>
                      </result>
                      <xslt-stylesheet>
                        <stylesheet-replacement-tokens />
                        <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:text disable-output-escaping="no">Bypassing Incident Processing. 
</xsl:text>
      <xsl:if test="//status/text() = 'failure'">
        <xsl:text disable-output-escaping="no">                    Status flag is failure
</xsl:text>
      </xsl:if>
      <xsl:if test="//remediation-required/text() = 'false'">
        <xsl:text disable-output-escaping="no">  Remediation is not required.
</xsl:text>
      </xsl:if>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                      </xslt-stylesheet>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[1]:assign[1]</location>
                  </assign>
                  <call-process>
                    <process-name>:BMC-SA-Event_Orchestration:Event_Integration:Create Related Event</process-name>
                    <parameters>
                      <input>
                        <from>all configurations</from>
                        <to>all configurations</to>
                      </input>
                      <input>
                        <from>event data</from>
                        <to>event data</to>
                      </input>
                      <input>
                        <from>ts auth token</from>
                        <to>auth token</to>
                      </input>
                      <input>
                        <from>related event msg</from>
                        <to>notes</to>
                      </input>
                      <input>
                        <value>Post-Triage Action</value>
                        <to>action name</to>
                      </input>
                      <input>
                        <from>related event msg</from>
                        <to>message</to>
                      </input>
                      <input>
                        <from>flags</from>
                        <to>severity</to>
                        <xslt-stylesheet>
                          <stylesheet-replacement-tokens />
                          <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:choose>
        <xsl:when test="//status/text() = 'success'">
          <xsl:text disable-output-escaping="no">INFO</xsl:text>
        </xsl:when>
        <xsl:otherwise>
          <xsl:text disable-output-escaping="no">CRITICAL</xsl:text>
        </xsl:otherwise>
      </xsl:choose>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                        </xslt-stylesheet>
                      </input>
                      <input>
                        <from>flags</from>
                        <to>command output</to>
                        <xslt-stylesheet>
                          <stylesheet-replacement-tokens>
                            <replacement-token name="related event msg">
                              <input global="false">
                                <from>related event msg</from>
                              </input>
                            </replacement-token>
                          </stylesheet-replacement-tokens>
                          <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" cdata-section-elements="value " />
  <xsl:template match="/">
    <value>
      <xsl:if test="//status/text() = 'success'">${related event msg}</xsl:if>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                        </xslt-stylesheet>
                      </input>
                      <input>
                        <from>flags</from>
                        <to>exit code</to>
                        <xslt-stylesheet>
                          <stylesheet-replacement-tokens />
                          <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:choose>
        <xsl:when test="//status/text() = 'success'">
          <xsl:text disable-output-escaping="no">0</xsl:text>
        </xsl:when>
        <xsl:otherwise>
          <xsl:text disable-output-escaping="no">1</xsl:text>
        </xsl:otherwise>
      </xsl:choose>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                        </xslt-stylesheet>
                      </input>
                      <input>
                        <from>flags</from>
                        <to>error notes</to>
                        <xslt-stylesheet>
                          <stylesheet-replacement-tokens>
                            <replacement-token name="related event msg">
                              <input global="false">
                                <from>related event msg</from>
                              </input>
                            </replacement-token>
                          </stylesheet-replacement-tokens>
                          <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" cdata-section-elements="value " />
  <xsl:template match="/">
    <value>
      <xsl:if test="//status/text() != 'success'">${related event msg}</xsl:if>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                        </xslt-stylesheet>
                      </input>
                    </parameters>
                    <meta>
                      <documentation />
                      <run-mode-handling>
                        <run-mode>OCP</run-mode>
                        <allow-step-into>false</allow-step-into>
                      </run-mode-handling>
                      <checkpoint>false</checkpoint>
                    </meta>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[1]:call-process[1]</location>
                  </call-process>
                  <assign>
                    <assignment>
                      <document>
                        <input>
                          <from>flags</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>flags</to>
                        </output>
                      </result>
                      <xslt-stylesheet>
                        <stylesheet-replacement-tokens />
                        <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()" />
    </xsl:copy>
  </xsl:template>
  <xsl:template match="flags">
    <flags>
      <xsl:apply-templates select="@*|node()" />
      <incident-created>
        <xsl:text disable-output-escaping="no">false</xsl:text>
      </incident-created>
      <incident-updated>
        <xsl:text disable-output-escaping="no">false</xsl:text>
      </incident-updated>
    </flags>
  </xsl:template>
  <xsl:template match="continue-processing">
    <continue-processing>
      <xsl:text disable-output-escaping="no">false</xsl:text>
    </continue-processing>
  </xsl:template>
  <xsl:template match="status">
    <status>
      <xsl:value-of select="." disable-output-escaping="no" />
    </status>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                      </xslt-stylesheet>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[1]:assign[2]</location>
                  </assign>
                </sequence>
              </default>
              <case>
                <condition>
                  <document>
                    <input>
                      <from>flags</from>
                    </input>
                  </document>
                  <xpath-expression>
                    <xpath-replacement-tokens />
                    <xpath><![CDATA[//status/text() = 'success' and //continue-processing/text() = 'true' and //remediation-required/text() = 'true']]></xpath>
                  </xpath-expression>
                </condition>
                <sequence>
                  <assign>
                    <assignment>
                      <document>
                        <input>
                          <from>flags</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>process incident flag</to>
                        </output>
                      </result>
                      <xpath-expression>
                        <xpath-replacement-tokens />
                        <xpath><![CDATA[//incident-enabled/text() = 'true']]></xpath>
                      </xpath-expression>
                    </assignment>
                    <assignment>
                      <output>
                        <to>post triage response data</to>
                        <value>
                          <post-triage-response-data />
                        </value>
                      </output>
                    </assignment>
                    <assignment>
                      <output>
                        <to>status</to>
                        <value>success</value>
                      </output>
                    </assignment>
                    <assignment>
                      <output>
                        <to>error message</to>
                        <value></value>
                      </output>
                    </assignment>
                    <assignment>
                      <document>
                        <input>
                          <from>itsm data</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>incident id</to>
                        </output>
                      </result>
                      <xpath-expression>
                        <xpath-replacement-tokens />
                        <xpath><![CDATA[//itsm-incident-id/text()]]></xpath>
                      </xpath-expression>
                    </assignment>
                    <assignment>
                      <document>
                        <input>
                          <from>itsm data</from>
                        </input>
                      </document>
                      <result>
                        <output>
                          <to>incident id exists in event</to>
                        </output>
                      </result>
                      <xpath-expression>
                        <xpath-replacement-tokens />
                        <xpath><![CDATA[boolean(//itsm-incident-id) and string-length(normalize-space(//itsm-incident-id/text())) > 0]]></xpath>
                      </xpath-expression>
                    </assignment>
                    <meta>
                      <documentation />
                      <checkpoint>false</checkpoint>
                    </meta>
                    <after-execution>
                      <log>
                        <level>debug</level>
                        <parameters>
                          <input>
                            <value>=== Pre process incident information===</value>
                          </input>
                          <input>
                            <from>process incident flag</from>
                          </input>
                          <input>
                            <from>incident id</from>
                          </input>
                          <input>
                            <from>incident id exists in event</from>
                          </input>
                        </parameters>
                      </log>
                    </after-execution>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:assign[1]</location>
                  </assign>
                  <switch>
                    <meta>
                      <documentation />
                      <run-mode-handling>
                        <run-mode>OCP</run-mode>
                        <allow-step-into>true</allow-step-into>
                      </run-mode-handling>
                      <checkpoint>false</checkpoint>
                    </meta>
                    <execute-all-applicable-cases>false</execute-all-applicable-cases>
                    <default>
                      <sequence>
                        <call-process>
                          <process-name>:BMC-SA-Event_Orchestration:Event_Integration:Create Related Event</process-name>
                          <parameters>
                            <input>
                              <from>all configurations</from>
                              <to>all configurations</to>
                            </input>
                            <input>
                              <from>event data</from>
                              <to>event data</to>
                            </input>
                            <input>
                              <from>ts auth token</from>
                              <to>auth token</to>
                            </input>
                            <input>
                              <value>Bypassing incident processing.</value>
                              <to>notes</to>
                            </input>
                            <input>
                              <value>Bypass Incident Ticket Processing</value>
                              <to>action name</to>
                            </input>
                            <input>
                              <value>Bypassing incident processing.</value>
                              <to>message</to>
                            </input>
                            <input>
                              <value>INFO</value>
                              <to>severity</to>
                            </input>
                            <input>
                              <value>Bypassing Incident Processing.</value>
                              <to>command output</to>
                            </input>
                            <input>
                              <value>0</value>
                              <to>exit code</to>
                            </input>
                          </parameters>
                          <meta>
                            <documentation />
                            <run-mode-handling>
                              <run-mode>OCP</run-mode>
                              <allow-step-into>false</allow-step-into>
                            </run-mode-handling>
                            <checkpoint>false</checkpoint>
                          </meta>
                          <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[1]:call-process[1]</location>
                        </call-process>
                        <assign>
                          <assignment>
                            <document>
                              <input>
                                <from>flags</from>
                              </input>
                            </document>
                            <result>
                              <output>
                                <to>flags</to>
                              </output>
                            </result>
                            <xslt-stylesheet>
                              <stylesheet-replacement-tokens />
                              <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()" />
    </xsl:copy>
  </xsl:template>
  <xsl:template match="flags">
    <flags>
      <xsl:apply-templates select="@*|node()" />
      <incident-created>
        <xsl:text disable-output-escaping="no">false</xsl:text>
      </incident-created>
    </flags>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                            </xslt-stylesheet>
                          </assignment>
                          <meta>
                            <documentation />
                            <checkpoint>false</checkpoint>
                          </meta>
                          <before-execution>
                            <log>
                              <level>debug</level>
                              <parameters>
                                <input>
                                  <value>==========Post-Triage Actions Not Processing Incident ========</value>
                                </input>
                                <input>
                                  <from>post triage response data</from>
                                </input>
                                <input>
                                  <from>status</from>
                                </input>
                                <input>
                                  <from>error message</from>
                                </input>
                              </parameters>
                            </log>
                          </before-execution>
                          <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[1]:assign[1]</location>
                        </assign>
                      </sequence>
                    </default>
                    <case>
                      <condition>
                        <document>
                          <input>
                            <from>process incident flag</from>
                          </input>
                        </document>
                        <xpath-expression>
                          <xpath-replacement-tokens />
                          <xpath><![CDATA[. = 'true']]></xpath>
                        </xpath-expression>
                      </condition>
                      <sequence>
                        <call-process>
                          <process-name>:BMC-SA-Event_Orchestration:ITSM_Integration:Process Incident</process-name>
                          <parameters>
                            <input>
                              <from>event source type</from>
                              <to>event source type</to>
                            </input>
                            <input>
                              <from>itsm type</from>
                              <to>itsm type</to>
                            </input>
                            <input>
                              <from>event type</from>
                              <to>event type</to>
                            </input>
                            <input>
                              <from>all configurations</from>
                              <to>all configurations</to>
                            </input>
                            <input>
                              <from>event data</from>
                              <to>event data</to>
                            </input>
                            <input>
                              <from>flags</from>
                              <to>flags</to>
                            </input>
                            <input>
                              <from>itsm data</from>
                              <to>itsm data</to>
                            </input>
                            <input>
                              <from>authentication token</from>
                              <to>authentication token</to>
                            </input>
                            <input>
                              <from>itsm authentication token</from>
                              <to>itsm authentication token</to>
                            </input>
                            <output>
                              <from>incident id</from>
                              <to>incident id</to>
                            </output>
                            <output>
                              <from>status</from>
                              <to>status</to>
                            </output>
                            <output>
                              <from>error message</from>
                              <to>error message</to>
                            </output>
                            <output>
                              <from>incident created</from>
                              <to>incident created</to>
                            </output>
                            <output>
                              <from>incident updated</from>
                              <to>incident updated</to>
                            </output>
                          </parameters>
                          <meta>
                            <documentation />
                            <run-mode-handling>
                              <run-mode>OCP</run-mode>
                              <allow-step-into>false</allow-step-into>
                            </run-mode-handling>
                            <checkpoint>false</checkpoint>
                          </meta>
                          <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[2]:call-process[1]</location>
                        </call-process>
                        <assign>
                          <assignment>
                            <document>
                              <input>
                                <from>flags</from>
                              </input>
                            </document>
                            <result>
                              <output>
                                <to>flags</to>
                              </output>
                            </result>
                            <xslt-stylesheet>
                              <stylesheet-replacement-tokens>
                                <replacement-token name="status">
                                  <input global="false">
                                    <from>status</from>
                                  </input>
                                </replacement-token>
                                <replacement-token name="incident id">
                                  <input global="false">
                                    <from>incident id</from>
                                  </input>
                                </replacement-token>
                                <replacement-token name="incident id exists in event">
                                  <input global="false">
                                    <from>incident id exists in event</from>
                                  </input>
                                </replacement-token>
                                <replacement-token name="incident created">
                                  <input global="false">
                                    <from>incident created</from>
                                  </input>
                                </replacement-token>
                                <replacement-token name="incident updated">
                                  <input global="false">
                                    <from>incident updated</from>
                                  </input>
                                </replacement-token>
                              </stylesheet-replacement-tokens>
                              <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()" />
    </xsl:copy>
  </xsl:template>
  <xsl:template match="flags">
    <flags>
      <xsl:apply-templates select="@*|node()" />
      <incident-created>${incident created}</incident-created>
      <incident-updated>${incident updated}</incident-updated>
    </flags>
  </xsl:template>
  <xsl:template match="continue-processing">
    <xsl:choose>
      <xsl:when test="'${status}' = 'failure'">
        <continue-processing>
          <xsl:text disable-output-escaping="no">false</xsl:text>
        </continue-processing>
      </xsl:when>
      <xsl:otherwise>
        <continue-processing>
          <xsl:text disable-output-escaping="no">true</xsl:text>
        </continue-processing>
      </xsl:otherwise>
    </xsl:choose>
  </xsl:template>
  <xsl:template match="status">
    <status>${status}</status>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                            </xslt-stylesheet>
                          </assignment>
                          <assignment>
                            <document>
                              <input>
                                <from>post triage response data</from>
                              </input>
                            </document>
                            <result>
                              <output>
                                <to>post triage response data</to>
                              </output>
                            </result>
                            <xslt-stylesheet>
                              <stylesheet-replacement-tokens>
                                <replacement-token name="incident id">
                                  <input global="false">
                                    <from>incident id</from>
                                  </input>
                                </replacement-token>
                                <replacement-token name="error message">
                                  <input global="false">
                                    <from>error message</from>
                                  </input>
                                </replacement-token>
                                <replacement-token name="incident created">
                                  <input global="false">
                                    <from>incident created</from>
                                  </input>
                                </replacement-token>
                                <replacement-token name="incident updated">
                                  <input global="false">
                                    <from>incident updated</from>
                                  </input>
                                </replacement-token>
                              </stylesheet-replacement-tokens>
                              <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:variable name="rootName" select="name(/*)" />
  <xsl:variable name="errorMsg">${error message}</xsl:variable>
  <xsl:template match="/">
    <xsl:element name="{$rootName}">
      <xsl:if test="string-length(normalize-space('${incident id}')) &gt; 0">
        <itsm-incident-id>${incident id}</itsm-incident-id>
        <incident-created>${incident created}</incident-created>
        <incident-updated>${incident updated}</incident-updated>
      </xsl:if>
      <xsl:if test="string-length(normalize-space($errorMsg)) &gt; 0">
        <error-message>${error message}</error-message>
      </xsl:if>
    </xsl:element>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                            </xslt-stylesheet>
                          </assignment>
                          <meta>
                            <documentation />
                            <checkpoint>false</checkpoint>
                          </meta>
                          <before-execution>
                            <log>
                              <level>debug</level>
                              <parameters>
                                <input>
                                  <value>==========Post-Triage Actions Post Incident Creation or Update - Updating Flags========</value>
                                </input>
                                <input>
                                  <from>post triage response data</from>
                                </input>
                                <input>
                                  <from>status</from>
                                </input>
                                <input>
                                  <from>error message</from>
                                </input>
                              </parameters>
                            </log>
                          </before-execution>
                          <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[2]:assign[1]</location>
                        </assign>
                        <switch>
                          <meta>
                            <documentation />
                            <run-mode-handling>
                              <run-mode>OCP</run-mode>
                              <allow-step-into>true</allow-step-into>
                            </run-mode-handling>
                            <checkpoint>false</checkpoint>
                          </meta>
                          <execute-all-applicable-cases>false</execute-all-applicable-cases>
                          <default>
                            <sequence />
                          </default>
                          <case>
                            <condition>
                              <document>
                                <input>
                                  <from>incident id exists in event</from>
                                </input>
                              </document>
                              <xpath-expression>
                                <xpath-replacement-tokens />
                                <xpath><![CDATA[. = 'false']]></xpath>
                              </xpath-expression>
                            </condition>
                            <sequence>
                              <assign>
                                <assignment>
                                  <document>
                                    <input>
                                      <from>event data</from>
                                    </input>
                                  </document>
                                  <result>
                                    <output>
                                      <to>event data</to>
                                    </output>
                                  </result>
                                  <xslt-stylesheet>
                                    <stylesheet-replacement-tokens>
                                      <replacement-token name="incident id">
                                        <input global="false">
                                          <from>incident id</from>
                                        </input>
                                      </replacement-token>
                                    </stylesheet-replacement-tokens>
                                    <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()" />
    </xsl:copy>
  </xsl:template>
  <xsl:template match="nameValueList">
    <xsl:copy>
      <xsl:choose>
        <xsl:when test="not(boolean(//nameValue/name/text() = 'itsm-incident-id'))">
          <nameValue>
            <name>
              <xsl:text disable-output-escaping="no">itsm-incident-id</xsl:text>
            </name>
            <value>${incident id}</value>
          </nameValue>
        </xsl:when>
      </xsl:choose>
      <xsl:apply-templates select="@* | node()" />
    </xsl:copy>
  </xsl:template>
  <xsl:template match="value">
    <xsl:choose>
      <xsl:when test="contains(../name, 'itsm-incident-id')">
        <value>${incident id}</value>
      </xsl:when>
      <xsl:otherwise>
        <xsl:copy>
          <xsl:apply-templates select="@*|node()" />
        </xsl:copy>
      </xsl:otherwise>
    </xsl:choose>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                                  </xslt-stylesheet>
                                </assignment>
                                <assignment>
                                  <document>
                                    <input>
                                      <from>itsm data</from>
                                    </input>
                                  </document>
                                  <result>
                                    <output>
                                      <to>itsm data</to>
                                    </output>
                                  </result>
                                  <xslt-stylesheet>
                                    <stylesheet-replacement-tokens>
                                      <replacement-token name="incident id">
                                        <input global="false">
                                          <from>incident id</from>
                                        </input>
                                      </replacement-token>
                                    </stylesheet-replacement-tokens>
                                    <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:variable name="rootNode" select="name(/*)" />
  <xsl:template match="/">
    <xsl:apply-templates select="@*|node()" />
  </xsl:template>
  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:if test="name() = 'itsm-incident-id'">${incident id}</xsl:if>
      <xsl:apply-templates select="@*|node()" />
    </xsl:copy>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                                  </xslt-stylesheet>
                                </assignment>
                                <meta>
                                  <documentation />
                                  <checkpoint>false</checkpoint>
                                </meta>
                                <after-execution>
                                  <log>
                                    <level>debug</level>
                                    <parameters>
                                      <input>
                                        <value>==== Added incident id to event data and itsm data===</value>
                                      </input>
                                      <input>
                                        <from>itsm data</from>
                                      </input>
                                    </parameters>
                                  </log>
                                </after-execution>
                                <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[2]:assign[1]</location>
                              </assign>
                            </sequence>
                          </case>
                          <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]</location>
                        </switch>
                        <assign>
                          <assignment>
                            <document>
                              <input>
                                <from>flags</from>
                              </input>
                            </document>
                            <result>
                              <output>
                                <to>log message</to>
                              </output>
                            </result>
                            <xslt-stylesheet>
                              <stylesheet-replacement-tokens>
                                <replacement-token name="incident id">
                                  <input global="false">
                                    <from>incident id</from>
                                  </input>
                                </replacement-token>
                                <replacement-token name="error message">
                                  <input global="false">
                                    <from>error message</from>
                                  </input>
                                </replacement-token>
                                <replacement-token name="status">
                                  <input global="false">
                                    <from>status</from>
                                  </input>
                                </replacement-token>
                              </stylesheet-replacement-tokens>
                              <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:choose>
        <xsl:when test="//incident-created/text() = 'true'">
          <xsl:text disable-output-escaping="no">Incident created: ${incident id}</xsl:text>
        </xsl:when>
        <xsl:when test="//incident-updated/text() = 'true'">
          <xsl:text disable-output-escaping="no">Incident updated: ${incident id}</xsl:text>
        </xsl:when>
        <xsl:otherwise>
          <xsl:choose>
            <xsl:when test="'${status}' = 'failure'">${error message}</xsl:when>
            <xsl:otherwise>
              <xsl:text disable-output-escaping="no">Incident processing state is uknown .. check logs. [Status: ${status}] [Incident ID: ${incident id}] [Error message: ${error message}]</xsl:text>
            </xsl:otherwise>
          </xsl:choose>
        </xsl:otherwise>
      </xsl:choose>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                            </xslt-stylesheet>
                          </assignment>
                          <meta>
                            <documentation />
                            <checkpoint>false</checkpoint>
                          </meta>
                          <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[2]:assign[2]</location>
                        </assign>
                        <call-process>
                          <process-name>:BMC-SA-Event_Orchestration:Event_Integration:Create Related Event</process-name>
                          <parameters>
                            <input>
                              <from>all configurations</from>
                              <to>all configurations</to>
                            </input>
                            <input>
                              <from>event data</from>
                              <to>event data</to>
                            </input>
                            <input>
                              <from>ts auth token</from>
                              <to>auth token</to>
                            </input>
                            <input>
                              <from>log message</from>
                              <to>notes</to>
                            </input>
                            <input>
                              <from>flags</from>
                              <to>action name</to>
                              <xslt-stylesheet>
                                <stylesheet-replacement-tokens>
                                  <replacement-token name="incident exists in event">
                                    <input global="false">
                                      <from>incident id exists in event</from>
                                    </input>
                                  </replacement-token>
                                </stylesheet-replacement-tokens>
                                <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:choose>
        <xsl:when test="'${incident exists in event}' = 'true'">
          <xsl:text disable-output-escaping="no">Update Incident</xsl:text>
        </xsl:when>
        <xsl:otherwise>
          <xsl:text disable-output-escaping="no">Create Incident</xsl:text>
        </xsl:otherwise>
      </xsl:choose>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                              </xslt-stylesheet>
                            </input>
                            <input>
                              <from>log message</from>
                              <to>message</to>
                            </input>
                            <input>
                              <from>status</from>
                              <to>severity</to>
                              <xslt-stylesheet>
                                <stylesheet-replacement-tokens />
                                <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:choose>
        <xsl:when test=". = 'success'">
          <xsl:text disable-output-escaping="no">INFO</xsl:text>
        </xsl:when>
        <xsl:otherwise>
          <xsl:text disable-output-escaping="no">MAJOR</xsl:text>
        </xsl:otherwise>
      </xsl:choose>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                              </xslt-stylesheet>
                            </input>
                            <input>
                              <from>log message</from>
                              <to>command output</to>
                              <xslt-stylesheet>
                                <stylesheet-replacement-tokens>
                                  <replacement-token name="status">
                                    <input global="false">
                                      <from>status</from>
                                    </input>
                                  </replacement-token>
                                </stylesheet-replacement-tokens>
                                <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:if test="'${status}' = 'success'">
        <xsl:value-of select="." disable-output-escaping="no" />
      </xsl:if>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                              </xslt-stylesheet>
                            </input>
                            <input>
                              <from>status</from>
                              <to>exit code</to>
                              <xslt-stylesheet>
                                <stylesheet-replacement-tokens />
                                <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:choose>
        <xsl:when test=". = 'success'">
          <xsl:text disable-output-escaping="no">0</xsl:text>
        </xsl:when>
        <xsl:otherwise>
          <xsl:text disable-output-escaping="no">1</xsl:text>
        </xsl:otherwise>
      </xsl:choose>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                              </xslt-stylesheet>
                            </input>
                            <input>
                              <from>log message</from>
                              <to>error notes</to>
                              <xslt-stylesheet>
                                <stylesheet-replacement-tokens>
                                  <replacement-token name="status">
                                    <input global="false">
                                      <from>status</from>
                                    </input>
                                  </replacement-token>
                                </stylesheet-replacement-tokens>
                                <stylesheet><![CDATA[<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output indent="no" />
  <xsl:template match="/">
    <value>
      <xsl:if test="'${status}' = 'failure'">
        <xsl:value-of select="." disable-output-escaping="no" />
      </xsl:if>
    </value>
  </xsl:template>
</xsl:stylesheet>]]></stylesheet>
                              </xslt-stylesheet>
                            </input>
                          </parameters>
                          <meta>
                            <documentation />
                            <run-mode-handling>
                              <run-mode>OCP</run-mode>
                              <allow-step-into>false</allow-step-into>
                            </run-mode-handling>
                            <checkpoint>false</checkpoint>
                          </meta>
                          <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]:sequence[2]:call-process[2]</location>
                        </call-process>
                      </sequence>
                    </case>
                    <location>:switch[1]:sequence[2]:switch[1]:sequence[2]:switch[1]</location>
                  </switch>
                </sequence>
              </case>
              <location>:switch[1]:sequence[2]:switch[1]</location>
            </switch>
            <assign>
              <meta>
                <documentation />
                <checkpoint>false</checkpoint>
              </meta>
              <before-execution>
                <log>
                  <level>debug</level>
                  <parameters>
                    <input>
                      <value>==========Post-Triage Actions output========</value>
                    </input>
                    <input>
                      <from>post triage response data</from>
                    </input>
                    <input>
                      <from>error message</from>
                    </input>
                    <input>
                      <from>flags</from>
                    </input>
                  </parameters>
                </log>
              </before-execution>
              <location>:switch[1]:sequence[2]:assign[3]</location>
            </assign>
          </sequence>
        </case>
        <location>:switch[1]</location>
      </switch>
    </sequence>
    <meta>
      <expose-to>
        <consumer>RULE</consumer>
        <consumer>SCHEDULE</consumer>
        <consumer>OCP</consumer>
        <consumer>SOAP</consumer>
      </expose-to>
      <documentation>
        <description>A framework workflow to support any post-triage actions like ITSM or event updates, etc.</description>
        <version></version>
      </documentation>
      <logging-options>
        <is-enabled>false</is-enabled>
        <log-file-name></log-file-name>
      </logging-options>
      <peer-location>
        <location>any</location>
      </peer-location>
      <record-metrics>true</record-metrics>
      <process-id>019ee63b-a937-4a48-9246-b111e6221958</process-id>
      <author>Ranganath Samudrala</author>
      <category>Event Orchestration.</category>
      <status></status>
      <keywords></keywords>
      <systems></systems>
      <last-modified-by>aoadmin</last-modified-by>
      <last-modified>1576055585573</last-modified>
    </meta>
  </process-def>
</process>